define("analytics/channel/experimentImpressionChannel",["require","blue/event/channel"],(function(e){var t,n=e("blue/event/channel");return{getInstance:function(e,i){return t||(t=new n),t}}})),define("analytics/scroll/elementInViewport",[],(function(){return function(e,t){t||(t=50);var n=e.getBoundingClientRect();return n.bottom-n.height*t/100-window.innerHeight<1}})),define("analytics/channel/scrollStopChannel",["require","blue/event/channel","blue/event/channel/domEvents"],(function(e){var t=new(e("blue/event/channel")),n=e("blue/event/channel/domEvents");return function(e){return t.plug(n.asEventStream("scroll").debounce(e)),t}})),define("analytics/scroll/experimentWatcher",["require","exports","module","analytics/channel/experimentImpressionChannel","analytics/scroll/elementInViewport","blue/event/channel/component","analytics/channel/scrollStopChannel"],(function(e,t,n){var i,a,r,o=e("analytics/channel/experimentImpressionChannel"),s=e("analytics/scroll/elementInViewport"),c=e("blue/event/channel/component"),l=e("analytics/channel/scrollStopChannel"),d=n.config(),u={},p=["style","content","template"];function f(e){var t=Object.create(null);return t.data=e.context,t.name=e.name,t}function m(e){var t=document.querySelectorAll(e);return 1===t.length?t[0]:void 0}function g(e,t,n){(i=e[t].filter((function(e){return e.component===n.componentName})))&&i.length>0&&function(e,t,n){e.forEach((function(e){var t=m(e.selector);t&&(s(t,d.visibilityPercentage)?o.getInstance().emit(f({name:e.component,context:{experimentId:e.experimentId,choice:e.choice}})):(u[n]||(u[n]=[]),u[n].push({selector:e.selector,context:{experimentId:e.experimentId,choice:e.choice},name:e.component})))}))}(i,0,n.componentInstanceName)}return function(e){r=e,a||(a=l(d.delay||1e3).asEventStream().onValue((function(){var e,t;Object.keys(u).forEach((function(n){for(t=u[n],e=t.length-1;e>-1;e--)s(m(t[e].selector),d.visibilityPercentage)&&(o.getInstance().emit(f(t[e])),t.splice(e,1))}))}))),c.on("ready",(function(e){var t=r&&(r[e.target.context.areaName]||r.app);t&&p.forEach((function(n){t[n]&&g(t,n,e)}))})),c.on("destroy",(function(e){u[e.target.key]&&u[e.target.key].splice(0)}))}})),define("analytics/util/experimentActionHelper",[],(function(){var e;return{setExperimentData:function(t){e=t},getExperimentData:function(){return e},getExperimentActions:function(){var e=this.getExperimentData(),t=e&&Object.create(null),n=e&&Object.keys(e)||[],i=function(e,n){n&&n.forEach((function(n){for(var i=n.actions&&n.actions.length||0,a=0;a<i;a++)t[e+"."+n.component+"."+n.actions[a]]={experimentId:n.experimentId,choice:n.choice,action:n.actions[a]}}))};return n.forEach((function(t){i(t,e[t].style),i(t,e[t].template),i(t,e[t].content)})),t}}})),define("appkit-utilities/common/constants",{SYMBOLS:{POUND:"#",PERIOD:".",SLASH:"/",UNDERSCORE:"_"},VALUE:{THOUSAND:1e3,MILLION:1e6,BILLION:1e9,TRILLION:1e12},BRAND_ID:{JPMORGAN:"JPMORGAN"},DETAIL_TYPE:{MERCHANT:"MSA"}}),define("appkit-utilities/accountInfo/accountInfo",["require","blue/siteData","blue/log","appkit-utilities/common/constants"],(function(e){"use strict";var t=e("blue/siteData"),n=e("blue/log")("[accountInfo]"),i=e("appkit-utilities/common/constants"),a={profileType:{personal:["PER","MUG"],gemini:["GEM","GNC","GNM"],multiTin:["MUL","GNM","GMC"],multiChannel:["CHN"],businessBanking:["BUS","GNM","GNC","MUL","GEM"]},segmentType:{commercial:["CML","CRE"],smallBusiness:["BMG","BMS","BPL","BPS","BOH","BOS"],businessBanking:["BOH","BMG","BPL","PVB","WTH"],wealthy:["PVB","PCB","WTH"],jpmSecurities:["PCB"],privateBanking:["PVB","WTH"]},userType:{subUser:["SU"]},accountTypes:{managed:["WR2"],brokerage:["BR2"],margin:["MAR"],investmentManage:["MAN"]}};function r(e,t){(a=t||a).profileType?e&&e.profileType?(this.profileType=e.profileType,e.segmentType&&(this.segmentType=e.segmentType),e.userType&&(this.userType=e.userType),e.accountTypes&&(this.accountTypes=e.accountTypes)):n.error('missing accountInfo property "profileType"'):n.error('missing customMapper properties "profileType"')}function o(){return this.segmentType||(this.segmentType=t.getData("segment"),this.segmentType||n.error("Caller attempted to get segment from siteData before siteData was initialized.")),this.segmentType}function s(){var e;return this.accountTypes||(e=t.getData("accountTypes"),this.accountTypes=e&&!Array.isArray(e)?e.split("+"):e,this.accountTypes||n.error("Caller attempted to get accountType from siteData before siteData was initialized.")),this.accountTypes}function c(e){return"segmentType"===e?o.call(this):"accountTypes"===e?s.call(this):this[e]}return r.prototype={constructor:r,isAvailableInMapperList:function(e,t){var n,i,r,o=a[e]&&a[e][t];if(o){if("string"==typeof(r=c.call(this,e)))return-1!==o.indexOf(r);if(r instanceof Array)for(i=r.length,n=0;n<i;n++)if(o.indexOf(r[n])>-1)return!0}return!1},isCommercialUser:function(){return this.isAvailableInMapperList("segmentType","commercial")},isWealthyUser:function(){return this.isAvailableInMapperList("segmentType","wealthy")},isSmallBusinessUser:function(){return this.isAvailableInMapperList("segmentType","smallBusiness")},isBusinessBankingUser:function(){return this.isAvailableInMapperList("segmentType","businessBanking")},isGWMUser:function(){return this.isPrivateBankUser()||this.isJPMSecuritiesUser()},isBusinessUser:function(){return this.isCommercialUser()||this.isSmallBusinessUser()},isPersonalUser:function(){return this.isAvailableInMapperList("profileType","personal")},isGeminiUser:function(){return this.isAvailableInMapperList("profileType","gemini")},isMultiTinUser:function(){return this.isAvailableInMapperList("profileType","multiTin")},isMultiChannelUser:function(){return this.isAvailableInMapperList("profileType","multiChannel")},isBusinessBankingUserProfile:function(){return this.isAvailableInMapperList("profileType","businessBanking")},isSubUser:function(){return this.isAvailableInMapperList("userType","subUser")},isJPMSecuritiesUser:function(){return this.isAvailableInMapperList("segmentType","jpmSecurities")},isPrivateBankUser:function(){return this.isAvailableInMapperList("segmentType","privateBanking")},isFinancialAdvisor:function(){var e=t.getData("userType");return e?e.indexOf("FinancialAdvisor")>-1:(n.warn("siteData.userType is not set."),!1)},isGWMEmulationMode:function(){return this.isFinancialAdvisor()&&this.isWealthyUser()},isManagedBrokerage:function(){return this.isAvailableInMapperList("accountTypes","managed")},isBrokerage2:function(){return this.isAvailableInMapperList("accountTypes","brokerage")},isMargin:function(){return this.isAvailableInMapperList("accountTypes","margin")},isOlympic:function(){return this.isAvailableInMapperList("accountTypes","investmentManage")},isEligibleForRealTimeData:function(){return this.isBrokerage2()||this.isManagedBrokerage()||this.isMargin()||this.isOlympic()},isMerchantServicesUser:function(){return e=i.DETAIL_TYPE.MERCHANT,t.getData("accountTypes")?t.getData("accountTypes").indexOf(e)>-1:(n.warn("siteData.accountTypes is not set."),!1);var e},getSegment:o,getAccountType:s},r})),define("appkit-utilities/aop/console",["require","blue/root","blue/intercept","blue/log"],(function(e){return function(t){var n=e("blue/root");if("console"in n&&t.ccLogs&&!0===t.ccLogs.enabled){var i,a=[],r=e("blue/intercept").before,o=e("blue/log"),s=["DEBUG","WARN","ERROR"],c={info:0,debug:0,log:0,warn:1,error:2,assert:2},l=2,d=t.ccLogs.level;return d===s[1]?l=1:d===s[0]&&(l=0),Object.keys(c).forEach((function(e){if(e in n.console&&c[e]>=l){var t="Console client error logs : "+e+": ",s=o(t);i=r(n.console,e,(function(){arguments[0]!==t&&s.error.apply(s,arguments)})),a.push(i)}})),{removeConsoleLog:function(){for(var e=0;e<a.length;e++)a[e].remove()}}}}})),define("appkit-utilities/cookie/cookie",["require","blue/store/enumerable/cookie","blue/util","blue/is","blue/dom","blue/log"],(function(e){var t=new(e("blue/store/enumerable/cookie"))(null,!0),n=e("blue/util").object.extend,i=e("blue/is"),a=e("blue/dom"),r=e("blue/log")("[Cookie]"),o=a.location&&a.location.hostname,s=a.location&&a.location.protocol,c="."+o.split(".").slice(-2).join("."),l=/^https:$/i.test(s),d={expires:1,path:"/",domain:"localhost"!==o&&o?c:"localhost"};function u(e,a,o){var s=new Date,c=o&&o[e]||{},u=c&&c.name||"",p=n({},d,c);if(u)return i.undefined(a)||(null!==a&&s.setYear(s.getFullYear()+p.expires),null===c.expiry&&(s=null),i.boolean(c.secure)&&(l=c.secure),t.set(u,a,s,p.path,p.domain,l)),t.get(u);r.warn("cookie "+e+" not exist!")}return function(e,t){if(i.string(e)&&i.object(arguments[arguments.length-1])){if(2===arguments.length)return u(e,void 0,t);if(3===arguments.length)return u.apply(this,arguments)}r.warn("Please provide the correct arguments")}})),define("appkit-utilities/data/converter",[],(function(){return{b64toBlob:function(e,t,n){t=t||"",n=n||512;for(var i=atob(e),a=[],r=0;r<i.length;r+=n){for(var o=i.slice(r,r+n),s=new Array(o.length),c=0;c<o.length;c++)s[c]=o.charCodeAt(c);var l=new Uint8Array(s);a.push(l)}return new Blob(a,{type:t})}}})),define("appkit-utilities/formUtil/formUtil",["require","blue/$","blue/log","blue-app/cache/sessionCache"],(function(e){var t=e("blue/$"),n=e("blue/log")("[formUtil]"),i=e("blue-app/cache/sessionCache"),a={},r=function(e){return e.params&&e.params.isPopUp},o=function(e){return r(e)?e.formAttr.title:e.formAttr.target?e.formAttr.target:e.formAttr.downLoad?"_self":"_blank"},s=function(e){var a,r=e.serviceUrl||"service-/svc/rl/accounts/secure/v1/csrf/token/list",s=i.get(r),c=s?s.response.csrfToken:"",l=t("<form></form>").attr({method:e.formAttr.method,action:e.formAttr.action,target:o(e)}).hide();Object.keys(e.inputData).forEach((function(n){var i=t("<input>").attr({type:"hidden",name:n,value:e.inputData[n]});l.append(i)}));var d=t("<input>").attr({type:"hidden",name:"csrftoken",value:c});l.append(d),a=t("<input>").attr({type:"submit",name:"submit",value:"Submit"}),t("body").append(l.append(a)),a.click(),n.info(">>>>>Form post done"),l.remove()};return{dynamicFormSubmit:function(e){r(e)?function(e){var t=a[e.formAttr.title],n=!1;try{n=t&&t.opener}catch(e){}n?t.focus():(a[e.formAttr.title]=window.open("",e.formAttr.title,e.params.isPdf?"pdf":"resizable=1,width="+e.params.popUpWidth+",height="+e.params.popUpHeight),s(e))}(e):s(e)}}})),define("appkit-utilities/personalization/personalization",["require","blue/is","blue-app/settings","blue-app/validate/var/ZIP_CODE_REGEX","blue/store/enumerable/cookie","blue/siteData","blue/declare"],(function(e){var t=e("blue/is"),n=e("blue-app/settings"),i=e("blue-app/validate/var/ZIP_CODE_REGEX"),a=new(e("blue/store/enumerable/cookie"))(null,!0),r=e("blue/siteData");return e("blue/declare")({constructor:function(e,t){var i=n.get("persona");this.persona=i||{},this.geoFreshnessCookieName=t||"_geoFreshness",this.geoZipCookieName=e||"_geoZip"},getPersona:function(){return this.persona},getZipCode:function(){var e=this.persona.zip||r.getData("geoZip");return e&&(e=e.substring(0,5),i.test(e))?e:null},getEci:function(){return this.persona.ECI||null},getSegment:function(){return this.persona.segment||null},getLocale:function(){var e=this.persona.locale;return e&&t.string(e)||(e=null),e&&(e=e.replace("_","-")),e||"en-us"},getGeoZipCode:function(){var e=a.get(this.geoZipCookieName);return e||(e=this.getZipCode())&&a.set(this.geoZipCookieName,e,null,"/",".chase.com",!0),e},getGeoImageFreshness:function(){var e=a.get(this.geoFreshnessCookieName);return e||(e=(new Date).getMonth(),a.set(this.geoFreshnessCookieName,e,null,"/",".chase.com",!0)),e}})})),define("appkit-utilities/language/helper",["require","blue/resource/persona","blue-app/settings","blue/siteMode","blue/store/enumerable/cookie","appkit-utilities/personalization/personalization"],(function(e){var t=new(e("blue/resource/persona")),n=e("blue-app/settings"),i=e("blue/siteMode"),a="en-us",r=new(e("blue/store/enumerable/cookie"))("splash",!1,null,"/",".chase.com",!0),o=new(e("appkit-utilities/personalization/personalization"));function s(){return n.get("language",n.Type.PERM)||n.get("language")||n.get("languageDefault")||a}function c(){return!i.isModeEnabled("internationalizationSplash")}function l(){return c()?s():a}function d(){return l().split("-")[0]}return{getLanguage:l,getUserLanguage:s,getLanguagePrefix:function(){return l().replace("-","_")},isUserAllowedForeignLanguage:c,getContentLanguage:d,isLanguageSetTo:function(e){if("string"!=typeof e)throw new Error('argument "language" should be a 2 characters string, e.g. "en"');return d()===e},isPersonaLocaleForeignLanguage:function(){var e=t.read(),n=e&&e.locale?e.locale.replace("_","-"):"";return!!n&&n!==a},isCurrentLanguageSetToDefault:function(){var e=o.getLocale();return n.get("languageDefault")?e===n.get("languageDefault"):e===a},isInternationalizationEnabled:function(e){var t=n.get("languageSplashUnavailableSegments"),i=o.getSegment()||"";if(!t)throw new Error('setting "languageSplashUnavailableSegments" is undefined');return!e&&-1===t.indexOf(i.toUpperCase())},clearSplashViewed:function(){r.remove("internationalizationSplashSeen")},setSplashViewed:function(){r.set("internationalizationSplashSeen",!0)},getSplashViewed:function(){return r.get("internationalizationSplashSeen")}}})),define("appkit-utilities/podCookie/podCookie",["require","blue/log","blue/store/enumerable/cookie","blue/siteData","blue/root"],(function(e){return function(t){var n=t&&t.name||"POD",i=e("blue/log")("["+n+"Cookie]"),a=new(e("blue/store/enumerable/cookie"))(null,!0),r=e("blue/siteData"),o=t&&r.getData(t.siteDataPodID),s=t&&t.podCookieName||"podKey",c=o||t&&t.podCookieDefaultValue||1,l=e("blue/root"),d=l.location&&l.location.hostname||"",u=d&&"."+d.split(".").slice(-2).join("."),p=""===d?"":("localhost"===d?"localhost":t&&t.domain)||u,f=t&&t.path||"/",m=t&&t.expires||new Date((new Date).setYear((new Date).getFullYear()+1));i.warn("podCookie has been DEPRECATED, please use appkit/cookie/cookie.js."),a.set(s,c,m,f,p,!0),i.debug("Created "+n+" cookie")}})),define("appkit-utilities/rapidash/rapidash",["require","blue/util","blue/intercept","blue/log"],(function(e){var t,n=e("blue/util"),i=e("blue/intercept"),a=e("blue/log")("[rapidash]"),r=function(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)},o=function(e){return e?e.toString():""},s=function(e){return o(e).toUpperCase()},c=function(e){return function(){var t=Array.prototype.slice.call(arguments),i=t[0];return Array.isArray(i)?n.array[e].apply(this,t):"object"==typeof i?n.object[e].apply(this,t):void 0}};return t={combine:n.array.combine,compact:n.array.compact,difference:n.array.difference,intersection:n.array.intersection,invoke:n.array.invoke,range:n.array.range,sort:n.array.sort,union:n.array.union,unique:n.array.unique,toHtmlString:function(e){for(var t='<ul class="account-service-list">',n=0,i=e.length;n<i;n++)t+="<li>"+e[n]+"</li>";return t+"</ul>"},objToHtmlString:function(e,t){for(var n='<ul class="account-service-list">',i=0,a=e.length;i<a;i++)n+="<li>"+e[i][t]+"</li>";return n+"</ul>"},flatten:function(e){for(var t=[],n=0,i=e.length;n<i;n++)Array.isArray(e[n])?t=t.concat(e[n]):t.push(e[n]);return t},findByKey:function(e,t,i){return n.array.find(e,(function(e){return e[t]===i}))},compose:n.function.compose,debounce:n.function.debounce,partial:n.function.partial,prop:n.function.prop,series:n.function.series,times:n.function.times,wrap:n.function.wrap,equals:n.object.equals,every:n.object.every,extend:n.object.extend,filter:n.object.filter,find:n.object.find,functions:n.object.functions,get:n.object.get,has:n.object.has,map:n.object.map,merge:n.object.merge,set:n.object.set,unset:n.object.unset,deepCopy:function(e){var t={};return n.object.extend(!0,t,e),t},restructureObject:function(e){if(r(e)){var t={};return Object.keys(e).forEach((function(i){r(n.object.get(t,i))||n.object.set(t,i,e[i])})),t}return e},intersectObjects:function(e,t){if(!r(e)||!r(t))throw new Error('type error: function "intersectObjects" argument "o1, o2" must be type "object"');for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]||(t[n]=null))},values:function(e){var t=[];if(r(e))for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},bindMethods:function(e){Object.getOwnPropertyNames(e.constructor.prototype).forEach((function(t){"function"==typeof e[t]&&(e[t]=e[t].bind(e))}))},subclass:function(e,t){return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t},camelCase:n.string.camelCase,escapeHtml:n.string.escapeHtml,hyphenate:n.string.hyphenate,interpolate:n.string.interpolate,makePath:n.string.makePath,properCase:n.string.properCase,properCaseForNames:function(e){return function(e){return o(e).toLowerCase()}(e).replace(/^\w|\s\w|[-'](?=[a-zA-z])[a-zA-z]/g,s)},removeNonASCII:n.string.removeNonASCII,removeNonWord:n.string.removeNonWord,stripHtmlTags:n.string.stripHtmlTags,truncate:n.string.truncate,typecast:n.string.typecast,unCamelCase:n.string.unCamelCase,unescapeHtml:n.string.unescapeHtml,unhyphenate:n.string.unhyphenate,snakeCase:function(e){return n.string.unCamelCase(e,"_")},lispCase:function(e){return n.string.unCamelCase(e,"-")},max:c("max"),min:c("min"),pick:c("pick"),pluck:c("pluck"),forEach:function(e,t){var n;if(Array.isArray(e))e.forEach(t);else if("object"==typeof e)for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},serialize:function(e,t,i){var a={};i.forEach((function(e,n){a[t+"["+n+"]"]=e})),n.object.extend(!1,e,a)},updateModel:function(e,t){var n;if(!r(t))throw new Error('type error: function "update" argument "object" must be type "object"');for(var i in t)if(t.hasOwnProperty(i))if(Array.isArray(t[i])){var a,o=0;for(a=(n=t[i]).length,e.set(i,[]);o<a;o++)e.set(i+"."+o,n[o])}else e.set(i,t[i])},isObject:r,toObject:function(e){var t={};return void 0===Function.prototype.name&&Object.defineProperty(Function.prototype,"name",{get:function(){return/function ([^(]*)/.exec(this+"")[1]}}),e.forEach((function(e){"function"==typeof e?t[e.name]=e:t[e]=e})),t},setValueOrDefault:function(e,t){return e||(t||"")}},a.warn("Appkit Rapidash is deprecated. Please start using blue/util directly or move logics into your scrum codes"),Object.keys(t).forEach((function(e){i.after(t,e,(function(){a.warn("rapidash."+e+" is deprecated. Please start using blue/util directly.")}))})),t})),define("appkit-utilities/xDomainChannel/connector",["require","exports","module"],(function(e,t,n){return function(){var e,t,n={};function i(){return n}function a(e,n){var a=i();if(!a.appContext||n){if(e||"number"==typeof e||(e=Date.now()),t)if((t[a.hostId]||"")===e)return;r({action:"add",id:a.hostId,time:e})}}function r(t){e&&e.contentWindow.postMessage(t,i().target)}return{init:function(n){var r=i();return function(e,t){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.id=e.id||"smframe",t.hostId=function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t}(window.location.href),t.target=e.target||"http://localhost",t.host=e.host||"http://localhost",t.url=t.target+"?host="+t.host+"&id="+t.hostId}(n,r),r.appContext&&r.appContext.on("timeout:resetTime",(function(){a(Date.now(),!0)})),window.addEventListener("message",(function(e){t=e.data||{},r.peerActivityCallback&&r.peerActivityCallback.call(this,e.data)})),e=function(e){var t,n=e||i();if(!n.url||!n.id)return;return(t=document.createElement("iframe")).src=n.url,t.id=n.id,t.width=0,t.height=0,t.style="width:0; height:0; border:0; border:none;",document.body.insertAdjacentElement("afterend",t),t}(r),r.hostId},update:a,logoff:function(){r({action:"logoff",id:i().hostId})},getId:function(){if(!n.hostId)throw new Error("xDomainChannel().init() must be invoked prior to requesting getId()");return n.hostId}}}})),define("appkit-utilities/sessionTimeout/timeout",["require","exports","module","blue/site","blue/hash","blue-app/settings","blue/event/channel/domEvents","appkit-utilities/xDomainChannel/connector"],(function(e,t,n){"use strict";var i,a,r=e("blue/site"),o=e("blue/hash"),s=e("blue-app/settings"),c=e("blue/event/channel/domEvents"),l=0,d=!1,u=!1,p=null,f=Date.now||(new Date).getTime,m=function(){var e=f(),t=(s.get("lastServiceCallTime")||f())+1e3*a.sessionDelay,n=p+1e3*a.areYouThereDelay,r=p+1e3*a.serviceDelay;n<=e&&!u&&(i.broadcast("timeout:showModal"),u=!0),t<=e&&(i.logger.debug("time to call service"),i.broadcast("timeout:extendSession")),r<=e&&i.broadcast("timeout:proceedToLogoff",{isSessionTimeout:!0,needToHideOverlay:!1})},g=function(){i.logger.debug("User activity detected: "+p),p=f(),i.emit("timeout:resetTime",p)},h=function(){clearInterval(l),l=0},v=function(){return 0!==l},y=function(){!function(e){if(d=!1,a.excludedActions)for(var t=0;t<a.excludedActions.length;++t)if(e===a.excludedActions[t])return d=!0;return d}(o.getHashArr()[1]||"index")?v()||(g(),l=setInterval(m,1e3*a.timeoutInterval)):h()},b=function(){i.logger.debug("Extend Session"),p=f(),u=!1},C=function(){i.logger.debug("No activity, Logging off"),u=!1,h()};return{init:function(t,o){var l=s.get("lastServiceCallTime")||f(),m=t.allowOverrideTimeout&&window.location.href.indexOf("?A59")>0;t.serviceDelay=m?120:t.serviceDelay,t.areYouThereDelay=m?60:t.areYouThereDelay,t.sessionDelay=m?80:t.sessionDelay,a=t,p=f(),(i=o||r.context).logger.debug("Session Timeout Initialized"),s.set({lastServiceCallTime:l},s.Type.USER),c.on((function(e){!v()||d||e.target!==window||"keydown"!==e.type&&"click"!==e.type||u||g()})),i.on({"blue:routeChange":y,"timeoutComponent:requestSessionExtension":b,"timeoutComponent:proceedToLogoff":C,"messenger:userActivity":function(){u||g()}});var h=n.config()||{};if("object"==typeof h&&h.enableCrossDomainCommunication){var A,I=e("appkit-utilities/xDomainChannel/connector")();i.on("timeoutComponent:beginCrossDomainSession",(function(){!A&&h.target&&h.host&&(A=I.init({target:h.target,host:h.host,peerActivityCallback:function(e){i.logger.debug("User activity detected in partner site"),"logoff"===e[e.lastUpdatedBy]?i.emit("timeoutComponent:proceedToLogoff"):i.emit("messenger:userActivity")},appContext:i}))}))}y()}}})),define("appkit-utilities/VOC/util",["require","blue-app/with/locationAPI","blue/siteData","blue/log","appkit-utilities/language/helper","blue/routeHistory","blue/is","blue/util"],(function(e){var t=new(e("blue-app/with/locationAPI")),n=e("blue/siteData"),i=e("blue/log")("[VOCUtil]"),a=e("appkit-utilities/language/helper"),r=new(e("blue/routeHistory")),o=e("blue/is"),s=e("blue/util").object.extend,c={resizable:"yes",location:"no",status:"no",scrollbars:1,width:570,height:630,top:parseInt((screen.height-570)/2),left:parseInt((screen.width-630)/2)};function l(e){var o,c,l,d,u=a.isLanguageSetTo("es")?"/lang=es":"",p=t.getLocationProtocolAndServer()+t.getLocationPath()+"#",f=r.getHistory(0)?p+r.getHistory(0).url:"",m="",g=t.getLocationURL(),h=(new Date).getTime(),v={profileId:n.getData("ssv_pfid")||"",bSeg:n.getData("segment")||""};try{d=v,m="{"+Object.keys(d).map((function(e){return e+": '"+d[e]+"'"})).join(", ")+"}"}catch(e){i.warn("Error while performing JSON.stringify:",e)}if(l=e&&e.opinionLabParamsData&&e.opinionLabParamsData.referer||g){!l.endsWith("/")&&l.indexOf(";")<0&&(l+="/");try{l.endsWith("/")||(l+=";"),l+="bSeg="+n.getData("segment")+";brand="+n.getData("brandId")+u}catch(e){i.error("Error while performing referer URL")}l=encodeURIComponent(l)}return o={width:screen.width,height:screen.height,referer:encodeURIComponent(l),time1:h,time2:h,currentURL:encodeURIComponent(g+u),customVars:encodeURIComponent(m).replace(/'/g,"%27"),_rev:"2",custom_vars:"",ocodeVersion:"5.9",prev:encodeURIComponent(f),type:"Popup"},e&&e.opinionLabParamsData&&e.opinionLabParamsData.referer&&(e.opinionLabParamsData.referer=l),c=s({},o,e&&e.opinionLabParamsData),Object.keys(c).map((function(e){return e+"="+c[e]})).join("&")}return{openVOCSurvey:function(e,t,n){var a,r,d,u,p,f,m;(p=e&&o.string(e)?e:t,n=e&&o.string(e)&&t?t:n,p||o.string(p))?(e&&o.object(e)&&i.warn('voc/util: param "context" is no longer needed'),!n||o.plainObject(n)?(a=n&&n.windowName||"OnlineOpinion",r=l(n),d=s({},c,n&&n.windowFeatures),u="resizable="+(m=d).resizable+",location="+m.location+",status="+m.status+",scrollbars="+m.scrollbars+",width="+m.width+",height="+m.height+",top="+m.top+",left="+m.left,p+="?"+r,(f=window.open(p,a,u))&&f.focus()):i.error("options must be a plain object")):i.error("surveyUrl must be a string")}}})),define("appkit-utilities/jsBridge/jsBridge",["require","blue/root"],(function(e){"use strict";var t,n,i=e("blue/root"),a={};function r(e,a){var r,o,s,c=function(){n.logger.info('calling javaScript bridge "'+e+'"'),void 0!==a?i.JPKJavaScriptBridgeHandler[e](a):i.JPKJavaScriptBridgeHandler[e]()};i.hybrid&&(r=e,s=0,new Promise((function(e,n){o=setInterval((function(){i.JPKJavaScriptBridgeHandler&&i.JPKJavaScriptBridgeHandler[r]?(clearInterval(o),e()):s>=t?(clearInterval(o),n()):s++}),10)}))).then((function(){setTimeout(c,1)})).catch((function(){n.logger.error('javaScript bridge "'+e+'" is not available')}))}return a.init=function(e,o,s){var c;if(!e||!o)throw new Error("jsBridge: missing appContext or settings. jsBridge init failed.");if("function"!=typeof o)throw new Error("jsBridge: settings must be a function. Please follow the documentation.");t=s||500,c=o(r,i,n=e),Object.keys(c).forEach((function(e){a[e]?n.logger.warn("jsBridge."+e+' already exists. Please rename method "'+e+'"'):a[e]=c[e]}))},a.callBridge=r,a.assignContext=function(e){n=e.appContext,t=e.maxRetryCount||t},a})),define("appkit-utilities/analytics/data/hooks",[],(function(){return[{module:"appkit-utilities/content/dcu",ref:"dynamicSettings",method:"get"},{module:"appkit-utilities/content/dcu",ref:"dynamicSettings",method:"set"},{module:"appkit-utilities/content/dcu",ref:"dynamicContent",method:"get"},{module:"appkit-utilities/content/dcu",ref:"dynamicContent",method:"set"}]})),define("appkit-utilities/analytics/overlay",["require","blue/event/channel/component","blue/log"],(function(e){var t={},n=e("blue/event/channel/component"),i=e("blue/log")("[analytics-overlay]");function a(e){if(e&&e.output&&e.context&&e.context.is)return!0;var t=e&&e.name;return i.warn("INVALID_COMPONENT "+t),!1}function r(e,t){if(e.context.is.string(t)&&(a=t,r="Overlay",String.prototype.endsWith?a.endsWith(r):-1!==a.indexOf(r,a.length-r.length))){var n="";return e.spec&&e.spec.states&&e.spec.states[t]||(n="UNDEFINED_STATE "+t+" in "+e.name,i.warn(n)),{errorMsg:n}}var a,r;return i.warn("INVALID_STATE "+t+" in "+e.name),!1}function o(e,t,n,r){var o={value:t,overlayStatus:n,errorMsg:r},s=e.name||e.key||"Component";a(e)?e.output.emit("state",o):i.warn(s+" has been destroyed before "+t+" event could be emitted. Please wait for "+n+"Overlay to resolve before destroying component.")}function s(e,n){var i=t[n];e.context.is.array(i)&&i.map((function(e){e()})),delete t[n]}function c(e,i,a,r,c){return new Promise((function(l){var d=function(e,t,n){return e.name+"__"+t+"__"+n}(e,c,i);s(e,d),t[d]=n.on("action/"+c,(function(){o(e,i,a,r),s(e,d),l&&l()}))}))}return{showOverlay:function(e,t,n){var i=a(e)&&r(e,t);if(i){if(n)return c(e,t,"show",i.errorMsg,n);o(e,t,"show",i.errorMsg)}},hideOverlay:function(e,t,n){return a(e)&&r(e,t)?c(e,t,"hide","",n):Promise.reject(new Error("Invalid component or invalid state."))}}})),define("appkit-utilities/common/mediaQueryListener",["require","blue/$"],(function(e){var t=e("blue/$"),n={XS:"xs",SM:"sm",MD:"md",LG:"lg"},i=function(){return!!window.getComputedStyle&&window.getComputedStyle(document.body,":after")},a=function(e){return null===e.afterElement&&(e.afterElement=i()),null===e.afterElement?n.XS:e.afterElement.getPropertyValue&&e.afterElement.getPropertyValue("content").replace(/['"]+/g,"")},r=function(){this.afterElement=i(),this.currentBreakpoint=a(this),this.lastBreakpoint=this.currentBreakpoint,this.BREAKPOINT=n,this.init()};return r.prototype={init:function(){!1!==this.afterElement&&this._resizeListener()},_resizeListener:function(){var e=this;t(window).on("resize orientationchange load",(function(){e.currentBreakpoint=a(e),e.currentBreakpoint!==e.lastBreakpoint&&(t(window).trigger("breakpoint-change",e.currentBreakpoint),e.lastBreakpoint=e.currentBreakpoint)}))}},new r})),define("appkit-utilities/common/timerAPI",[],(function(){"use strict";var e={};return{timerMark:function(t,n){var i=(n=n||{}).timestamp||Date.now(),a=n.startStop||"";"start"===a&&(t="!"+t),"stop"===a&&(t+="!"),e[t]=i},timerReport:function(){var t=["LOAD TIMER"],n=[];for(var i in e)e.hasOwnProperty(i)&&n.push(e[i]+":"+i);if(n.length<2)return"";n.sort();var a,r,o=n[0].split(":")[1],s=n[0].split(":")[0];return n.length&&t.push(n[0].split(":")[0]+" : "+n[0].split(":")[1]),n.forEach((function(e,n,i){if(0!==n){var c=e.split(":")[1],l=e.split(":")[0],d=c.indexOf("!");0===d&&(s=l,o=c),d>0&&(r=l,a=c),t.push(l+" : "+c+" ( "+(l-i[n-1].split(":")[0])+"ms )")}})),r||(r=n[n.length-1].split(":")[0],a=n[n.length-1].split(":")[1]),t.push("Total ("+o+" -> "+a+"): "+(r-s)+"ms"),t.join("\n").replace(/\!/g,"")}}})),define("appkit-utilities/dataSet/util",[],(function(){function e(e,t){return e[t]}function t(e){return void 0===e?Number.NEGATIVE_INFINITY:"string"==typeof e?e.toUpperCase():e}function n(){}return n.prototype.sort=function(n,i,a){var r="asc"===a||!0===a?-1:1,o=-1===r?1:-1;return n.sort((function(n,a){if(Array.isArray(i))for(var s,c,l=0;l<i.length;){if(s=e(n,i[l]),c=e(a,i[l]),(s=t(s))!==(c=t(c))){n=s,a=c;break}l++}else n=e(n,i),a=e(a,i),n=t(n),a=t(a);return n<a?r:n>a?o:0}))},n.prototype.search=function(e,t,n){if((t=(t="number"==typeof t?String(t):t).trim())&&t.length>0){var i=new RegExp(t,"i");e=e.filter((function(e){if(n)return i.test(e[n]);for(var t in e)if(e.hasOwnProperty(t)&&i.test(e[t]))return!0}))}return e},new n})),define("appkit-utilities/experimentation/config/experimentationConfig",[],(function(){return{CommonAreas:[],ContentComponentSpecs:["UPDATE_PAPERLESS_PREFERENCES"],targetElements:[]}})),define("appkit-utilities/content/dcu",["require","blue/is","blue/util","blue-app/settings","blue/log"],(function(e){var t,n,i=e("blue/is"),a=e("blue/util"),r="LOCALIZED_CONTENT",o=e("blue-app/settings"),s=e("blue/log")("[appkit dcu]");function c(e){var t;return t=r,a.object.has(e,"context.area.areaName")?t=r+"_"+e.context.area.areaName.toString().toLowerCase():e.area&&(t=r+"_"+e.area.name.toString().toLowerCase()),t}function l(e){return a.object.has(e,"spec.name")?e.spec.name:e.context?e.context.componentName:e.name}function d(e,t){var n,s=l(e),d=o.get(r+"_app"),u=o.get(c(e)),p=e.globalSpecs,f=function(e,n){return-1!==n.indexOf(t+".")};if(n=function(e,t,n){return e&&e[n]?e[n]:t&&t[n]?t[n]:void 0}(u,d,s)||{},i.plainObject(n)){n=a.object.filter(n,(function(e,n){return-1!==n.indexOf(t+".")}));for(var m=0;p&&m<p.length&&0===Object.keys(n).length;m++)n=a.object.filter(d[p[m]],f)}return n}function u(e,t,n,d){var u,p=n,f=d,m=e.globalSpecs||[];return i.plainObject(n)&&(p=d,f=n),u=function(e,t,n,s){var d,u=null,p=l(e),f=o.get(r+"_app"),m=n?t+"."+n:t;return d=function(e,t,n,i){return e&&e[n]?e:t&&t[n]||t&&function(e,t){if(t)for(var n=0,i=t.length;n<i;n++)if(e[t[n]])return!0;return!1}(t,i)?t:void 0}(o.get(c(e)),f,p,s),i.plainObject(d)&&((u=d[p]&&a.object.get(d[p],m))||(u=d[p]&&d[p][m]?d[p][m]:function(e,t,n){for(var i,a,r=0;t&&r<t.length;r++)if(i=e[a=t[r]]&&e[a][n])return i}(f,s,m))),u}(e,t,p,m),i.undefined(u)&&s.warn("Content was undefined: contentKey:"+t+", variation:"+n),u=i.defined(u)&&i.defined(f)&&i.plainObject(f)?a.string.interpolate(u,f):u}function p(e,t,n,r){var o=u.call(this,e,t,n,r);return i.undefined(o)&&s.warn("Content was undefined: contentKey:"+t+", variation:"+n),e[a.string.camelCase(t)]=o,o}function f(e,t,a){var r={};if(!i.array(t))throw s.warn("arrayOfContentKeys must be an array containing objects in the following format: {key, variation, props}"),new Error("arrayOfContentKeys must be an array containing objects in the following format: {key, variation, props}");for(var o=0;o<t.length;o++){var c=t[o];r[c.key]=a?n.get(e,c.key,c.variation,c.props):n.set(e,c.key,c.variation,c.props)}return r}return t={dynamicSettings:{get:u,set:p},dynamicContent:{get:u,set:p,getMultiple:function(e,t){return f(e,t,!0)},setMultiple:function(e,t){return f(e,t,!1)},getList:function(e,t,n,i){var a,r,o=d(e,t),s=[];return Object.keys(o).forEach((function(e){a={},(r=e.split(".")).length>1&&(a[n]=o[e],a[i]=r[1],s.push(a))})),s},getVariations:d,getGlobal:function(e,t){var a=e,r=t,o="GLOBAL";i.object(e)&&(a=e.label,r=e.variation,o=e.globalName||o);var s={area:{name:"app"},spec:{name:o}};return n.get(s,a,r)},setForBinding:function(e,t,n,i){var a=u.call(this,e,t,i);e[n]=a}}},n=t.dynamicContent,t})),define("appkit-utilities/experimentation/content/contentOverride",["require","appkit-utilities/experimentation/config/experimentationConfig","blue/intercept","blue-view/nodeDictionary","blue-app/settings","blue/is","appkit-utilities/content/dcu","blue/log"],(function(e){var t,n=e("appkit-utilities/experimentation/config/experimentationConfig"),i=e("blue/intercept"),a=e("blue-view/nodeDictionary"),r=e("blue-app/settings"),o=e("blue/is"),s=e("appkit-utilities/content/dcu"),c=e("blue/log")("[contentOverride]"),l={};function d(e,t,n,i,a){var r=e.EXPERIMENTS;return r&&r[t]&&r[t][a+"."+n]&&r[t][a+"."+n][i]}function u(e){for(var t,n,i,a,r,c=0,d=e.length,u=0;c<d;c++)if(e[c].experimentId,t=e[c].parameter,e[c].choice,n=e[c].component,i=l[n],o.defined(i))for(u=i.length;u--;)r=i[u].component,o.defined(r)&&(t=t.split("."),a=s.dynamicSettings.set(r,t[0],t[1]),o.undefined(t[1])&&(i[u].component.spec.settings[t[0]].value=a));delete l[n]}return{init:function(){var e,r,s,c,d=this,u=n.ContentComponentSpecs||[],p=[];e=u.length,t=i.on(a,"add",(function(){r=(s=arguments[1]).component&&s.component.name,!o.defined(r)||-1===u.indexOf(r)&&0!==e||(c=l[r],(p=c||[]).push(s),l[r]=p),0!==e&&e===Object.keys(l).length&&(d.overrideExperimentContent(),d.unplugComponentRegister())}))},unplugComponentRegister:function(){setTimeout(t&&t.remove,1e3)},setExperiment:function(e){this.experiments=e},getExperiment:function(){return this.experiments},overrideExperimentContent:function(){var e=this.getExperiment();if(o.defined(e)){for(var t,n,i,a=Object.keys(e),s=0,c=this,l=a.length;s<l;s++)t=a[s],n=t.toString().toLowerCase(),i=r.get("LOCALIZED_CONTENT_"+n),o.defined(i)&&o.defined(e[t].content)&&!o.empty(i)&&(i=c.overrideCq5Content(i,t),r.set("LOCALIZED_CONTENT_"+n,i,r.Type.ENV),u(e[t].content));this.unplugComponentRegister()}},overrideCq5Content:function(e,t){var n=this.getExperiment();if(o.defined(e)&&o.defined(n)&&!o.empty(n)){var i,a,r,s,l,u=n[t],p=0,f=0;if(u=u&&u.content,o.defined(u))if(e.EXPERIMENTS)for(p=u.length;f<p;f++)i=u[f].experimentId,a=u[f].parameter,r=u[f].choice,s=u[f].component,"control"!==r&&(e[s]&&e[s][a]?(l=d(e,i,a,r,s))?e[s][a]=l:c.error("Experimentation overrideCq5Content failed: cannot get choice "+r+" for setting '"+a+"' in component '"+s+"' in cq5 bundle of area '"+t+"'"):c.warn("Experimentation overrideCq5Content failed: content for setting '"+a+"' does not exist in component '"+s+"' area '"+t+"'"));else c.error("Experimentation overrideCq5Content failed: EXPERIMENTS does not exist in cq5 bundle of area '"+t+"'")}return e}}})),define("appkit-utilities/content/contentSvc",["require","exports","module","blue/is","blue/device","blue/log","blue-app/settings","blue/resource/persona","appkit-utilities/experimentation/content/contentOverride","blue/util","blue/root"],(function(e,t,n){"use strict";var i=e("blue/is"),a=e("blue/device"),r=e("blue/log")("[contentService]"),o=e("blue-app/settings"),s=e("blue/resource/persona"),c=e("appkit-utilities/experimentation/content/contentOverride"),l=e("blue/util").object.extend,d=e("blue/root").hybrid;return function(){this.context||(this.context={});var e=this.context.brandIdCookie&&this.context.brandIdCookie(),t=a.shortLang,u=!!i.defined(d)&&d,p="LOCALIZED_CONTENT_",f=n.config()?n.config():{},m=function(e,t){return i.defined(f[e])?f[e]:o.has(e)?o.get(e):t},g={ignoreSiteAndVersion:m("ignoreSiteAndVersion",!1),localBackup:m("localBackup",!1),useLocalContent:m("useLocalContent",!1),remoteContentUrl:m("remoteContentUrl",""),localContentUrl:m("localContentUrl",""),contentSite:m("contentSite",""),contentVersion:m("contentVersion",""),contentBrand:e||(i.defined(f.contentBrand)?f.contentBrand:""),contentViewType:u?"HYBRID":""},h=function(e){var t=f.contentUrls[e];return!!i.defined(t)&&i.defined(f.useLocalContent?t.local:t.remote)},v=function(e,n){var a=e?e.toString().toLowerCase():"app";if(n.success&&i.plainObject(n.result)){if(n.result.language===t&&(g.ignoreSiteAndVersion||n.result.version===g.contentVersion&&n.result.site===g.contentSite)){var s=c.overrideCq5Content(n.result.bundles,e);return o.set(p+a,s,o.Type.ENV),n}return r.warn("Remote content server response does not match requested language, version, or site"),o.set(p+a,{},o.Type.ENV),{}}return r.warn("Remove content server response was not successful or was formatted incorrectly"),o.set(p+a,{},o.Type.ENV),{}},y=function(e){var t=e?e.toString().toLowerCase():"app";return o.set(p+t,{},o.Type.ENV),{}},b=function(e,t,n){var i={url:e.getContentUrl(t)};return n&&l(i,n),e.remoteContent({},i).then(v.bind(e,t)).catch(y.bind(e,t))};!u&&o.has("contentLanguage")?t=o.get("contentLanguage"):i.defined(f.contentLanguage)&&(t=f.contentLanguage),this.hasAreaBasedContentSupport=i.defined(f.contentUrls),this.hasAreaBasedContentSupport||(f.contentUrls={app:{remote:g.remoteContentUrl,local:g.localContentUrl}}),this.hasContentLocation=h("app"),this.getContentUrl=function(e){var n=f.contentUrls[e||"app"];return n?function(e){if(!e)return"";for(var n=!0===f.useBrandContent&&g.contentBrand||"",i=e,a=/:[a-zA-Z]+/g,r={":language":t,":site":g.contentSite,":version":g.contentVersion,":brand":n,":viewtype":g.contentViewType},o=null;o=a.exec(e);){var s=o[0],c=r[s]||"";i=i.replace(s,c)}return i.replace(/([^a-zA-Z])_/g,"$1").replace(/_([^a-zA-Z])/g,"$1").replace(/([^:])\/+/g,"$1/")}(f.useLocalContent?n.local:n.remote):""},this.checkContentMapping=h,this.getAppContent=function(e){return h("app")?b(this,"app",e):Promise.reject("App specific content bundle not available")},this.getAreaContent=function(e,t){return e&&!h(e)?Promise.reject("Area based content not available"):b(this,e,t)},this.setLanguage=function(e){var t=new s,n=t.read(),a=e.replace("-","_");o.set("language",e,o.Type.PERM),o.set("contentLanguage",e.split("-")[0]),this.settings("remoteContent").url=this.getContentUrl("app"),1===a.split("_").length&&(a+="_us"),i.defined(n)&&i.plainObject(n)&&(n.locale=a,t.update(n))},this.serviceCalls={remoteContent:{settings:{method:"GET",redirect:!0,timeout:3e4,xhrFields:{withCredentials:!1},disableCsrf:!0,byPassUserProfileService:!0,url:this.getContentUrl("app")}}}}})),define("appkit-utilities/content/globalContentMixin",["require","blue-app/settings"],(function(e){var t,n=e("blue-app/settings"),i=function(){};return function(e,a){var r,o,s,c,l,d=this,u=d.context.is,p=n.get("LOCALIZED_CONTENT_app",n.Type.ENV);function f(e,t){d.model.set(e,t),Object.defineProperty(d,e,{get:function(){return d.model.get(e)},set:function(t){d.model.set(e,t)},configurable:!0,enumerable:!0}),d._("settings")||d._("settings",{}),d._("settings")[e]||(d._("settings")[e]={value:t})}function m(e){var t,n;if(!u.object(o))return!1;n=(t=Object.keys(o)).length;for(var i=0;i<n;i++){var a=t[i].split(".");if(a[0]===e)return 1===a.length?o[e]:null}return!1}if(r=(l=a)&&l.indexOf("GLOBAL")>=0?a:"GLOBAL",o=p&&p[r],!u.defined(e))throw d.context.logger.warn("contentKeys must be defined. A string or array of string keys is acceptable."),new Error("contentKeys must be defined. A string or array of string keys is acceptable.");if(!u.string(e)&&!u.array(e))throw d.context.logger.warn("contentKeys must be a string or an array."),new Error("contentKeys must be a string or an array.");u.string(e)&&(e=[e]),(s=d.globalSpecs||[]).push!==i&&(t=s.push,s.push=i),-1===s.indexOf(r)&&t.apply(s,[r]),d.globalSpecs&&delete d.globalSpecs,Object.defineProperty(d,"globalSpecs",{value:s,writable:!1,configurable:!0}),c=e.length;for(var g=0;g<c;g++){var h=e[g],v=m(h);v||null===v?f(h,v):d.context.logger.warn("GlobalContentMixin: contentKey that was passed in does not exist in the global spec. Key: "+h)}}})),define("appkit-utilities/content/interceptor/validator",[],(function(){"use strict";var e=!1,t=/showcontentlabels=true/gi;return{around:function(n){return new Promise((function(i,a){n.proceed().then((function(a){try{if(e=e||"SHOWCONTENTLABELS"===n.target.context.state().query.string||t.exec(n.target.context.state().query.string.toLowerCase()))return void i(function(e){if(e&&e.result&&e.result.bundles){var t=e.result.bundles;for(var n in t)for(var i in t[n])t[n][i]=i}return e}(a))}catch(e){}i(a)})).catch((function(e){a(e)}))}))}}})),define("appkit-utilities/messenger/protocolManager",[],(function(){"use strict";var e=function(e,t,n){return this.current=n[e]===t?n:null,null!==this.current};function t(){this.protocols=[],this.current={commandList:[]}}return t.prototype=Object.create(null),t.prototype.constructor=t,t.prototype.clear=function(){this.protocols=[],this.current={commandList:[]}},t.prototype.inject=function(e){this.locate(e.protocol)?e.commandList.every(this.injectCommand.bind(this)):(this.protocols.push(e),this.current=this.protocols[this.protocols.length-1])},t.prototype.injectCommand=function(e){for(var t=0;t<this.current.commandList.length;t++)if(this.current.commandList[t].command===e.command)return this.current.commandList[t].action=e.action,!0;return this.current.commandList.push(e),!0},t.prototype.locate=function(t,n){if(this.protocols.some(e.bind(this,"protocol",t)))return n&&this.current.commandList.some(e.bind(this,"command",n)),this.current},t})),define("appkit-utilities/messenger/messengerProtocols",[],(function(){"use strict";return{protocols:[{protocol:"handshake",commandList:[{command:"ready",action:function(){}}]},{protocol:"sessionTimeout",commandList:[{command:"userActivity",action:function(){}}]},{protocol:"childEvent",commandList:[{command:"cancel",action:function(){this.shutdown()}},{command:"setTitle",action:function(){}},{command:"returnToAccounts",action:function(){this.shutdown()}},{command:"navigate",action:function(){this.shutdown()}},{command:"documentsnavigate",action:function(){this.shutdown()}},{command:"logoff",action:function(){this.shutdown()}},{command:"viewRendered",action:function(){}},{command:"error",action:function(){}},{command:"authSuccess",action:function(){this.shutdown()}},{command:"updateState",action:function(){}},{command:"stickyData",action:function(){}},{command:"interaction",action:function(){}},{command:"logService",action:function(){}},{command:"quickDepositPDF",action:function(e){}},{command:"returntoDWMApplication",action:function(e){this.shutdown()}},{command:"returnToAccountsWithProfileRefresh",action:function(e){this.shutdown()}},{command:"showExternalSpeedBump",action:function(e){}},{command:"showLanguageSpeedBump",action:function(e){}},{command:"setFocusToIFrame",action:function(e){}}]},{protocol:"displayEvent",commandList:[{command:"resize",action:function(){}},{command:"scrollTo",action:function(){}},{command:"getParentOffset",action:function(){}},{command:"setParentScroll",action:function(e){}},{command:"focus",action:function(){}}]},{protocol:"parentEvent",commandList:[{command:"requestState",action:function(){}}]}]}})),define("appkit-utilities/messenger/messenger",["require","blue/log","appkit-utilities/messenger/protocolManager","blue/root","blue/is","appkit-utilities/messenger/messengerProtocols"],(function(e){var t={},n=e("blue/log")("[messenger]"),i=new(e("appkit-utilities/messenger/protocolManager")),a=e("blue/root"),r=e("blue/is"),o=e("appkit-utilities/messenger/messengerProtocols"),s={},c=!1,l=!1,d=[],u=[],p=null,f=null,m=null,g=null,h=null,v=null,y=null,b=null,C=null,A=null,I=null,S=null,E=function(e,t,n){n||(n=a);for(var i=e.split(" "),r=0,o=i.length;r<o;r++)n.addEventListener(i[r],t,!1);u.push({type:e,node:n,listener:t})},w=function(e,t,n){for(var i=e.split(" "),a=0,r=i.length;a<r;a++)t.removeEventListener(i[a],n,!1)},D=function(){for(var e,t=0,n=u.length;t<n;t++)e=u[t],w(e.type,e.node,e.listener);u=[],l=!1,A=!1,c=!1},k=function(){try{if(d.length>0)for(n.info("draining queue of "+d.length+" messages");d.length>0;){var e=d.shift();p?S.postMessage(e,h):top.postMessage(e,h)}}catch(e){n.warn("Got postMessage domain error while draining queue: "+e)}},x=function(e){return(e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")).toLowerCase()},T=function(){return a.document.location.origin||x(a.document)},M=function(){p?(g=f,v="parent",h=m,y="child"):(g=m,v="child",h=f,y="parent")},O=function(e){if("object"==typeof e&&void 0!==e.command){if(e.domain||(e.domain=g),c&&l)k();else{if(!c)return n.info("Attempt to post a message ("+e.command+") before initialization complete, storing"),void d.push(e);if("ready"!==e.command)return n.info("Attempt to post a message ("+e.command+") when parent not loaded - storing"),void d.push(e)}n.info("Sending message: "+e.command);try{p?S.postMessage(e,h):top.postMessage(e,h)}catch(e){n.warn("postMessage error: "+e)}}else n.info("Message in invalid format: "+e+" ignoring")},P=function(e){switch(n.info("Got <"+e.command+"> command from domain "+e.domain),e.command){case"ready":p?(l&&A&&(l=!1,A=!1,R(!0)),l=!0,k(),A||(O({protocol:"handshake",command:"ack",ackCommand:"ready",domain:g,message:v+" ready"}),A=!0,s&&s[e.command]&&s[e.command]())):(n.info(v+" is ready. We are ready to go"),l=!0,k(),O({command:"ack",ackCommand:"ready",domain:g,message:v+" ready ACK"}));break;case"ack":n.info("Got ack, "+y+" domain is "+e.domain+" and current "+y+" domain is "+h),k(),l=!0;break;default:!function(e){var a=i.locate(e.protocol,e.command),r="messenger:"+e.command;a?(n.info("Match found for <"+e.command+"> executing"),(s&&s[e.command]?s[e.command]:a.action.bind(t))(e),e.context?e.context.eventId=r:e.context={eventId:r},b&&b.broadcast(e.context.eventId,e.context)):n.info("Protocol unrecognized: "+e.command+". Aborting.")}(e)}},L=function(e){if(n.info("Listener entered. Origin is "+e.origin),e.origin===h)n.info("Origin ok");else{var t=e.origin.toLowerCase();if(!(I.indexOf(t)>=0))return void n.info("Received message from unrecognized origin: "+e.origin+" - ignoring");n.info("Switching receivingDomain from ["+h+"] to ["+t+"]"),h=t,p&&(m=t,S=a.document.getElementById(C).contentWindow)}if(e&&e.data){var i=e.data;if(!i.command)return void n.info("Message unrecognized, ignoring");P(i)}else n.info("Missing event or event data, ignoring")}.bind(this),N=function(){E("message onmessage",(function(e){L(e)})),E("unload",D)},R=function(e){var t,i=a.document.getElementById(C);if(i)if(n.debug("Found the iframe with id = "+C),t=i.src){S=i.contentWindow;var r=t.split("/");m=""===r[0]?x(S):(r[0]+"//"+r[2]).toLowerCase(),f=T(),M(),n.debug("Found domains | "+v+" domain: "+g+" | "+y+" domain: "+h),c=!0,e||(N(),n.debug("Initialized OK"),O({command:"ready",domain:g,message:v+" ready"}))}else n.warn("FATAL iframe source not set");else n.warn("FATAL iframe not located in document")},_=function(){n.info("Initializing");for(var e=0;e<o.protocols.length;++e)i.inject(o.protocols[e]);if(c=!1,l=!1,p)R();else{if(m=T(),!f||!m)return void n.warn("messenger init failed...parentDomain or childDomain was undefined.");M(),n.info("Found domains | "+v+" domain: "+g+" | "+y+" domain: "+h),c=!0,N(),O({protocol:"handshake",command:"ready",domain:g,message:v+" ready"})}};return t.activate=function(){N()},t.init=function(e){if(c)n.warn("Messenger has already been initialized!");else{if(f=r.defined(e.parentDomain)?e.parentDomain:null,b=r.defined(e.appContext)?e.appContext:null,p=!t.isFramedIn(),r.defined(e.whiteListDomains)?I=e.whiteListDomains:(n.warn("Failing to set 'whiteListDomains' property can cause errors in the production multi-pod environment that don't show up in the test environments, which don't have multiple pods."),I=[]),p){if(!e.iframeId)return void n.warn("FATAL iframe id not specified");C=e.iframeId}s=e.overrideProtocolActions,e.isStandalone||!b?_():(b.on("messenger:sendMessage",(function(e){var t={};e.protocol&&(t.protocol=e.protocol),e.command&&(t.command=e.command),e.data&&(t.data=e.data),O(t)})),b.on("messenger:initMessenger",(function(){_()})),b.on("messenger:activateListeners",(function(){N()})),b.on("messenger:shutdownMessenger",(function(){D()})))}},t.isFramedIn=function(){return a!==a.top},t.sendMessage=function(e){O(e)},t.shutdown=function(){D()},t})),define("appkit-utilities/messenger/multiMessengerProtocols",[],(function(){"use strict";return{protocols:[{protocol:"handshake",commandList:[{command:"ready",action:function(){}}]},{protocol:"sessionTimeout",commandList:[{command:"userActivity",action:function(){}}]},{protocol:"childEvent",commandList:[{command:"cancel",action:function(e){this.shutdown({id:e.id})}},{command:"setTitle",action:function(){}},{command:"returnToAccounts",action:function(e){this.shutdown({id:e.id})}},{command:"navigate",action:function(e){this.shutdown({id:e.id})}},{command:"documentsnavigate",action:function(e){this.shutdown({id:e.id})}},{command:"logoff",action:function(e){this.shutdown({id:e.id})}},{command:"viewRendered",action:function(){}},{command:"error",action:function(){}},{command:"authSuccess",action:function(e){this.shutdown({id:e.id})}},{command:"updateState",action:function(){}},{command:"stickyData",action:function(){}},{command:"interaction",action:function(){}},{command:"logService",action:function(){}},{command:"quickDepositPDF",action:function(e){}},{command:"returntoDWMApplication",action:function(e){this.shutdown({id:e.id})}},{command:"returnToAccountsWithProfileRefresh",action:function(e){this.shutdown({id:e.id})}},{command:"showExternalSpeedBump",action:function(e){}},{command:"showLanguageSpeedBump",action:function(e){}},{command:"setFocusToIFrame",action:function(e){}}]},{protocol:"displayEvent",commandList:[{command:"resize",action:function(){}},{command:"scrollTo",action:function(){}},{command:"getParentOffset",action:function(){}},{command:"setParentScroll",action:function(e){}},{command:"focus",action:function(){}}]},{protocol:"parentEvent",commandList:[{command:"requestState",action:function(){}}]}]}})),define("appkit-utilities/messenger/multiMessenger",["require","blue/log","appkit-utilities/messenger/protocolManager","blue/root","appkit-utilities/messenger/multiMessengerProtocols"],(function(e){"use strict";var t={},n=e("blue/log"),i=n("[messenger]"),a=new(e("appkit-utilities/messenger/protocolManager")),r=e("blue/root"),o=e("appkit-utilities/messenger/multiMessengerProtocols"),s=[],c=[],l=function(e,t,n,i){i||(i=r),i.addEventListener(t,n,!1),e.domEvents=e.domEvents||[],e.domEvents.push({type:t,listener:n,node:i})},d=function(e,t,n){n.removeEventListener(e,t,!1)},u=function(e){return s.find((function(t){return t.id===e}))},p=function(){return r.name||"unnamed"},f=function(e){e.logger.info("Shutting down messenger");for(var t,n=e.domEvents,i=0,a=n&&n.length;i<a;i++)t=n[i],d(t.type,t.listener,t.node);e.domEvents=[],e.destinationReady=!1,e.ackSent=!1,e.initialized=!1,e.logger.info("Messenger has been shutdown")},m=function(e,t){t.isParent?t.contentWindow.postMessage(e,t.childDomain):top.postMessage(e,t.receivingDomain)},g=function(e){if(c.length){e.logger.info("Attempting to drain "+c.length+" messages in queue");try{for(var t=c.length-1;t>=0;t--){var n=c[t];n.id&&n.id!==e.id?e.logger.warn("Message id doesnt match recipient, ignoring"):(m(n,e),c.splice(t,1))}}catch(t){e.logger.warn("Got postMessage domain error while draining queue: "+t)}}},h=function(e){return(e.location.protocol+"//"+e.location.hostname+(e.location.port?":"+e.location.port:"")).toLowerCase()},v=function(){return r.document.location.origin||h(r.document)},y=function(e){e.isParent?(e.sendingDomain=e.parentDomain,e.sendingName="parent:"+e.parentName,e.receivingDomain=e.childDomain,e.receivingName="child:"+e.childName):(e.sendingDomain=e.childDomain,e.sendingName="child:"+e.childName,e.receivingDomain=e.parentDomain,e.receivingName="parent:"+e.parentName)},b=function(e){var i;e.isParent=!t.isFramedIn(),e.isParent?(i=e.id,e.parentName=i,e.childName=i,e.logger=n("[messenger:parent:"+e.parentName+"]")):(i=p(),e.childName=i,e.parentName=i,e.logger=n("[messenger:child:"+e.childName+"]"))},C=function(e,t){if("object"==typeof e&&e.command){if(t&&(b(t),e.domain||(e.domain=t.sendingDomain),e.id||(e.id=t.id)),t&&t.initialized&&t.destinationReady)g(t);else{if(!t||t&&!t.initialized)return i.info("Attempt to post a message <"+e.command+"> before initialization complete, storing"),void c.push(e);if("ready"!==e.command)return i.info("Attempt to post a message <"+e.command+"> before recipient has loaded, storing"),void c.push(e)}t.logger.info("Sending message: "+e.command);try{m(e,t)}catch(e){t.logger.warn("postMessage error: "+e)}}else i.info("Message in invalid format, aborting")},A=function(e,n){switch(n.logger.info("Got <"+e.command+"> command from domain "+e.domain),e.command){case"ready":n.isParent?(n.ackSent&&(n.ackSent=!1),n.destinationReady=!0,g(n),n.ackSent||(C({protocol:"handshake",command:"ack",ackCommand:"ready",message:n.sendingName+" ready"},n),n.ackSent=!0,n.overrideProtocolActions&&n.overrideProtocolActions[e.command]&&n.overrideProtocolActions[e.command](e))):(n.logger.info(n.sendingName+" is ready. We are ready to go"),n.destinationReady=!0,g(n),C({command:"ack",ackCommand:"ready",message:n.sendingName+" ready ACK"},n));break;case"ack":n.logger.info("Got ack, "+n.receivingName+" domain is "+e.domain+" and current "+n.receivingName+" domain is "+n.receivingDomain),g(n),n.destinationReady=!0;break;default:!function(e,n){var i=n.protocolManager.locate(e.protocol,e.command),a="messenger:"+e.command;i?(n.logger.info("Match found for <"+e.command+">, executing"),(n.overrideProtocolActions&&n.overrideProtocolActions[e.command]?n.overrideProtocolActions[e.command]:i.action.bind(t))(e),e.context?e.context.eventId=a:e.context={eventId:a},n.appContext&&n.appContext.broadcast(a+":"+e.id,e.context)):n.logger.info("Protocol unrecognized <"+e.command+">, aborting")}(e,n)}},I=function(e){e.initialized?e.logger.info("Listeners already activated for messenger, ignoring"):(e.initialized=!0,e.logger.info("Listeners attached for "+e.id),l(e,"message",(function(n){!function(e,n){var i=e.origin.toLowerCase(),a=e.data,r=e.source;if(n.logger.info("Listener entered. Origin is "+i),t.isFramedIn()||n===s.find((function(e){return e.contentWindow===r}))){if(n.receivingDomain===i)n.logger.info("Origin ok");else{if(!(n.whiteListDomains.indexOf(i)>-1))return void n.logger.info("Received message from unrecognized origin: "+i+", ignoring");n.isParent&&(n.logger.info("Reassiging childDomain and contentWindow for "+n.id+" from "+n.childDomain+" to "+i),n.childDomain=i,n.contentWindow=r),n.logger.info("Switching receivingDomain from "+n.receivingDomain+" to "+i),-1===n.whiteListDomains.indexOf(n.receivingDomain)&&n.whiteListDomains.push(n.receivingDomain),n.receivingDomain=i}if(a){if(!a.command)return void n.logger.info("Message unrecognized, ignoring");a.id||(a.id=n.id),A(a,n)}else n.logger.info("Missing event or event data, ignoring")}else n.logger.info("Message window does not match iframe window, ignoring")}(n,e)})),l(e,"unload",(function(){f(e)})))},S=function(e){if(b(e),e.initialized)e.logger.warn("Messenger has already been initialized!");else{e.logger.info("Initializing");for(var t=0;t<o.protocols.length;++t)a.inject(o.protocols[t]);if(e.protocolManager=a,e.initialized=!1,e.destinationReady=!1,e.isParent)!function(e){var t,n=r.document.getElementById(e.id);n?n.src?(e.el=n,e.contentWindow=n.contentWindow,e.src=n.src,e.ackSent=!1,e.destinationReady=!1,e.logger.info("Found the iframe with id of "+e.id),""===(t=e.src.split("/"))[0]?e.childDomain=h(e.contentWindow):e.childDomain=(t[0]+"//"+t[2]).toLowerCase(),e.parentDomain=v(),y(e),e.logger.info("Found domains | "+e.sendingName+" domain: "+e.sendingDomain+" | "+e.receivingName+" domain: "+e.receivingDomain),I(e),e.logger.info("Initialized ok"),C({command:"ready",message:e.sendingName+" ready"},e)):e.logger.warn("Iframe "+e.id+" source not set, aborting"):e.logger.warn("Iframe "+e.id+" not located in document, aborting")}(e);else{if(e.childDomain=v(),!e.parentDomain||!e.childDomain)return void e.logger.warn("Messenger init failed parentDomain or childDomain is undefined, aborting");y(e),e.logger.info("Found domains | "+e.sendingName+" domain: "+e.sendingDomain+" | "+e.receivingName+" domain: "+e.receivingDomain),I(e),C({protocol:"handshake",command:"ready",message:e.sendingName+" ready"},e)}}};return t.activate=function(e){var t;if(e&&e.id){var n=e.id;if(!(t=u(n)))return void i.info("Activate called with an id "+n+" that doesnt match any initialized messengers, ignoring")}else{var a=s.length;if(!a)return void i.info("Activate called when there are no messengers, ignoring");t=s[a-1],i.info("Activate called without specifying id. Assuming most recent messenger.")}I(t)},t.init=function(e){var t=e.iframeId||p(),n=u(t)||{id:t};if(n.logger=i,b(n),n&&n.initialized)n.logger.warn("Messenger has already been initialized!");else{if(n.isParent){if(!e.iframeId)return void n.logger.warn("IframeId not specified, aborting");n.id=e.iframeId}else{"unnamed"===p()&&n.logger.warn("Please add a name attribute to the iframe that equals the id attribute"),n.parentDomain=e.parentDomain||null}e.whiteListDomains?n.whiteListDomains=e.whiteListDomains:(n.logger.warn("Failing to set whiteListDomains property can cause errors in the production multi-pod environment that dont show up in the test environments, which dont have multiple pods"),n.whiteListDomains=[]),n.overrideProtocolActions=e.overrideProtocolActions,n.appContext=e.appContext||null,n.isStandalone=e.isStandalone||!n.appContext,u(n.id)||s.push(n),n.isStandalone?S(n):(n.appContext.on("messenger:sendMessage",(function(e){var t={};e.protocol&&(t.protocol=e.protocol),e.command&&(t.command=e.command),e.data&&(t.data=e.data),C(t,n)})),n.appContext.on("messenger:initMessenger",(function(){S(n)})),n.appContext.on("messenger:activateListeners",(function(){I(n)})),n.appContext.on("messenger:shutdownMessenger",(function(){f(n)})))}},t.isFramedIn=function(){return r!==r.top},t.sendMessage=function(e){var t;if(e.id)t=u(e.id);else{var n=s.length;n&&(t=s[n-1])}C(e,t)},t.shutdown=function(e){var t;if(e&&e.id){var n=e.id;if(!(t=u(n)))return void i.info("Shutdown called with an id "+n+" that doesnt match any initialized messengers, ignoring")}else{var a=s.length;if(!a)return void i.info("Shutdown called when there are no messengers, ignoring");t=s[a-1],i.info("Shutdown called without specifying id. Assuming most recent messenger.")}f(t)},t})),define("appkit-utilities/validation/variations",[],(function(){var e="INVALID_DATE",t="INVALID_FORMAT",n="MISSING_MANDATORY_DATA",i={Date:e,Length:t};return{Range:e,Ssn:t,Date:t,City:t,Email:t,Money:t,Numbers:t,Numeric:t,Pattern:t,ZipCode:t,PostalCode:t,Boolean:n,Length:"INVALID_LENGTH",Characters:t,AddressLine:t,Description:t,AlphaNumeric:t,ConstraintSet:t,NotBlank:n,PhoneNorthAmerica:t,PasswordCharacters:t,NotPhoneEmail:"EMAIL_ADDRESS_CANNOT_BE_PHONE_NUMBER",NotBeginWith1:"INVALID_FIRST_CHARACTER",SsnOao:"INVALID_SOCIAL_SECURITY_NUMBER",NonRepeatingCharacters:"INVALID_FORMAT_IDENTICAL_CHARACTERS",NonRepeatingAlphaNumerics:"INVALID_FORMAT_IDENTICAL_CHARACTERS",NonConsecutiveAlphaNumerics:"INVALID_FORMAT_CONSECUTIVE_CHARACTERS",phoneNumber:{NonConsecutiveAlphaNumerics:"INVALID_PHONE_NUMBER"},dateOfBirth:i,expirationDate:i,socialSecurityNumber:{NonConsecutiveAlphaNumerics:"INVALID_SOCIAL_SECURITY_NUMBER"},PersonalName:t,DateRange:e,confirmedCardId:{Numeric:"MISMATCHED_CONFIRMATION_DATA"}}})),define("appkit-utilities/validation/validationEngineAdapter",["require","blue/is","blue/util"],(function(e){var t,n=e("blue/is"),i=e("blue/util"),a=function(e){return function(n,i){var a={errorType:"",isValid:e.validator(i),compareTo:e.alsoValidate||[]};return e.message&&e.message.variation?a.errorType=a.isValid?"":e.message.variation:t.warn("No variation was provided for custom validator containing these fields: "+e.fields),a}},r=function(e,i,r){for(var o=0;o<e.length;o++){var s=e[o];if(n.function(s.validator))for(var c="required"===r?s.validator:a(s),l=0;s.fields&&l<s.fields.length;l++){var d=s.fields[l];i[d]||(i[d]=[]),i[d].push({validator:c,type:r})}else t.warn("No function was provided for the custom validator, it is required.")}return i};return{processValidators:function(e,a){t=a;var o={};return e?(e.requiredValidations&&(o=r(e.requiredValidations,o,"required")),e.customValidations&&(o=r(e.customValidations,o,"custom")),e.pageValidators&&(o=function(e,i){for(var a=0;a<e.length;a++){var r=e[a];n.function(r.validator)?(i.formValidators||(i.formValidators=[]),i.formValidators.push(r.validator)):t.warn("No function was provided for the custom validator, it is required.")}return i}(e.pageValidators,o)),i.object.equals(o,{})&&(Object.keys(e).forEach((function(t){n.function(e[t])&&(e[t]=[e[t]])})),o=e),e.requiredFields&&(o.requiredFields=e.requiredFields),o):{}}}})),define("appkit-utilities/validation/componentValidate",["require","appkit-utilities/validation/variations","appkit-utilities/content/dcu","appkit-utilities/validation/validationEngineAdapter"],(function(e){"use strict";var t,n,i,a,r,o,s,c,l,d,u,p,f=e("appkit-utilities/validation/variations"),m=e("appkit-utilities/content/dcu"),g=e("appkit-utilities/validation/validationEngineAdapter"),h=function(e){return e.list||e.item},v=function(e){return e.v||{}},y=function(e){var t,n,i=e.domEvent&&e.domEvent.currentTarget,a=e.context;return i&&(n=i.tagName||i.nodeName)&&-1!==n.toLowerCase().indexOf("mds")&&(t=i.name||i.id),!t&&a&&(t=a.name||a.groupName||a.checkedBinding||a.id),t},b=function(e,t,n,i){return p.get(e,t+"Error",n,i)||"["+t+"Error."+n+"]"},C=function(e,t,n,i,a,r){return a.loadErrorsOnDemand?void(a.errorMessageStore[r]={errorType:n,props:i}):b(e,t,n,i)},A=function(e){var t={},n=e.split("."),i=["list","idx","item"];return t.item=n[0],n.length>1&&(t.path=e,n.forEach((function(e,n){t[i[n]]=e}))),t},I=function(e,t){var n,r,o,s;return a(e)&&!i(e)?e:(i(e)?(t=t||{},e.forEach((function(e){if(n=A(e),s=Number(n.idx),n.list&&n.idx&&n.item){o=t[n.list]||[],r=o.length;for(var i=s;i>r;i--)o.push({});void 0===o[s]&&o.push({}),a(o[s])||!0===o[s]||1===o[s]||(o[s]={}),!0!==o[s]&&1!==o[s]&&(o[s][n.item]=!0),t[n.list]=o}else t[n.item]=!0}))):console.warn("Invalid Whitelist. White list must be set as an object (preferred) or array."),t)},S=function(e,t,n,i,r,o){var s,c=v(e),l=e.model.get();return l.whiteList=I(l.whiteList||{}),s=function(e){var t=[];return a(e)?t=Object.keys(e):console.warn("Invalid Whitelist. White list must be set as an object (preferred) or array."),t.length>0?t:void 0}(l.whiteList),{model:l,validators:t,formValidators:n,validations:c,validatedComponent:e.validate(r||s),props:e.context.props,specData:e.spec.data,variations:e.context.variations||f,requiredErrorType:e.context.requiredErrorType||"MISSING_MANDATORY_DATA",loadErrorsOnDemand:l.loadErrorsOnDemand||o,errorMessageStore:i}},E=function(e,t){var n=[];return i(t)?n=function(e,t){var n=[],i=[];return t.forEach((function(t,a){Object.keys(t).forEach((function(t){(n=[]).push(e),n.push(a),n.push(t),i.push(A(n.join(".")))}))})),i}(e,t):n.push(A(e)),n},w=function(e,t,n){var i={};return n&&n[e]&&(i=n[e][t]),i},D=function(e,t){var n=!0,i=e[t.property];return i&&(n=i.errorType!==t.errorType),n},k=function(e,t){return e.dtm=Date.now(),e.isFormValid=t.isValid,e[t.property]=t,e},x=function(e,t){var n=t.validation,i=t.property+t.idx+n,o=!r(e[i]&&e[i].isValid)||e[i].isValid;return!o&&t.item&&a(t.item)&&(o=!!t.item[n]),o},T=function(e,t){for(var n,i=!0,a=t.property,r=e.validators,s=Object.keys(r[a]),c=s.length,l=0;l<c;l++)if(n=s[l],o(r[a][n])&&(t.validation=n,!(i=x(e.validations,t))))return i;return i},M=function(e,t,n,i){var r,o,s,c=!1,l=t.length;for(r=0;r<l&&(s=t[r].index,o=t[r].property,(c=!!n[s])&&a(n[s])&&(c=-1!==i.indexOf(e+s+o)||!!n[s][o]),c);r++);return c},O=function(e,t){var n;if(!s(t)||0===Object.keys(t).length)return!0;if(!(e.list&&e.idx&&e.item))return t[e.item];if(n=t[e.list]){if(!i(n))return!0;if(1===n.length)return n[0][e.item];if(n.length>1&&e.idx<n.length)return n[e.idx][e.item]||!0===n[e.idx]||1===n[e.idx]}return!1},P=function(e,t){var n,o=e.list||e.item,l=t&&t[o];if(!s(t)||0===Object.keys(t).length)return!1;if(i(l)&&l.length>0){if(n=1===l.length?l[0]:l[e.idx],a(n))return!!n[e.item];if(c(n)||r(n))return!!n}else if(l)return!0;return!1},L=function(e,t,n){var o=e.model,s=e.validators,c=e.validations;return i(s[t])?(n=!!(!c[t]||r(c[t].isValid)&&c[t].isValid))||(n=!(!o.byPass||!o.byPass[t])):a(s[t])&&(n=function(e,t){var n,i={},r=!0,o=e.model,s=o.byPass&&o.byPass[t],c=o[t].length;for(n=0;n<c&&((r=!(!s||!s[n]||a(s[n])))||(i.idx=n,i.property=t,i.item=s&&s[n],r=T(e,i)));n++);return r}(e,t)),n},N=function(e){var t=e.validations,n=e.validatedComponent.failed,r={};return Object.keys(t).forEach((function(e){var n=t[e],i=n.fullPath||e;a(n)&&!n.isValid&&Object.keys(n).indexOf("isValid")>=0&&(r[e]=i)})),Object.keys(n).forEach((function(e){var t=n[e];i(t)?t.forEach((function(e){e.result&&!e.result.isValid&&(r[e.dataPath.replace(/\./g,"")]=e.dataPath)})):a(t)&&!t.isValid&&(r[e]=e)})),r},R=function(e){var t=function(e){var t=[];return Object.keys(e).forEach((function(n){r(e[n].isRequired)&&!e[n].isRequired&&t.push(n)})),t}(e.validations),n=e.validatedComponent,a=N(e),o=n.isValid&&0===Object.keys(a).length||function(e,t,n,a,r){var o,s,c,d,u,p,f=!1,m=l.deepClone(e);if(a){u=(s=Object.keys(m)).length;for(var g=0;g<u;g++)p=m[c=s[g]],d=A(p),-1===r.indexOf(c)&&O(d,a)||delete m[c];0===Object.keys(m).length&&(f=!0)}if(n&&!f){u=(s=Object.keys(t)).length;for(var h=0;h<u&&(o=s[h],(f=-1!==r.indexOf(o)||!!n[o])&&i(t[o])&&i(n[o])&&(f=M(o,t[o],n[o],r)),f);h++);}return f}(a,n.failed,e.model.byPass,e.model.whiteList,t);if(o)for(var s=Object.keys(e.validators),c=s.length,d=0;d<c&&(o=L(e,s[d],o));d++);return!!o&&G(e.formValidators,e.model)},_=function(e,t,n,i){for(var r,s=e.length,c=t.compareTo||[],l=0;l<s;l++){if(r=e[l],a(r)){if("required"===r.type)continue;if(!o(r.validator))continue;t=r.validator(i,n)}else t=r(i,n);if(!t.isValid)return t;for(var d=0;t.compareTo&&d<t.compareTo.length;d++)c.indexOf(t.compareTo[d])<0&&c.push(t.compareTo[d])}return t.compareTo=c,t},F=function(e,t,n,i){for(var s,c=e.length,l=0;l<c&&a(e);l++)if("required"===(s=e[l]).type&&o(s.validator)&&(t=s.validator(i,n),r(t)&&(t={isRequired:t}),t.isValid=!0,t.isRequired))return t;return t},U=function(e,t,n){var s=(t.path||t.item).indexOf(".")>=0?t.path:null,c=(t.path||t.item).replace(/\./g,""),d={isValid:!0,errorType:void 0,property:c,fullPath:s},p=l.deepClone(d),f=function(e,t,n){var a=h(t),r=e.failed[a],o=e.passed[a];return!n||r||o||(r=(e=n.validate(a)).failed[a]),i(r)&&(r=r.filter((function(e){return e.dataPath===t.path}))[0]),r}(e.validatedComponent,t,n),m=function(e,t){var n,a=e[h(t)];return i(a)&&t.list&&t.idx&&t.item&&(n=parseInt(t.idx),a=e[t.list][n]?e[t.list][n][t.item]:""),a}(e.model,t);return m||r(m)||!t.isRequired||(p={isValid:!1,errorType:e.requiredErrorType,props:w(t.item,e.requiredErrorType,e.props)}),!p.isValid||(p=function(e,t,n){var r,o=h(n),s=t.validators;return i(s[o])?e=F(s[o],e,t.model,n):a(s[n.list])&&(r=s[n.list][n.item],i(r)&&(e=F(r,e,t.model,n))),e}(p,e,t),!r(p.isRequired)||p.isRequired||m||r(m))?(f&&p.isValid&&(p.isValid=!1,p.errorType=function(e,t,n){var i,a,r="",o=e.failedConstraints||e.result&&e.result.failedConstraints,s=o.length;for(i=0;i<s;i++){r=o[i].type;break}return(a=n[t]&&n[t][r])?a:(n[r]||u.warn('The constraint "'+r+'" does not have a definition in the variations object.The error message will be undefined until an entry is made for it onto "this.context.variations" Please consult AppKitvalidation documentation for more details.'),n[r])}(f,t.item,e.variations),p.props=w(t.item,p.errorType,e.props)),p.isValid&&((p=function(e,t,n){var r,s=h(n),c=t.validators;return i(c[s])?e=_(c[s],e,t.model,n):a(c[n.list])&&(r=c[n.list][n.item],o(r)?e=r(n,t.model):i(r)&&(e=_(r,e,t.model,n))),e}(p,e,t)).props||(p.props=w(t.item,p.errorType,e.props))),p.property||(p.property=c),p.isValid&&(p.errorMessage=""),p.fullPath=s,p):(d.isRequired=!1,d)},q=function(e,t){return e.indexOf(t)>=0},V=function(e,t,n,i){var a,r,o={},s=n.validations;return t.forEach((function(t){a=A(t),r=a.path||a.item,s[r.replace(/\./g,"")]&&O(a,n.model.whiteList)&&(a.isRequired=q(i,h(a)),o=U(n,a,e),D(s,o)&&(o.isValid||(o.errorMessage=C(e,a.item,o.errorType,o.props,n)),s=k(s,o)))})),s},j=function(e){var t=e.validatedComponent,n=l.merge(t.updated,t.failed),i=[];return Object.keys(n).forEach((function(t){"List"===e.specData[t].type?e.specData[t].items&&Object.keys(e.specData[t].items).forEach((function(n){for(var a=0;e.model[t]&&a<e.model[t].length;a++)i.push([t,a,n].join("."))})):i.push(t)})),i},B=function(e,t,n){var i,a=[];return e.forEach((function(e){(i=t[e])&&"List"===i.type?i.items?Object.keys(i.items).forEach((function(t){for(var i=0;n[e]&&i<n[e].length;i++)a.push([e,i,t].join("."))})):u.warn('componentValidate.addToWhiteList can only add a root level array if the comp spec has "items" defined.'):a.push(e)})),a},H=function(e,t,n){n[e]&&"List"===n[e].type?t&&Object.keys(t).forEach((function(n){0===n.indexOf(e)&&t[n]&&delete t[n]})):t&&t[e]&&delete t[e]},G=function(e,t){for(var n=!0,i=0;e&&i<e.length&&(n=e[i](t));i++);return n},Y=function(e,t){var n=t||{};n.getErrorCount=e.getErrorCount,e.v=n};return function(e,f){var w,x,T,M=this,L={},_=!1,F=null;p=e.dcu&&e.dcu.dynamicContent||m.dynamicContent,t=e.is.empty,n=e.is.string,i=e.is.array,a=e.is.object,r=e.is.boolean,o=e.is.function,c=e.is.number,s=e.is.defined,l=e.util.object,d=e.util.array,u=e.logger,w=l.deepClone(f),w=g.processValidators(w,u),x=w.formValidators||[],T=w.requiredFields||[],delete w.formValidators,delete w.requiredFields,M.addToWhiteList=function(e){var t=M.model.get(),r=t.whiteList,o=M.spec.data;n(e)&&(e=[e]),i(e)?(e=B(e,o,t),r&&i(r)?(r=r.slice(),M.model.set("whiteList",d.combine(r,e))):(r=a(r)?r:{},0===Object.keys(r).length&&M.v&&Object.keys(M.v).forEach((function(t){var n={};M.v[t].fullPath&&(n=A(M.v[t].fullPath)),(o[t]||o[n.list])&&-1===e.indexOf(n.path)&&-1===e.indexOf(t)&&-1===e.indexOf(n.list)&&delete M.v[t]})),M.model.set("whiteList",I(e,r))),M.validateDataItems(e,!0)):u.warn("componentValidate.addToWhiteList should takes a string or array as params")},M.removeFromWhiteList=function(e){var t,r,o,s,c,d=M.model.get("whiteList"),p=M.spec.data,f=[],m=!1;if(d){if(e){if(!i(e)){if(!n(e))return void u.warn("componentValidate removeFromWhiteList only takes an array or a string as params.");c=[e]}c=c||l.deepClone(e)}i(d)&&((c=c||d.slice()).forEach((function(e){s=d.indexOf(e),-1===e.indexOf(".")?(s>-1?d.splice(s,1):p[e]&&p[e].type&&"list"===p[e].type.toLowerCase()&&d.slice().forEach((function(t){t.split(".")[0]===e&&d.splice(d.indexOf(t),1)})),H(e,M.v,p)):s>-1?(d.splice(s,1),M.v&&M.v[e.replace(/\./g,"")]&&delete M.v[e.replace(/\./g,"")]):(o=e.split(".")[0],d.slice().forEach((function(t){o===t.split(".")[0]&&(f.push(e),m=!0)})))})),m&&(d=I(B(d,p,M.model.get())),c=f,m=!1)),!i(d)&&a(d)&&(c=c||Object.keys(d)).forEach((function(e){e.indexOf(".")>-1?(t=A(e),(r=d[t.list])[t.idx]&&r[t.idx][t.item]&&delete r[t.idx][t.item],M.v&&M.v[e.replace(/\./g,"")]&&delete M.v[e.replace(/\./g,"")]):(d[e]&&delete d[e],H(e,M.v,p))})),M.model.set("whiteList",d),M.verifyForm()}else u.warn("No items found for removal since whiteList does not exist.")},M.validateDataItems=function(e,t){var n={};e.forEach((function(e){n={context:{name:e}},M.validateDataItem(n,t)}))},M.validateDataItem=function(e,n){var i,a,r,s,c,l,d,u=y(e),p=A(u),f=h(p),m=u.replace(/\./g,"");_||(_=!0,s=S(M,w,x,L),r=j(s),F=r.slice(),(d=r.indexOf(u))>=0&&r.splice(d,1),M.validateDataItems(r,!0)),i=(s=S(M,w,x,L,f,n)).validatedComponent,a=s.validations,p.isRequired=function(e,t,n){var i=!1;return-1===t.indexOf(n)?(i=e.domEvent&&e.domEvent.currentTarget&&e.domEvent.currentTarget.hasAttribute&&o(e.domEvent.currentTarget.hasAttribute)?e.domEvent.currentTarget.hasAttribute("required"):e.context&&e.context.required)&&t.push(n):i=!0,!!i}(e,T,f),O(p,s.model.whiteList)&&(P(p,s.model.byPass)||((l=U(s,p)).isValid&&delete L[m],i.updated[f]||D(a,l)?(l.isValid||(delete L[m],l.errorMessage=C(M,p.item,l.errorType,l.props,s,m)),a=k(a,l),c=l.compareTo||[],t(c)||(a=V(M,c,s,T)),a.isFormValid&&(a.isFormValid=R(s)),Y(M,a)):M.getErrorMessage({context:{name:u}})))},M.validateFormData=function(){var e,n,i,a={},r=S(M,w,x,L),o=j(r),s=r.validations;_||(_=!0,F=o.slice()),F&&(o=d.combine(o,F)),o.length>0&&o.forEach((function(n){E(n,M[n]).forEach((function(n){var i=h(n),o=(n.path||n.item).replace(/\./g,"");O(n,r.model.whiteList)&&(P(n,r.model.byPass)||(n.isRequired=q(T,i),a=U(r,n),delete L[o],a.isValid||(a.errorMessage=C(M,n.item,a.errorType,a.props,r,o)),s=k(s,a),e=a.compareTo||[],t(e)||(s=V(M,e,r,T))))}))})),s.isFormValid=R(r),Y(M,s),s.isFormValid||(n=N({validations:s,validatedComponent:{failed:{}}}),Object.keys(n).forEach((function(e){i=n[e],L[e]&&M.getErrorMessage({context:{name:i}})})))},M.verifyForm=function(){for(var e,t,n,i=!0,r=M.model.get(),o=v(M),s=Object.keys(o),c=s.length,l=0;l<c;l++)if(t=s[l],e=A(t),O(e,I(r.whiteList||{}))&&!P(e,r.byPass)&&(n=o[t],a(n)&&-1!==Object.keys(n).indexOf("isValid")&&!n.isValid)){i=!1;break}o.isFormValid=!!i&&G(x,M.model.get()),Y(M,o)},M.getErrorMessage=function(e){var t,n=y(e),i=A(n),a=h(i),r=n.replace(/\./g,""),o=M.v;if(!a)return u.warn("event context or domEvent currentTarget did not include a name, getErrorMessage failed."),"";t=L[r],o&&!o[r]&&(o[r]={}),t&&(o[r].errorMessage=b(M,i.item,t.errorType,t.props),delete L[r],Y(M,o))},M.getErrorCount=function(){var e,t=0;return Object.keys(M.v).forEach((function(n){(e=M.v[n])&&e.errorMessage&&t++})),t}}})),define("appkit-utilities/validation/controllerValidate",[],(function(){return function(e){var t=this,n=e.is.array,i=e.is.function;t.validateComponents=function(e){var a=(e=e||{}).exclusions,r=e.hideErrors,o=e.exitOnInvalid,s=!0,c=Object.keys(t.components);n(a)&&a.length&&(c=c.filter((function(e){return a.indexOf(e)<0})));for(var l=c.filter((function(e){return t.registry.hasComponent(e)})),d=0;d<l.length;d++){var u=t.components[l[d]];if(i(u.validateFormData)&&(r?u.verifyForm():u.validateFormData(),s=s&&u.v.isFormValid,o&&!s))break}return s}}})),define("appkit-utilities/validation/customValidators/addressValidators",[],(function(){var e=/^[0-9]+$/;function t(e){return e&&e.toString&&e.toString()}return{zipCodeFormatValidator:function(n){return!(!(n=t(n))||!n.match(e))},zipCodeLengthValidator:function(e,n){return!!(e=t(e))&&(n?4===e.length:5===e.length)}}})),define("appkit-utilities/formatters/formattersUtil",[],(function(){return{dateFormats:{L:function(){return"L"},l:function(){return"l"},LL:function(){return"LL"},ll:function(){return"ll"},LLL:function(){return"LLL"},lll:function(){return"lll"},LLLL:function(){return"LLLL"},llll:function(){return"llll"},"MM/YYYY":function(){return"MM/YYYY"},"MMM DD":function(){return"MMM DD"},"MM/DD/YYYY":function(){return"MM/DD/YYYY"},"MM-DD-YYYY":function(){return"MM-DD-YYYY"},"YYYY-MM-DD":function(){return"YYYY-MM-DD"},"MMM DD YYYY":function(){return"MMM DD YYYY"},"MMM Do YYYY":function(){return"MMM Do YYYY"},"MMM DD, YYYY":function(){return"MMM DD, YYYY"},"MMM D, YYYY":function(){return"MMM D, YYYY"},"MMMM D, YYYY":function(){return"MMMM D, YYYY"},YYYYMMDD:function(){return"YYYYMMDD"},MMDDYYYY:function(){return"MMDDYYYY"},default:function(){return"L"},LT:function(){return"LT"},LTS:function(){return"LTS"}}}})),define("appkit-utilities/formatters/dateTime",["require","moment","blue/is","blue/log","blue/util","appkit-utilities/content/dcu","appkit-utilities/formatters/formattersUtil","moment/locale/es"],(function(e){var t=e("moment"),n=e("blue/is"),i=e("blue/log")("[dateTime]"),a=e("blue/util").object.extend,r=e("appkit-utilities/content/dcu"),o=e("appkit-utilities/formatters/formattersUtil").dateFormats,s=null;function c(e,t){return s||(s={hyphen:r.dynamicContent.getGlobal("hyphenSymbol"),doubleHyphen:r.dynamicContent.getGlobal("doubleHyphenSymbol"),defaultNull:r.dynamicContent.getGlobal("notAvailableLabel")}),i.warn("data '"+e+"' is invalid, please provide a valid one"),s[t]||s.defaultNull}function l(e){return n.function(o[e])?o[e]():(i.warn("Date format '"+e+"' not supported, return default MM/DD/YYYY"),o.default())}function d(e,n){var i={monthsShort:"Ene_Feb_Mar_Abr_May_Jun_Jul_Ago_Sep_Oct_Nov_Dic".split("_")},r=a({},{inputFormat:"",outputFormat:"MM/DD/YYYY",exceptionValue:"defaultNull"},n);return e&&t(e,r.inputFormat).isValid()?("en"!==this.lang&&"es"!==this.lang||t.updateLocale(this.lang,"es"===this.lang&&i),t(e,r.inputFormat).format(l(r.outputFormat))):c(e,r.exceptionValue)}function u(e){var n=t(e),i=n.isDST()?-4:-5;return n.utc().utcOffset(i)}function p(e,t){return(e.military?"H:mm":"h:mm A")+(" ["+t+"]")+(n.string(e.dateFormat)&&0===e.dateFormat.length?"":" "+l(e.dateFormat))}function f(e,n,i,a){return t(e,n).isValid()?t(e,n).format(i):c(e,a)}return e("moment/locale/es"),t.locale("en"),{dateFormatter:function(e,t){return 1!==arguments.length||"en"!==e&&"es"!==e?d(e,t):d.bind({lang:e})},showDateTime:function(e,n){n=n||{};var i,a=t(e);return a.isValid()?(i=p(n,a.isDST()?"EDT":"EST"),u(e).format(i)):c(e,n.exceptionValue)},showDateTimeET:function(e,n){var i;return n=n||{},t(e).isValid()?(i=p(n,r.dynamicContent.getGlobal("timeZoneAbbreviation","EASTERN_TIME")),u(e).format(i)):c(e,n.exceptionValue)},timeFormatter:function(e,t){if(e&&n.string(e)){t=t||"defaultNull";var a="H:mm",r="h:mm a";return function(e){return-1===e.toLowerCase().indexOf("am")&&-1===e.toLowerCase().indexOf("pm")}(e)?f(e,a,r,t):f(e,r,a,t)}i.warn("Please provide the correct timeStr")},isValidDate:function(e,n,i){return t(e,n,i).isValid()},currentDayAndTime:function(e){return e?t().format(l(e)):t()}}})),define("appkit-utilities/validation/customValidators/dateValidators",["require","moment","appkit-utilities/formatters/dateTime","blue/log"],(function(e){var t=e("moment"),n=e("appkit-utilities/formatters/dateTime"),i=e("blue/log")("[dateValidators]");return{checkDateRange:function(e,n,i,a){var r=t(e,a=a||"MM/DD/YYYY"),o=t(n,a),s=t(i,a);if(r.isValid()&&o.isValid()&&s.isValid())return s.isAfter(o)?1:s.isBefore(r)?-1:0},checkDateExpired:function(e,n){var a=t(e,n);if(a.isValid())return a.diff(Date(),"days")<0;i.warn("date is not valid")},isValidDate:n.isValidDate}})),define("appkit-utilities/validation/customValidators/numberValidators",["require","blue/is"],(function(e){var t=e("blue/is");return{phoneNumberValidator:function(e,t){return t=t||/^[2-9][0-8][0-9][2-9][0-9][0-9][0-9]{4}$/,!(!(e=(e=e&&e.toString&&e.toString())&&e.replace(/\D/g,""))||!e.match(t))},checkNumberRange:function(e,n,i,a){var r,o,s,c=a&&a.parseFn||parseFloat,l=a&&a.rangeOption||"[]";if(t.function(c)&&function(e,n){var i=t[e];if(i){for(var a=0;a<n.length;a++)if(("number"!==e||n[a]!==1/0)&&n[a]!==-1/0&&!i(n[a]))return!1;return!0}}("number",[r=c(e),o=c(n),s=c(i)]))return function(e,t,n,i){switch(e){case"[]":return t<=i&&i<=n?0:i>n?1:-1;case"(]":return t<i&&i<=n?0:i<=t?-1:1;case"[)":return t<=i&&i<n?0:i>=n?1:-1;case"()":return t<i&&i<n?0:i>=n?1:-1}}(l,r,o,s)}}})),define("appkit-utilities/validation/customValidators/util",["require","appkit-utilities/validation/customValidators/addressValidators","appkit-utilities/validation/customValidators/dateValidators","appkit-utilities/validation/customValidators/numberValidators"],(function(e){return{addressValidators:e("appkit-utilities/validation/customValidators/addressValidators"),dateValidators:e("appkit-utilities/validation/customValidators/dateValidators"),numberValidators:e("appkit-utilities/validation/customValidators/numberValidators")}})),define("appkit-utilities/validation/trigger",{validateField:{action:"validateDataItem"},validateForm:{action:"validateFormData"},getErrorMessage:{action:"getErrorMessage"},getErrorCount:{action:"getErrorCount"},verifyForm:{action:"verifyForm"}}),define("appkit-utilities/validation/util",[],(function(){var e=function(e){var t={};return t.isValid=!!e,t.errorType=t.isValid?"":"MISSING_MANDATORY_DATA",t},t=function(e,t,n,i){var a={},r=!t||e>=t,o=!n||e<=n;return a.isValid=o&&r,a.errorType=a.isValid?"":i,a},n=function(e,t){var n={};return n.isValid=t.test(e)&&e.trim().length>0,n.errorType=n.isValid?"":"INVALID_FORMAT",n},i=function(e,t){var n=t[e.list||e.item];return e.list&&(n=n[e.idx]&&n[e.idx][e.item]),n},a=function(e,t,i){return e.isValid&&(e=n(t,i)),e};return{getProperty:i,isValidDate:function(n,i,a,r){var o=e(n),s=n.split("/"),c=parseInt(s[1],10),l=parseInt(s[0],10),d=parseInt(s[2],10),u=new Date(d,l-1,c);return o=o.isValid?t(u,i,a,r):o},isValidFormat:n,checkValidChar:function(e,t){var n={};return n.isValid=t.test(e),n.errorType=n.isValid?"":"INVALID_CHARACTERS",n},checkWithinRange:t,checkInvalidData:function(e,t,n){var i={};return i.isValid=!e.match(t),i.errorType=i.isValid?"":n,i},checkMissingMandatory:e,validateProperty:function(t,n,r){var o=i(t,n),s=e(o);return s=a(s,o,r)},validateOptionalProperty:function(e,t,n){var r={isValid:!0,errorType:""},o=i(e,t);return o&&(r=a(r,o,n)),r},validateSelection:function(t,n){var a=i(t,n);return e(a)}}})),define("appkit-utilities/experimentation/style/mutationObserverChannel",["require","blue/event/channel"],(function(e){var t,n=new(e("blue/event/channel"));return{getInstance:function(e){return t||(t=function(e){return new MutationObserver((function(t){t.forEach((function(t){e.forEach((function(e){null!=t.target.querySelector(e)&&n.emit("domMutationEvent",{targetElement:t.target})}))}))})).observe(document,{childList:!0,subtree:!0}),n}(e)),t}}})),define("appkit-utilities/experimentation/style/areaEventChannel",["require","blue/event/channel"],(function(e){var t,n=e("blue/event/channel");return{getInstance:function(e){return t||(t=function(e){var t=new n;return e.on("processRoute",(function(e){var n=e&&e.area;t.emit("areaEvent",{area:n})})),t}(e)),t}}})),define("appkit-utilities/experimentation/style/styleOverrideUtility",[],(function(){var e,t=function(e,t){var n=t&&t.component&&t.parameter&&[t.component,t.parameter].join(".");if(e&&e.attributes["data-attr"]&&e.attributes["data-attr"].value===n&&t.properties)for(var i in t.properties)t.properties.hasOwnProperty(i)&&(e.style[i]=t.properties[i])},n=function(e,n,i){i.forEach((function(i){var a=n&&n[i];a&&a.style&&0!==a.style.length&&a.style.forEach((function(n){t(e.querySelector(n.selector),n)}))}))};return{applyStyleOnEvent:function(t,i,a){a=a||[],"areaEvent"===t.type?e=t.area:"domMutationEvent"===t.type&&"function"==typeof t.targetElement.querySelector&&(a.push(e),n(t.targetElement,i,a),a.pop())},handleAreaStyles:n,overrideStyleProperties:t}})),define("appkit-utilities/experimentation/style/styleOverride",["require","appkit-utilities/experimentation/style/mutationObserverChannel","appkit-utilities/experimentation/style/areaEventChannel","appkit-utilities/experimentation/config/experimentationConfig","appkit-utilities/experimentation/style/styleOverrideUtility","blue/is","blue/observable"],(function(e){var t=e("appkit-utilities/experimentation/style/mutationObserverChannel"),n=e("appkit-utilities/experimentation/style/areaEventChannel"),i=e("appkit-utilities/experimentation/config/experimentationConfig"),a=e("appkit-utilities/experimentation/style/styleOverrideUtility"),r=e("blue/is"),o=e("blue/observable");return function(e,s,c){if(r.defined(e)){var l=t.getInstance(i.targetElements).asEventStream(),d=n.getInstance(s).asEventStream();o.merge([l,d]).onValue((function(t){a.applyStyleOnEvent(t,e,c)}))}}})),define("appkit-utilities/experimentation/bootExperimentation",["require","exports","module","appkit-utilities/experimentation/style/mutationObserverChannel","appkit-utilities/experimentation/style/areaEventChannel","appkit-utilities/experimentation/content/contentOverride","appkit-utilities/experimentation/style/styleOverride","appkit-utilities/experimentation/style/styleOverrideUtility","appkit-utilities/experimentation/config/experimentationConfig","blue-app/cache/sessionCache","blue-app/cache/oneTimeCache","blue/observable","blue/is"],(function(e,t,n){var i,a,r,o,s=e("appkit-utilities/experimentation/style/mutationObserverChannel"),c=e("appkit-utilities/experimentation/style/areaEventChannel"),l=e("appkit-utilities/experimentation/content/contentOverride"),d=e("appkit-utilities/experimentation/style/styleOverride"),u=e("appkit-utilities/experimentation/style/styleOverrideUtility"),p=e("appkit-utilities/experimentation/config/experimentationConfig"),f=e("blue-app/cache/sessionCache"),m=e("blue-app/cache/oneTimeCache"),g=e("blue/observable"),h=e("blue/is"),v=[],y=n.config().enableExperiments,b="service-"+window.domainUrl+"/svc/rl/accounts/secure/v1/user/metadata/list";return{init:function(e){var t,n;y&&(a=e,l.init(),t=s.getInstance(p.targetElements).asEventStream(),n=c.getInstance(a.context).asEventStream(),h.undefined(r)&&(r=g.merge([t,n]).onValue((function(e){v.push(e)}))),o=p.CommonAreas||[])},getExperimentData:function(e,t){return new Promise((function(n,r){a=h.defined(t)?t:a,h.defined(e)?h.defined(i)&&!h.empty(i)?n(i):a.services.experimentationService["experimentation.svc"](JSON.stringify({customerId:e})).then((function(e){e&&e.success?(i=e.result,n(i)):r()}),(function(e){r({statusText:"Service failure with status = "+e.status})})):r({statusText:"Undefined profile Id"})}))},experimentationMixin:function(e){var t;y&&(f.has(b)&&(t=f.get(b).response.experimentEnabled),h.undefined(t)&&m.has(b)&&(t=m.get(b).response.experimentEnabled),!0===t)&&this.getExperimentData(e).then(function(e){l.setExperiment(e),l.overrideExperimentContent(),function(){h.function(r)&&r(),d(i,a,o);for(var e=v.length;e--;)u.applyStyleOnEvent(v.shift(),i,o)}(),requirejs(["analytics/scroll/experimentWatcher","analytics/util/experimentActionHelper"],(function(e,t){e(i),t.setExperimentData(i)}))}.bind(this),(function(e){h.function(r)&&r(),l.unplugComponentRegister(),e&&a.context.logger.error("Experimentation not loading due to ->",e.statusText)}))}}})),define("appkit-utilities/experimentation/service/experimentationService",["require","exports","module"],(function(e,t,n){return function(){var e=n.config()||{};this.serviceCalls={"experimentation.svc":{settings:{type:"POST",url:window.domainUrl+"/events/svc/config/v1/decision/list",contentType:"application/json",timeout:e.serviceTimeout||3e4,disableDefaultError:!0,xhrFields:{withCredentials:!1},disableCsrf:!1}}}}})),define("appkit-utilities/formatters/number",["require","appkit-utilities/common/constants","blue/is","mout/number/currencyFormat","blue/log","blue/util","appkit-utilities/content/dcu"],(function(e){var t=e("appkit-utilities/common/constants").VALUE,n=e("blue/is"),i=e("mout/number/currencyFormat"),a=e("blue/log")("[formatNumberUtil]"),r=e("blue/util").object.extend,o=e("appkit-utilities/content/dcu"),s=null;function c(e){return s||(s={hyphen:o.dynamicContent.getGlobal("hyphenSymbol"),doubleHyphen:o.dynamicContent.getGlobal("doubleHyphenSymbol"),defaultNull:o.dynamicContent.getGlobal("notAvailableLabel")}),s[e]}return{percentageFormatter:function(e,t,i){var s,l,d={};return n.object(t)?d=t:(d.exceptionValue=i,d.requiresParentheses=t),s=r({},{decimalPlaces:2,requiresParentheses:!1,exceptionValue:"defaultNull"},d),l=parseFloat(e).toFixed(s.decimalPlaces),n.number(parseInt(l))?s.requiresParentheses?o.dynamicContent.getGlobal("openParenthesesSymbol")+l+o.dynamicContent.getGlobal("percentageSymbol")+o.dynamicContent.getGlobal("closeParenthesesSymbol"):l+o.dynamicContent.getGlobal("percentageSymbol"):(a.warn("percentageFormatter: data '"+e+"' is invalid, please provide a valid number"),c(s.exceptionValue)||c("defaultNull"))},decimalFormatter:function(e,t){var s=r({},{decimalPlaces:2,requireSign:!1,exceptionValue:"defaultNull"},t);return n.number(parseInt(e))?s.requireSign&&e>0?o.dynamicContent.getGlobal("plusSymbol")+i(e,s.decimalPlaces):i(e,s.decimalPlaces):(a.warn("decimalFormatter: data "+e+" is invalid, please provide a valid number"),c(s.exceptionValue)||c("defaultNull"))},prettifyNumber:function(e,i){if(!n.number(parseInt(e)))return a.warn("prettifyNumber: data "+e+" is invalid, please provide a valid number"),c(i)||c("defaultNull");switch(!0){case e>=t.TRILLION:return parseFloat(e/t.TRILLION).toFixed(2)+"T";case e>=t.BILLION&&e<t.TRILLION:return parseFloat(e/t.BILLION).toFixed(2)+"B";case e>=t.MILLION&&e<t.BILLION:return parseFloat(e/t.MILLION).toFixed(2)+"M";case e>=t.THOUSAND&&e<t.MILLION:return parseFloat(e/t.THOUSAND).toFixed(2)+"K";case e<t.THOUSAND:return parseFloat(e).toFixed(2)}},currencyFormatter:function(e,t){var s,l,d=r({},{decimalPlaces:2,dollarSign:!0,requireSign:!1,exceptionValue:"defaultNull"},t),u=o.dynamicContent.getGlobal("currencyDollarSymbol")||"$",p=o.dynamicContent.getGlobal("minusSymbol"),f=new RegExp("^\\"+p+"?\\"+u+"?|,","g"),m=new RegExp("^\\"+p,"g"),g=null;return n.string(e)&&(e[0]===p&&1===e.match(m).length&&(g=!0),(e=e.replace(f,""))==(s=parseFloat(e))&&(e=s)),n.number(e)?(e<0&&(e*=-1,g=!0),l=i(e,d.decimalPlaces),d.dollarSign&&(l=u+l),g?l=p+l:d.requireSign&&(l=o.dynamicContent.getGlobal("plusSymbol")+l),l):(a.warn("currencyFormatter: data "+e+" is invalid, please provide a valid number"),c(d.exceptionValue)||c("defaultNull"))},phoneFormatter:function(e,t,i){var r=e&&e.match&&e.match(/\d/g)&&e.match(/\d/g).join("");return!r||r&&10!==r.length?(a.warn("phoneFormatter: phone number "+e+" is invalid, please provide a valid phone number"),c(i)||c("defaultNull")):n.undefined(t)?r:"-"===t?r.substr(0,3)+o.dynamicContent.getGlobal("hyphenSymbol")+r.substr(3,3)+o.dynamicContent.getGlobal("hyphenSymbol")+r.substr(6,4):"("===t?o.dynamicContent.getGlobal("openParenthesesSymbol")+r.substr(0,3)+o.dynamicContent.getGlobal("closeParenthesesSymbol")+" "+r.substr(3,3)+o.dynamicContent.getGlobal("hyphenSymbol")+r.substr(6,4):(a.warn("phoneFormatter: second parameter sign "+t+" is not a valid sign, please provide a valid sign from either '-' or '(' "),c(i)||c("defaultNull"))},removeChar:function(e,t,i){return i=n.object(t)&&t||i,charRegex=i&&i.skipChar&&new RegExp("[0-9*"+i.skipChar+"]","g")||/\d*/g,n.string(e)||n.number(e)?e.match?e.match(charRegex).join(""):e:(a.warn("removeChar: numberStr: "+e+" is not a string, please provide a string"),c(t)||c("defaultNull"))}}})),define("appkit-utilities/formatters/formatters",["require","appkit-utilities/formatters/number","appkit-utilities/formatters/dateTime"],(function(e){return{number:e("appkit-utilities/formatters/number"),date:e("appkit-utilities/formatters/dateTime")}})),define("appkit-utilities/fileUtil/defaultTemplate",[],(function(){return{v:4,t:[{t:4,f:[{t:4,f:[{t:2,r:"."},{t:2,x:{r:["i","header","delimiter"],s:'Object.keys(_1).indexOf(_0)<Object.keys(_1).length-1?_2:""'}}],n:52,i:"i",r:"header"},{t:2,r:"newline"}],n:50,r:"header"},{t:4,f:[{t:4,f:[{t:2,r:"."},{t:2,x:{r:["j","../","delimiter"],s:'Object.keys(_1).indexOf(_0)<Object.keys(_1).length-1?_2:""'}}],n:52,i:"j",r:"."},{t:2,x:{r:["i","data.length","newline"],s:'_0<(_1-1)?_2:""'}}],n:52,i:"i",r:"data"}],e:{}}})),define("appkit-utilities/fileUtil/downloader",["require","blue/is","blue-view-ractive/ractive","blue/root","blue/log","./defaultTemplate","blue/util","mout/object/values","papaparse","blue/util"],(function(e){var t=e("blue/is"),n=e("blue-view-ractive/ractive"),i=e("blue/root"),a=e("blue/log")("[appkit-downloader]"),r=e("./defaultTemplate"),o=e("blue/util").object.extend,s=e("mout/object/values"),c=e("papaparse"),l=e("blue/util").object.extend,d={".txt":{delimiter:"\t",newline:"\r\n"},".csv":{delimiter:",",newline:"\r\n"},".xls":{delimiter:",",newline:"\r\n"}};function u(){}return u.prototype={download:function(e,u,p,f){var m,g,h,v,y,b,C,A,I,S=!1,E=!1,w=[];function D(e,t){e&&(a.warn(t),S=!0)}if(u.v&&u.t?(v=u,y=p,b=l({},f)):(v=r,y=u,b=l({},p),/txt|text|csv|xls/.test(y.extension)&&(E=!0)),D(!t.object(y)||t.array(y),"settings is required and must be an object"),D(!t.string(y.name)||""===y.name,"settings.name must be a string"),D(!t.string(y.extension||""===y.extension),"settings.extension must be a string"),b&&(D(b.data,"options should not have data property"),D(b.header&&(!t.object(b.header)||t.array(b.header)),"options.header must be an object"),D(b.keyOrder&&!t.array(b.keyOrder),"options.keyOrder must be an array")),!S){var k,x;if(/text/.test(y.extension)?y.extension=".txt":0!==y.extension.indexOf(".")&&(y.extension="."+y.extension),g=y.name+(navigator.userAgent.toLowerCase().indexOf("android")>-1?"_"+(new Date).getTime().toString():"")+y.extension,(b=b||{}).data=e,d[y.extension]&&(b.delimiter=b.delimiter||d[y.extension].delimiter,b.newline=b.newline||d[y.extension].newline),b.header||!1===b.defaultHeader||(b.header={},Object.keys(e[0]).forEach((function(e){b.header[e]=e})),a.warn("define header based on data keys")),b.keyOrder&&(e.forEach((function(e){A={},b.keyOrder.forEach((function(t){if(!e[t])throw new Error("downloader: missing data for ordered key "+t);A[t]=e[t]})),w.push(A)})),b.data=w,b.header&&(E?(I=[],b.keyOrder.forEach((function(e){I.push(b.header[e])})),b.header=I):(I=JSON.parse(JSON.stringify(b.header)),b.header={},b.keyOrder.forEach((function(e){b.header[e]=I[e]}))))),E?(C=o({},d[y.extension]),h=c.unparse({fields:s(b.header),data:(k=b.data,x=[],k.forEach((function(e){x.push(s(e))})),x)},C)):h=new n({template:v,data:b}).toHTML(),(m=t.defined(Blob)&&new Blob([h],{type:"text/csv"}))||a.warn("Blob data is undefined"),navigator.msSaveBlob)return navigator.msSaveBlob(m,g);var T=i.document.createElement("a");if(void 0===T.download){var M=new FileReader;M.onload=function(){window.open(M.result,"_blank").focus()},M.readAsDataURL(m)}else{var O;O=b.isLargeData?URL.createObjectURL(m):"data:attachment/csv;charset=utf-8,%EF%BB%BF"+encodeURIComponent(h),T.setAttribute("href",O),T.setAttribute("download",g),T.style.display="none",i.document.body.appendChild(T),T.click(),i.document.body.removeChild(T),t.defined(URL)&&URL.revokeObjectURL(O)}}}},u})),define("appkit-utilities/fileUtil/uploadConfig",[],(function(){return{MAX_FILE_SIZE:5e6,MAX_ROWS:300,MAX_AGGREGATED_SIZE:2e7,ALLOWED_EXTENSIONS:[".csv",".png",".doc",".txt",".docx",".pdf",".xls"],ALLOWED_NUMBER_OF_FILES:20,SAME_FILE_CHECK:!0,CSV_EMPTY_DATA_CHECK:!0,MULTIPLE_FILE_INPUT:!1}})),define("appkit-utilities/fileUtil/uploader",["require","./uploadConfig","blue/log","blue/is","papaparse"],(function(e){"use strict";var t=e("./uploadConfig"),n=e("blue/log")("[appkit-uploader]"),i=e("blue/is"),a=e("papaparse"),r="violatedSameFileName",o={delimiter:",",newline:"\r\n",quoteChar:'"',escapeChar:'"',header:!1,dynamicTyping:!1,preview:0,encoding:"",worker:!1,comments:!1,download:!1,skipEmptyLines:!1,fastMode:void 0};function s(e,a){this.uploadedFiles=[],a&&!i.string(a)?n.warn("Input element id must be a string\nA dynamic input element will be generated"):this.inputElementId=a,!e||i.object(e)&&!i.array(e)?this.config=e||t:(n.warn("Config must be an object\nDefault config will be used"),this.config=t)}function c(e){var t=e,n=document.createElement("input");return n.setAttribute("id","uploader_generated_input"),n.setAttribute("type","file"),t.config.MULTIPLE_FILE_INPUT&&n.setAttribute("multiple",""),n}function l(e){return document.getElementById(e.inputElementId)}function d(e,t){for(var n=e.config.ALLOWED_EXTENSIONS,i=!1,a=0,r=n.length;a<r;a++)i=t===n[a].split(".").pop().toLowerCase()||i;return i}function u(e,t,n){var i=e,a=[],o=i.config.MAX_FILE_SIZE,s=t.name,c=s.split(".").pop().toLowerCase();return n&&(i.uploadedFiles.indexOf(s)<0?i.uploadedFiles.push(s):a.push(r)),d.call(null,i,c)||a.push("violatedFileType"),o&&t.size>o&&a.push("violatedFileSize"),a}function p(e,t){var n=e,i=[],a=n.config.MAX_AGGREGATED_SIZE,r=n.config.ALLOWED_NUMBER_OF_FILES;return a&&t.aggregatedSize>a&&i.push("violatedAggregatedSize"),r&&t.fileCounts>r&&i.push("violatedNumberOfFiles"),i}function f(e,t,n,i){var a;"file"===t?n[i](e):((a=new FileReader).onload=function(e,t){n[e](t.target.result)}.bind(null,i),"b64"===t?a.readAsDataURL(e):a.readAsText(e))}function m(e,t,n){var i,s,c,l=e,d=l.config.SAME_FILE_CHECK,m=l.config.CSV_EMPTY_DATA_CHECK,g=l.config.MAX_ROWS,h=!1,v=[],y=[],b=function(e){var t=Object.keys(e),n={fileCounts:t.length,aggregatedSize:0,files:[]};return t.forEach((function(t){n.aggregatedSize+=e[t].size})),n}(t),C={},A=function(e){y.push(e)},I=function(e,t,n,i,a){C[i]=function(e,t,n){var i=e.data,a=[];return(e.errors||[]).length&&a.concat(e.errors),n&&i.length>n&&a.push("violatedMaxRows"),t&&(i.length<2||2===i.length&&1===i[1].length&&""===i[1][0])&&a.push("emptyData"),a}(a,m,g),f(e,t,n,i)};b.groupViolations=p.call(null,l,b);for(var S=0;S<t.length;S++)s="csv"===(i=t[S]).name.split(".").pop().toLowerCase(),c=!(!m&&!g)&&s,v.push(new Promise(A)),c?(o.complete=I.bind(null,i,n,y,S),a.parse(i,o)):f(i,n,y,S);return Promise.all(v).then((function(e){return e.map((function(e,i){b.files[i]="file"===n?e:{name:t[i].name,size:t[i].size,data:e},b.files[i].violations=(C[i]||[]).concat(u.call(null,l,b.files[i],d)),d&&-1!==b.files[i].violations.indexOf(r)&&!1===h&&(b.groupViolations.push(r),h=!0)})),b}))}function g(e,t){var n=e,i=n.inputElement.files,a=m.call(null,n,i,t);return new Promise((function(e){e(a)}))}function h(e,t){var n=e;return new Promise((function(e,i){var a=l.call(null,n);n.inputElement=a||c.call(null,n),n.inputElement.value="",n.inputElement.onchange=function(){g.call(null,n,t).then((function(t){e(t)})).catch((function(e){i(e)}))},a||document.body.appendChild(n.inputElement),n.inputElement.click(),a||document.body.removeChild(n.inputElement)}))}return s.prototype=Object.create(null),s.prototype.constructor=s,s.prototype.getFileAsText=function(){return h.call(null,this,"text")},s.prototype.getFileAsb64=function(){return h.call(null,this,"b64")},s.prototype.getFileObject=function(){return h.call(null,this,"file")},s.prototype.clearUploader=function(){this.uploadedFiles.length=0},s})),define("appkit-utilities/fileUtil/index",["require","./uploader","./downloader"],(function(e){return{uploader:e("./uploader"),downloader:e("./downloader")}})),define("appkit-utilities/inspect/script",["require","blue/event/channel/component"],(function(e){"use strict";var t=document,n=e("blue/event/channel/component"),i=function(e){var t=function(e){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".indexOf(e)};return e.split("").map((function(e){return t(e)>-1?"NOPQRSTUVWXYZABCDEFGHIJKLMnopqrstuvwxyzabcdefghijklm"[t(e)]:e})).join("")},a=t?t[i("trgRyrzragfOlGntAnzr")].bind(t):void 0;return{gather:function(){var e,n={},r=[],o={};return t&&a?(n.url=t.URL,n[i("rkgreanyFpevcgf")]=[],n[i("cntrYriryFpevcgGntf")]=[],(e=a(i("fpevcg"))).length&&(r=Array.from(e)),r.forEach((function(e){e.type&&e.type!==i("grkg/wninfpevcg")||(e.src?n[i("rkgreanyFpevcgf")].push(e.src):((o={})[i("anzrqShapgvbaf")]=function(e){for(var t,n=new RegExp(/function\s+([^\s\(]+)/,"gm"),i=new RegExp(/([a-zA-Z0-9_\$]+)(\s*(:|=)\s*)function\s*\(/,"gm"),a=[];t=n.exec(e);)a.push(t[1]);for(;t=i.exec(e);)a.push(t[1]);return a}(e.text),o[i("nabalzbhfShapgvbaPbhag")]=function(e){for(var t,n=new RegExp(/([a-zA-Z0-9_\$]+(\s*(:|=)\s*))?function\s*\(/,"gm"),i=0;t=n.exec(e);)t[1]||i++;return i}(e.text),o[i("punenpgrePbhag")]=e.text.length,n[i("cntrYriryFpevcgGntf")].push(o)))})),n):n},send:function(e){n.emit("pageInventory",{value:e})}}})),define("appkit-utilities/context",[],(function(){var e=function(){return this},t={id:(new Date).getTime(),root:e(),logger:e().console,init:function(e){t.appContext=e.appContext&&e.appContext||null,t.settings=e.settings&&e.settings||null,t.logger=t.appContext&&t.appContext.logger||t.logger},on:function(e,n){t.appContext&&(n&&t.appContext.site.on(e,n)||t.appContext.site.on(e))},emit:function(e,n){t.appContext&&(n&&t.appContext.site.broadcast(e,n)||t.appContext.site.on(e))}};return t})),define("appkit-utilities/jsBridge/handlers",[],(function(){var e,t=["CLOSE","CANCEL","PROFILE","SHARE","BACK","LEAVE"];return{nativeHandlers:{updateNativeNavigationBarButtons:function(e){e&&e.pageTitle&&[["<sup></sup>","(R)"],[/&amp;/g,"&"]].forEach((function(t){e.pageTitle=e.pageTitle.replace(t[0],t[1])}));return e},onFinish:!0,releaseSpinner:!0,getPDFDocument:!0,externalBrowser:!0,goToNativePage:!0,addCardToWallet:!0,refreshProfile:!0,notifyToNative:!0},jsHandlers:{shouldNativeHandleButtonPressed:function(n){var i=!0;t.indexOf(String(n).toUpperCase())>=0&&"function"==typeof e&&void 0===(i=e(n))&&(i=!0);return!!i},setShouldNativeHandleButtonPressedCallBack:function(t){"function"==typeof t&&(e=t)}}}})),define("appkit-utilities/jsBridge/index",["require","appkit-utilities/context","appkit-utilities/jsBridge/handlers","appkit-utilities/jsBridge/jsBridge"],(function(e){var t,n=e("appkit-utilities/context"),i=e("appkit-utilities/jsBridge/handlers"),a=e("appkit-utilities/jsBridge/jsBridge"),r=i.nativeHandlers,o=i.jsHandlers,s={},c=function(e){return"function"==typeof r[e.command]&&r[e.command](e.params),e};return s.init=function(){n.on({"appkit:messageToNative":s.messageToNative})},s.messageToNative=function(e){return t=!1,n.root.hybrid&&function(e){var t=!1;return e&&e.command?r[e.command]?r[e.command]&&(c(e),t=!0):n.logger.error('jsBridge: Native hanlder method "'+e.command+'" is not available'):n.logger.error("jsBridge: Type of message not available in options.command argument."),t}(e)&&function(e){n.appContext?(a.assignContext({appContext:n.appContext,maxRetryCount:e.maxRetryCount||500}),a.callBridge(e.command,e.params),t=!0):n.logger.error("jsBridge: missing appContext in Appkit-Uitlities Boot.")}(e),function(e){(e=e||{}).status=t,"function"==typeof e.callBack&&e.callBack(e),n.emit("appkit:res:messageToNative",e)}(e),e},s.jsHandlers=o,s})),define("appkit-utilities/service/interceptor/eventTrackerServiceInterceptor",["require","blue/store/enumerable/cookie","appkit-utilities/jsBridge/index"],(function(e){"use strict";var t=new(e("blue/store/enumerable/cookie"))(null,!0),n=e("appkit-utilities/jsBridge/index");function i(e){n.messageToNative({command:"notifyToNative",params:{payload:e,eventType:"getDataWatchFailedAnalyticsEvent"}})}return{before:function(e){var n,a;return n=t.get("DWHTTPCookie"),(a=n&&parseInt(n.split("|")[1])||void 0)&&e.data.length&&JSON.parse(e.data).events.filter((function(e){return"log"!==e.payload.eventType})).forEach((function(e){!function(e,t){var n,a;a={payload:JSON.stringify(e),sessionId:t,sequence:1},(n=new XMLHttpRequest).open("POST","https://data-watch-api.test.gaiacloud.jpmchase.net/svc/events"),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("x-jpmc-csrf-token",decodeURIComponent(document.cookie.replace(/(?:(?:^|.*;\s*)authcsrftoken\s*\=\s*([^;]*).*$)|^.*$/,"$1"))||null),n.timeout=3e3,n.send(JSON.stringify(a)),n.ontimeout=function(){i(a.payload)},n.onloadend=function(){200!==n.status&&i(a.payload)},n.onerror=function(){i(a.payload)}}(e,a)})),e}}})),define("appkit-utilities/service/interceptor/issueCodeMapper",[],(function(){return{around:function(e){var t,n,i;if("string"==typeof e.args[0].data&&"application/json"===e.args[0].contentType)try{e.args[0].data=JSON.parse(e.args[0].data)}catch(e){return Promise.reject(e)}return t=e.args[0].data.compspec,n=e.target.context.issueCodeMapper||{},i=void 0===e.args[0].data.statusCodeOverride||e.args[0].data.statusCodeOverride,delete e.args[0].data.compspec,delete e.args[0].data.statusCodeOverride,new Promise((function(a,r){function o(e){if(e.issueTypeCode&&(e.issueCode=e.issueTypeCode),e.issueCode){var a=n.map(t,e.issueCode);i&&1===Object.keys(a).length&&a.issueCode!==e.issueCode&&(e.statusCode=a[Object.keys(a)[0]]),e.issueCode=a}}"object"==typeof e.args[0].data&&"application/json"===e.args[0].contentType&&(e.args[0].data=JSON.stringify(e.args[0].data)),e.proceed().then((function(e){o(e),a(e)}),(function(e){o(e),r(e)}))}))}}})),define("appkit-utilities/service/interceptor/servicePromise",["require","blue/log","blue/is"],(function(e){"use strict";var t=e("blue/log")("[appkit-interceptor]"),n=e("blue/is"),i=n.string;return function(e,a){if(i(e)){if(!n.defined(a)||i(a))return{around:function(t){var i,r=this,o=!0;return(t.args||[]).length&&(t.args[0]&&t.args[0][a]&&(o=!1,delete t.args[0][a]),i=r.context.util.object.deepClone(t.args[0])),new Promise((function(a,s){function c(){i&&(t.args[0]=t.target.prerequest(i,i.data)),t.proceed().then((function(e){a(e)})).catch((function(e){s(e)}))}n.undefined(r.context.application[e])?s(new Error("interceptor: cannot find servicePromise")):o?r.context.application[e].then((function(){c()})).catch((function(e){s(e)})):c()}))}};t.warn("overrideKey must be a string.")}else t.warn("servicePromise is required and must be a string.")}})),define("appkit-utilities/service/issueCodeMapper",["require","blue/is","blue/log"],(function(e){var t=e("blue/is"),n=e("blue/log")("[issueCodeMapper]");return function(e){return{map:function(i,a){var r,o={};if(a)return r=a,i?(t.array(i)||(i=[i]),i.forEach((function(t){var n=(e[t]||{})[a]||e[a];n&&(o[t]=n)})),r=0===Object.keys(o).length?{issueCode:a}:o):r={issueCode:e[a]||a},r;n.warn("Required field issue code was not provided to the issue code mapper.")}}}})),define("appkit-utilities/view/customEventHandlerMixin",[],(function(){"use strict";return function(e){var t=this;t.__eventHandlers=[];var n=t.onReady,i=t.onDestroy,a=t.customEventHandlerEnabled;t.__commonEventHandler=function(n,i){0===n.action.indexOf("view.")?function(n,i){var a=n.action.split(".")[1];a?t[a]||"function"==typeof t[a]?t[a](t,i):e.logger.error("CustomEventHandlerMixin | View action:"+a+"is not defined in view"):e.logger.error("CustomEventHandlerMixin | Invalid view action definition, should be defined as view.{actionName}")}(n,i):function(e,n){t.trigger(e.action,n)}(n,i)},t.__addElementEventHandler=function(e){e&&e.element&&e.events&&e.events.forEach((function(n){n.event&&n.action&&(t.__$rootNode.on(n.event,e.element,(function(e){t.__commonEventHandler(n,e)})),t.__eventHandlers.push({event:n.event,element:e.element}))}))},t.__addCustomEventHandler=function(){if(t.bridge&&t.bridge.spec&&t.bridge.spec.customTriggers&&Array.isArray(t.bridge.spec.customTriggers))try{t.bridge.spec.customTriggers.forEach(t.__addElementEventHandler)}catch(t){e.logger.error("CustomEventHandlerMixin | Error in addCustomEvenHandler",t)}},t.__removeElementEventHandler=function(e){t.__$rootNode.off(e.event,e.element)},t.__removeCustomEvenHandler=function(){try{t.__eventHandlers.forEach(t.__removeElementEventHandler),t.__eventHandlers=[]}catch(t){e.logger.error("CustomEventHandlerMixin | Error in removeCustomEvenHandler",t)}},a&&(t.onReady=function(){t.context&&t.context.$&&(t.__$rootNode=t.context.$()),n&&n(),t.__addCustomEventHandler()},t.onDestroy=function(){i&&i(),t.__removeCustomEvenHandler()})}})),define("appkit-utilities/view/frameUtil",["require","blue/dom","blue/is","blue/log"],(function(e){var t,n=e("blue/dom"),i=e("blue/is"),a=e("blue/log")("[frameUtility]"),r=0;return{createFrame:function(e){if(!e||!e.nodeId)throw a.warn("nodeId is a required field."),new Error("nodeId is a required field.");var o=n.getElementById(e.nodeId),s=n.createElement("iframe");s.src=e.frameSrc||"",s.scrolling=e.scrolling||"yes",s.frameBorder=e.frameBorder||0,s.id=e.frameId||"frame_"+r,s.name=e.frameName||s.id,i.function(e.onLoad)&&(s.onload=e.onLoad),(e.sandbox&&i.array(e.sandbox)||!0===e.sandbox)&&(t=i.array(e.sandbox)?e.sandbox.join(" "):"",s.setAttribute("sandbox",t)),o&&(o.appendChild(s),o.style.display=e.display||"block",r++)}}})),define("appkit-utilities/view/pageTitle",["require","blue/log","appkit-utilities/content/dcu","appkit-utilities/messenger/messenger","appkit-utilities/common/constants"],(function(e){var t=e("blue/log")("[pageTitle]"),n=e("appkit-utilities/content/dcu"),i=e("appkit-utilities/messenger/messenger"),a=e("appkit-utilities/common/constants").BRAND_ID,r=n.dynamicContent,o=function(e){return e.context&&e.context.pageTitle};function s(e,t,n){var i,a,r;if(n=n||"",i=(e=e||{}).value,t.string(i))return!0===e.isHtml?(a=i,(r=document.createElement("div")).innerHTML=a,r.textContent+n):i+n}return{setTitle:function(e,n,c){var l=o(e);if(l){var d,u,p=" "+r.getGlobal("hyphenSymbol")+" ",f=null,m=e.context.userInfo,g=e.context.is,h=m&&m.brandId===a.JPMORGAN?"jpMorganOnlineLabel":"chasePersonalOnlineLabel";u=r.getGlobal(h),p=s(n.delimiter,g)||p,f=s(n.h1,g,p)||f,u=s(n.appName,g)||u,null!==f?(l.clearPrefix(),d=f+u):d=u,l.setTitle(d),i.isFramedIn()&&i.sendMessage({protocol:"childEvent",command:"setTitle",data:{title:d},id:c})}else t.error("Could not set page title because view does not have a page context.")},getTitle:function(e){var t=o(e);return t?t.getTitle():""}}})),define("appkit-utilities/view/restrictTabbing",["require","blue/log","blue/dom","blue/root"],(function(e){var t=e("blue/log")("[restrictTabbing]"),n=e("blue/dom"),i=e("blue/root");return function(e,a){a=a||"a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]";var r,o=n.querySelector(e);if(o){var s=[].filter.call(o.querySelectorAll(a),(function(e){return"visible"===i.getComputedStyle(e).visibility&&"-1"!==e.tabindex})),c=s[0],l=s.length,d=s[l-1];r=function(e){var t=n.activeElement,i=s.indexOf(t);9!==e.which||e.shiftKey?9===e.which&&e.shiftKey&&0===i&&(d.focus(),e.preventDefault()):i===l-1&&(c.focus(),e.preventDefault())},o.addEventListener("keydown",r)}else t.warn("Element does not exist.");return function(){o&&o.removeEventListener("keydown",r)}}})),define("appkit-utilities/view/util",["require","blue/log","blue/$","blue/is","appkit-utilities/view/pageTitle"],(function(e){var t=e("blue/log")("[Appkit-utilities: viewUtil]"),n=e("blue/$"),i=e("blue/is"),a=e("appkit-utilities/view/pageTitle");function r(){return t.warn("domEvent not exist"),!1}function o(e){var t=document.createElement("testelem"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var i in n)if(e.is.defined(t.style[i]))return n[i]}return{updateClassAttr:function(e,t,i){var a=n(e);i?a.removeClass(t):a.addClass(t)},isSpaceOrEnterKey:function(e){var t=e.keyCode?e.keyCode:e.domEvent?e.domEvent.keyCode:r();return 32===t||13===t},isClickOrTap:function(e){return e.domEvent?"click"===e.domEvent.type||"mouse"===e.domEvent.pointerType||"touch"===e.domEvent.pointerType||"tap"===e.domEvent.type:r()},copyToClipboard:function(e){try{if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(e).then((function(){t.warn(e+" copied to clipboard successfully!")}),(function(n){t.warn("Error copying "+e+" to clipboard.")}));else{var n=document.createElement("textarea");n.value=e,n.style.top="0",n.style.left="0",n.style.position="fixed",document.body.appendChild(n),n.select(),document.execCommand("copy")?t.warn(e+" copied to clipboard successfully!"):t.warn("Error copying "+e+" to clipboard."),document.body.removeChild(n)}}catch(n){t.warn("Error copying "+e+" to clipboard.")}},downloadFileFromUrl:function(e,n){var a,r,o,s,c;e&&i.string(e)?(s=n||e.substring(e.lastIndexOf("/")+1),(a=new XMLHttpRequest).open("GET",e,!0),a.responseType="blob",a.send(),a.onload=function(){if(r=Blob&&new Blob([a.response],{type:"application/octet-stream"}))if(void 0===(c=document.createElement("a")).download){if(navigator.msSaveBlob)return navigator.msSaveBlob(r,s);var e=new FileReader;e.onload=function(){window.open(e.result,"_blank").focus()},e.readAsDataURL(r)}else o=URL.createObjectURL(r),c.setAttribute("href",o),c.setAttribute("download",s),c.style.display="none",document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(o)}):t.error("Please provide URL string to download file.")},addTransitionEvent:function(e,t,n){var i=o(e);i&&t.addEventListener(i,n)},removeTransitionEvent:function(e,t,n){var i=o(e);i&&t.removeEventListener(i,n)},isValidCTA:function(e){return this.isClickOrTap(e)||this.isSpaceOrEnterKey(e)},isEventType:function(e,t){if(t=t||[],e.domEvent){for(var n=0;n<t.length;n++)if(e.domEvent.type===t[n])return!0;return!1}return r()},setTitle:a.setTitle,getTitle:a.getTitle,adaNotify:function(e,n){var a,r,o,s="liveregion";i.string(e)&&(i.string(n)||(n=s),r=document.createTextNode(e),(a=document.getElementById(n))||n===s||(a=document.getElementById(s)),a?((o=document.createElement("div")).appendChild(r),a.appendChild(o),setTimeout((function(){a.removeChild(o)}),1e3)):t.warn("Aria-live region does not exist."))},setFocus:function(e){var a,r,o=e.view,s=e.selector,c=e.delay,l=e.tabindex,d=function(e){return o&&o.$element&&o.$element.find(e)||n(e)},u=function(){if(!(a=d(s)).length)return t.warn("setFocus: Selector element is not available: ",s),!1;!function(){var e=document.activeElement;if(a[0]===e&&"-1"!==a.attr("tabindex")){var t="setFocus_"+Date.now(),n="#"+t;r=d(n),a.parent().append('<span id="'+t+'" tabindex="-1"></span>'),(r=a.parent().find(n)).focus()}}(),r&&r.remove(),i.defined(l)&&a.attr("tabindex",l),a.focus(),t.info("setFocus: focused on ",s,"number"==typeof c?"with "+c+" delay":"without delay")};if(!i.defined(s))return t.warn("setFocus: Issue in set focus method, selector argument is not available: "),!1;c&&setTimeout((function(){u()}),c)||u()}}})),define("appkit-utilities/view/validationSubmitAda",["require","./util","blue/util","blue/log","blue/is"],(function(e){"use strict";var t=e("./util"),n=e("blue/util").string,i=e("blue/log")("[validationSubmitAda]"),a=e("blue/is"),r=["input.validation__error","textarea.validation__error","select.validation__error","fieldset.validation__error input","div.validation__error input","div.validation__error-selects select",'mds-text-input:not([error-message=""])[inactive=false]','mds-text-input-secure:not([error-message=""])[inactive=false]','mds-select:not([error-message=""])[inactive=false]','mds-datepicker:not([error-message=""])[inactive=false]','mds-radio-group:not([error-message=""])[inactive=false]','mds-checkbox:not([error-message=""])[inactive=false]'];function o(e,t){if(!e||!t||!a.string(t))throw i.warn("submitButtonId and formId are required fields. Please see documentation for details."),new Error("submitButtonId and formId are required fields. Please see documentation for details.")}return function(e,i,s,c,l){var d,u,p,f=this;a.object(e)?o(!0,e.formId):o(e,i),i=e.formId?e.formId:i,p=e.submitButtonId&&a.string(e.submitButtonId)?e.submitButtonId:e&&a.string(e)?e:"",c=e.messageForAda&&a.string(e.messageForAda)?e.messageForAda:c&&a.string(c)?c:"",s=e.liveRegionId&&a.string(e.liveRegionId)?e.liveRegionId:s&&a.string(s)?s:"liveregion",l=e.customSelectors&&a.array(e.customSelectors)?e.customSelectors:l,d=document.getElementById(i),u=p&&document.getElementById(p),f.triggerSubmitAda=function(){var e=l&&a.array(l)?r.concat(l):r,i=d.querySelectorAll(e.join(",")),o=f.model.v&&f.model.v.getErrorCount&&f.model.v.getErrorCount();o>0&&t.adaNotify(n.interpolate(c,{0:o}),s),i.length>0&&(i[0].focus(),i[0].scrollIntoView({block:"end"}))},u&&(u.removeEventListener("click",f.triggerSubmitAda),u.addEventListener("click",f.triggerSubmitAda))}})),define("appkit-utilities/view/viewFirstAda",["require","blue/device/platform","./util"],(function(e){"use strict";var t=e("blue/device/platform"),n=e("./util");function i(e){var t=document.createElement("a");return t.setAttribute("href","#"),t.setAttribute("style","clip:rect(1px, 1px, 1px, 1px);white-space:nowrap;position:absolute !important;height:1px;width:1px;overflow:hidden;"),t.innerText="new content loading",e.parentNode.insertBefore(t,e),t.addEventListener("click",(function(e){e.preventDefault()})),t}return function(e,a,r){if(!e||!a)throw this.context.logger.warn("The dataSpec and the target are both required parameters."),new Error("The dataSpec and the target are both required parameters.");var o,s=document.getElementById(a),c=!0,l=this;if(!s)throw this.context.logger.warn("The target parameter did not resolve to a valid DOM node, please verify."),new Error("The target parameter did not resolve to a valid DOM node, please verify.");s.setAttribute("aria-hidden","true"),"iOS"===t.os.family&&(o=i(s)),l.triggerViewFirstAda=function(){c&&(s.setAttribute("aria-hidden","false"),"iOS"===t.os.family?function(e,t,n){if(n){e.innerText=n;var i=document.createElement("span");i.setAttribute("tabindex","-1"),t.insertBefore(i,t.firstChild),e.addEventListener("click",(function(t){t.preventDefault(),i.focus(),e.parentNode.removeChild(e)}))}}(o,s,r):n.adaNotify(r),c=!1)},l.resetViewFirstAda=function(){c||(s.setAttribute("aria-hidden","true"),"iOS"===t.os.family&&(o=i(s)),c=!0)},l.onData(e,(function(e){c&&e&&l.triggerViewFirstAda()}),{init:!1})}})),define("appkit-utilities/view/webSpecUtil",["require","blue/is"],(function(e){return{createWebSpec:function(t,n){var i,a,r,o="string"==typeof t?e(t):t,s=e("blue/is"),c={name:o.name,bindings:{},triggers:{}};return n&&(i=n.triggers?n.triggers:n,a=n.dataBindings&&n.dataBindings,c.defaultBindings=!s.boolean(n.defaultBindings)||n.defaultBindings,c.preventDefault=!s.boolean(n.preventDefault)||n.preventDefault,c.stopPropagation=!s.boolean(n.stopPropagation)||n.stopPropagation),o.data&&Object.keys(o.data).forEach((function(e){n&&(r=function(e,t){return r=e&&e.upstream&&e.upstream.indexOf(t)>-1?"UPSTREAM":e&&e.both&&e.both.indexOf(t)>-1?"BOTH":"DOWNSTREAM"}(a,e)),c.defaultBindings&&"DOWNSTREAM"===r?c.bindings[e]={}:c.bindings[e]={direction:r||"DOWNSTREAM"}})),i&&Object.keys(i).forEach((function(e){c.triggers[e]=i[e]})),c}}})),define("appkit-utilities/dirtyForm/interceptor/dirtyFormRouterInterceptor",["blue/is"],(function(){var e=require("blue/is");return function(t){this.around=function(n){var i,a,r,o,s,c,l=!1,d=n.proceed,u=!!t&&t.dirtyForm;if(!e.undefined||e.undefined(u)||u.onRemove||u.overlayShowed)d();else{if(u.dirtyIgnore)return d(),void(u.dirtyIgnore=!u.dirtyIgnore);if(u.ignoreDirtyCheck&&u.ignoreDirtyCheck("dirtyIgnoreCallback"))return void d();var p=u.dirtyCheckAll&&u.dirtyCheckAll()||{},f=p.instanceNames,m=t.showOverlay,g=function(){u.onRemove=!0,u.overlayShowed=!1,e.undefined(f)||e.array(f)&&0===f.length?u.onRemove=!1:t.emit("dirtyDeregister",{name:f}),delete t.showOverlay,l=!0,d()},h=function(){u.overlayShowed=!1;var e=p.getLastFocus();e&&e.focus&&e.focus()};if(u.showDirtyOverlay&&u.showDirtyOverlay("showDirtyOverlayCallback")||p.isDirty){a=n.args[1].newRoute,o=(c=p.routeBlackList||[]).length;for(var v=0;v<o;v++){if((i=c[v])===a)return void d();if(e.object(i)&&i.test&&i.test(a))return void d()}r=p.component,s=p.analyticsKey||"exitConfirmationOverlay",u.overlayShowed=!0,e.function&&e.function(m)?m(!0,g,h,r,s,p.options):t.dirtyDefaultOverlay(r,s,g,h,p.options)}else m&&m(!1,g),delete t.showOverlay,!1===l&&d()}}}})),define("appkit-utilities/dirtyForm/dirtyFormUtil",["require","blue/$","blue/log"],(function(e){var t=e("blue/$"),n=e("blue/log")("[dirtyForm]");function i(e){if("string"==typeof e||e instanceof String){var t=0;if(0===e.length)return t;for(var i=0;i<e.length;i++){t=(t<<5)-t+e.charCodeAt(i),t&=t}return t}n.warn("The argument 'str' is not a string, please provide a string")}function a(e,t){var n,i,a=this,r={};return e&&0!==e.length?(t&&(i=JSON.parse(a.initModelStr),n=Object.keys(i)),e.map((function(e){r[e]=t&&-1!==n.indexOf(e)?i[e]:a[e]})),JSON.stringify(r)):JSON.stringify(a.model.get())}function r(e){var t=this,r=t.initModelStr,o=a.call(t,e),s=t.context.is.number(t.initHashCode)&&i(o)!==t.initHashCode;if(s)try{n.debug("The init and dirty model for component "+t.name+" is: ",JSON.parse(r),JSON.parse(o))}catch(e){}return s}function o(){return this.lastFocus}return{dynamicLastFocus:function(e,n,i){var a=this;t(e).on(n,i,(function(e){a.lastFocus=e.currentTarget}))},processCallback:function(e){var t,n,i;i=(n=this.registeredForms||[]).length;for(var a=0;a<i;a++)if((t=n[a][e])&&"function"==typeof t&&t())return!0;return!1},dirtyCheckAll:function(){for(var e=this.registeredForms||[],t=0;t<e.length;t++){var n=e[t],i=n.compInstanceNames,a=n.preCallback;a&&a();for(var s=0;s<i.length;s++){var c=n.controller.components;if(r.call(c[i[s]],n.whiteList))return{isDirty:!0,getLastFocus:o.bind(this),component:c[i[s]],instanceNames:i,analyticsKey:n.analyticsKey,routeBlackList:n.routeBlackList,options:n.options}}}return{isDirty:!1}},getModelStr:a,formatInput:function(e,t){for(var n=e[0],i=1;i<e.length;i++)n=n+t+e[i];return n},hashCode:i}})),define("appkit-utilities/dirtyForm/dirtyForm",["require","./interceptor/dirtyFormRouterInterceptor","./dirtyFormUtil","blue/log","blue/util","blue/is"],(function(e){var t,n,i=e("./interceptor/dirtyFormRouterInterceptor"),a=e("./dirtyFormUtil"),r=e("blue/log")("[dirtyForm]"),o=e("blue/util"),s=e("blue/is"),c="blur click",l="button,input,a:not(.STYLED_SELECT),.calendar,mds-button,mds-link";function d(e,t){for(var n=0;n<e.length;n++)if(e[n].compInstanceNames.indexOf(t)>=0)return!0;return!1}function u(e){delete e.initModelStr,delete e.initHashCode}function p(e,t,n){var i=a.getModelStr.call(e,t,n);e.initModelStr=i,e.initHashCode=a.hashCode(i)}function f(e,t,n){var i,c=e.controller,l=e.compInstanceNames,u=e.whiteList||[],f=e.routeBlackList||[],m=this.registeredForms,g=c.context,h=g.is||s;g.util.object||o.object;if(!h.array(l)||u&&!h.array(u)||f&&!h.array(f))r.warn("compInstanceNames, whiteList or routeBlackList need to be array!");else{e.routeBlackList=g.util.array.union(this.masterRouteBlackList,f);for(var v=0;v<l.length;v++){if(d(m,l[v]))return void r.warn("Unable to register this component: it either has been registered, or there are two identical component instace names");if(!(i=c.components[l[v]]))return void r.warn("component "+l[v]+" does not exist in controller "+g.controllerName);p(i,u)}a.dynamicLastFocus.call(this,e.target,t,n),m.push(e)}}function m(e,n){var i,a,c,l,d,f,m,g=this.registeredForms,h=!1,v=s;t=t||o.object;for(var y=g.length-1;y>=0;y--){if(f=(a=g[y]).compInstanceNames,c=a.controller,v.array(e.name)&&e.name===f&&"remove"===n){c.context.application.dirtyForm.onRemove=!1,i=(d=t.deepClone(f)).length;for(var b=0;b<i;b++)m=d[b],u(c.components[m]),f.splice(f.indexOf(m),1)}else for(b=0;b<f.length;b++)if(m=f[b],e.name===m)if(l=c.components[m],"remove"===n)c.context.application.dirtyForm.onRemove=!1,u(l),f.splice(b,1);else if("update"===n){if(e.whiteList){if(!s.array(e.whiteList))return void r.warn("whiteList for dirtyWhiteListUpdate need to be array!");h=!0,a.whiteList=e.whiteList}l&&p(l,a.whiteList,h)}0===f.length&&g.splice(y,1)}}function g(e){var t=this;n=e.on({dirtyRegister:function(e){var n=e.selectors&&0!==e.selectors.length?a.formatInput(e.selectors,","):l,i=e.events&&0!==e.events.length?a.formatInput(e.events," "):c;f.call(t,e,i,n)},dirtyDeregister:function(e){m.call(t,e,"remove")},dirtyUpdate:function(e){m.call(t,e,"update")},dirtyWhiteListUpdate:function(e){m.call(t,e,"update")},removeComponent:function(e){m.call(t,e,"remove")}})}function h(e,t){var n=this;e.dirtyForm={},Object.defineProperties(e.dirtyForm,{showDirtyOverlay:{value:a.processCallback.bind(n)},ignoreDirtyCheck:{value:a.processCallback.bind(n)},dirtyCheckAll:{value:a.dirtyCheckAll.bind(n)},routerInterceptor:{value:new i(e)}}),Object.defineProperties(n,{registeredForms:{value:[]},masterRouteBlackList:{value:t||[]}}),g.call(n,e)}return{init:function(e,t,i,o){if(n)r.warn("dirtyForm has already been initialized");else{if(!e.appName)return void r.warn("Need to pass in the app context.");t&&!s.array(t)&&(r.warn("Need to pass in the masterRouteBlackList as an array."),t=[]),l=o&&0!==o.length?a.formatInput(o,","):l,c=i&&0!==i.length?a.formatInput(i," "):c,h.call(this,e,t)}}}})),define("appkit-utilities/encryption/config",[],(function(){return{pinEncryptionKeyPairVersion:"A",encryptionKeyDetails:{kty:"RSA",alg:"RSA-OAEP",ext:!0},importKeyAlgorithm:{name:"RSA-OAEP",hash:{name:"SHA-1"}},importKeys:{PKCS8:"pkcs8",SPKI:"spki",RAW:"raw",JWK:"jwk"}}})),define("appkit-utilities/encryption/util",["require","./config","blue/log","blue/util","blue/is"],(function(e){"use strict";var t=e("./config"),n=t.importKeys,i=function(){return this.subtleCrypto.importKey(this.format,this.keyDetails,this.algorithm,this.extractable,this.usages)},a=e("blue/log")("[CryptoUtil]"),r=e("blue/util"),o=e("blue/is");function s(e){for(var t=e.length,n=new ArrayBuffer(t),i=new Uint8Array(n),a=0;a<t;a++)i[a]=e.charCodeAt(a);return n}function c(e){var i,a;return e.format!==n.JWK?(i=e.publicKey,e.format!==n.RAW&&!0===e.decodeAsBase64&&(i=atob(i)),a=s(i)):(a=function(e){var t=["format","algorithm","extractable","usages","decodeAsBase64"],n=r.object.deepClone(e);return Object.keys(n).forEach((function(e){-1!==t.indexOf(e)&&delete n[e]})),n}(e),a=r.object.merge(t.encryptionKeyDetails,a)),a}function l(e){var i=[n.PKCS8,n.SPKI,n.RAW,n.JWK],s=e&&r.object.deepClone(e)||{};if(s.format&&-1===i.indexOf(s.format))a.warn("format of CryptoUtil encrypt function should be either of the following - 'raw', 'pkcs8', 'spki' or 'jwk'.");else{if(s.format=s.format||n.JWK,s.format===n.JWK){if(!s.e||!s.n)return void a.warn("getInstance of CryptoUtil failed. options must exist and contain a 'e' and 'n' property.")}else if(!s.publicKey)return void a.warn("getInstance of CryptoUtil failed. options must exist and contain a 'publicKey' property.");this.crypto=window.crypto,this.subtleCrypto=this.crypto&&this.crypto.subtle,this.format=s.format,this.keyDetails=c(s),this.extractable=s.extractable||!1,this.algorithm=s.algorithm||t.importKeyAlgorithm,this.usages=s.usages&&o.array(s.usages)&&s.usages.length>0?s.usages:["encrypt"]}}return l.prototype=Object.create(null),l.prototype.constructor=l,l.prototype.encrypt=function(e,t,n){var a,r,o,c={name:"RSA-OAEP",hash:"SHA-1",iv:this.crypto.getRandomValues(new Uint8Array(16))},l=this;return a=new Promise((function(e,t){r=e,o=t})),i.call(l).then((function(i){l.subtleCrypto.encrypt(n||c,i,t?s(e):e).then((function(e){r(e)})).catch((function(e){o(e)}))})).catch((function(e){o(e)})),a},l.prototype.encode=function(e){var t,n;if(!(e&&e.length<=0||"string"!=typeof e)){t=e.length,n=new Uint8Array(t);for(var i=0;i<t;i++)n[i]=e.charCodeAt(i);return n}a.warn("Encode function data parameter must be a valid string.")},l.prototype.ab2str=function(e){return String.fromCharCode.apply(null,new Uint8Array(e))},l.prototype.getPinEncryptionKeyPairVersion=function(){return t.pinEncryptionKeyPairVersion},{getInstance:function(e){return new l(e)}}})),define("appkit-utilities/url/urlParamUtil",["require","blue/is"],(function(e){"use strict";var t=e("blue/is"),n=/^[a-zA-Z0-9-_]{1,30}$/,i=/^[a-zA-Z0-9-_]+$/;function a(e,a){var r;if(!t.string(a)||!n.test(a))return!1;if(r=e[a],!t.string(r))return!1;var o=decodeURIComponent(r),s={};if(!this)throw new Error('isSafe called without being bound to "this"');var c=this.paramConfigOverrides;if(t.plainObject(c)){var l=c[a];t.plainObject(l)&&(s=l)}var d=s.maxLength||30;return!(o.length>d)&&function(e,n){var a=e.validationRegex||i;return t.string(a)&&(a=new RegExp(a)),!!a.test(n)}(s,o)}var r=function(e){this.paramConfigOverrides=e||{}};return r.prototype.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)","i").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null},r.prototype.insert=function(e,n,i){var a,r,o=e,s=function(e){try{return JSON.stringify(e)}catch(e){return"not an object"}},c=function(t){var a=s(n),r=s(i);throw new Error([t,e,a,r].join(" "))};return t.string(e)||c("invalid url template"),t.plainObject(n)||c("invalid params"),t.plainObject(i)||c("invalid constraints"),a=Object.keys(n),Object.keys(i).forEach((function(e){var t=-1!==a.indexOf(e)?encodeURIComponent(n[e]):"";r=new RegExp("{{"+e+"}}","g"),o=o.replace(r,t)})),o},r.prototype.serialize=function(e){return encodeURIComponent(JSON.stringify(this._secureUrlParams(e)))},r.prototype.deserialize=function(e){return this._validateUrlParams(JSON.parse(decodeURIComponent(e)))},r.prototype._secureUrlParams=function(e){var t,n=Object.keys(e);return n=(n=n.filter(a.bind(this,e))).slice(0,20),t={},n.forEach((function(n){t[n]=e[n]})),t},r.prototype._validateUrlParams=function(e){var n;if(!t.plainObject(e))throw new Error("urlParams are not an object");if((n=Object.keys(e)).length>20)throw new Error("urlParams has too many params");return n.forEach((function(t){if(!a.call(this,e,t))throw new Error("urlParam is not safe")}),this),e},r})),define("appkit-utilities/boot",["require","appkit-utilities/jsBridge/index","appkit-utilities/context"],(function(e){var t={jsBridge:e("appkit-utilities/jsBridge/index")},n=e("appkit-utilities/context");return function(e){for(var i in n.init(e),t)t[i].init()}})),define("appkit-utilities/main",[],(function(){})),define("analytics/main",(function(){})),define("analytics/settings",[],(function(){var e={version:"3.6.20",midConfig:{enableMid:!0,version:"3.0.0",serviceUrl:"https://dpm.demdex.net/id",orgId:"EA673DFC5A2F19060A495C9C@AdobeOrg",audienceManagerServer:"dpm.demdex.net",audienceManagerServerSecure:"true",cookieKeyPre:"AMCV_"},encryptionNote:"base64:",javaScriptVer:"1.8.5",blockBotsEnabled:!0,blockTestAcctEnabled:!1,serverOffsetEnabled:!0,serverEpochHeader:"x-server-epoch",payloadEpochHeader:"server_offset",serverIsBotHeader:"x-server-bt",payloadIsBotHeader:"isBT",PIIConfig:{enable:!0,returnStrPIIFilter:"BLOCKED: This contains PI Data",screenStrPIIFilter:"BLOCKED:ThiscontainsPIData",bypassByComponent:{ADVERTISEMENTS:!0},bypassByDataKey:{adId:!0,advertisementMidasId:!0},bypassByEventType:{pageInventory:!0,log:!0},bypassByDataContain:["ai=","accountid=","accountId=","pageId="],replaceFields:["referrerScreenId","referrerUrl"]},disableQueue:{action:{isHybrid:!0,filter:{action:["reviewOffer"]}}},disableEvents:{focus:!0,nonUserAction:!1}};return{get:function(t){return t?e[t]:e},set:function(t,n){t&&n&&(e[t]=n)}}})),define("analytics/channel/formFieldChannel",["require","blue/event/channel","blue/is","blue/util","blue/log","analytics/settings"],(function(e){var t,n=new(e("blue/event/channel")),i=e("blue/is"),a=e("blue/util"),r=e("blue/log")("[blue-analytics.formFieldChannel]"),o=e("analytics/settings").get("disableEvents"),s=function(e){var t=e.context.analyticsId?e.context.analyticsId:e.context.id;if(t){var n,o=-1;switch(e.context.componentName){case"multiselect":return e.context.options&&Array.isArray(e.context.options)&&e.context.options.forEach((function(t,n){if(a.object.find(e.context.selectedOptions,t))return o=-1!==o?o+", ":"",o+=n})),{formfieldName:t,closed:e.context.hasClosed,selection:o};case"styledselect":case"select":return e.context.options&&Array.isArray(e.context.options)&&e.context.options.forEach((function(t,n){if(t[e.context.valueKey]===e.context.value)return o=n})),{formfieldName:t,closed:e.context.hasClosed,selection:o};case"checkbox":if(i.undefined(e.context.checked)||i.null(e.context.checked))return void r.warn("No checked status found for checkbox:",e.context.componentName);case"radiobutton":return n=t.lastIndexOf("-"),function(e,t,n){var a=e.slice(0,n),r=parseInt(e.slice(n+1),10);if(a===t&&i.number(r)&&r>-1)return!0}(t,e.context.groupName,n)?{formfieldName:t.slice(0,n),selection:t.slice(n+1),checked:e.context.checked}:void r.warn("Unable to parse analyticsId/Id in template:",t);case"toggleswitch":if(i.undefined(e.context.checked)||i.null(e.context.checked))return void r.warn("No checked status found for toggleswitch:",e.context.componentName);case"datepicker":return{formfieldName:t,checked:e.context.checked};default:return{formfieldName:t}}}else r.warn("No Appkit-analytics formFieldStep found for:",e.context.componentName)},c=function(){return n.emitEvent=function(e){if(!e.domEvent||"focus"!==e.domEvent.type||!o.focus){var t,a=function(e){return!!(e&&e.domEvent&&e.domEvent.currentTarget&&e.domEvent.currentTarget.localName&&"mds-"===e.domEvent.currentTarget.localName.substring(0,4))}(e)?function(e){var t=e.domEvent&&e.domEvent.currentTarget,n=t.localName,a=t.getAttribute&&t.getAttribute("analyticsId")||t.id;if(a)switch(n){case"mds-select":return{formfieldName:a,closed:t._visible,selection:t.selectedIndex};case"mds-checkbox":if(i.undefined(t.checked)||i.null(t.checked))return void r.warn("No checked status found for MDS checkbox:",t.componentName);case"mds-radio-group":return{formfieldName:a,selection:t.selectedIndex,checked:!!t.checked};case"mds-switch":if(i.undefined(t.checked)||i.null(t.checked))return void r.warn("No checked status found for MDS toggleswitch:",t.componentName);case"mds-datepicker":return{formfieldName:a,checked:t.checked};default:return{formfieldName:a}}else r.warn("No Appkit-analytics formFieldStep found for MDS:",n)}(e):s(e);return a?(t={eventTimeStamp:Date.now(),name:this.name,data:a,interaction:e.domEvent?"focus"===e.domEvent.type?e.domEvent.type:"change":void 0},n.emit("interaction",t)):void 0}},n};return{getInstance:function(e,n){return t||(t=c()),t}}})),define("analytics/util/takeParam",["require","blue/is"],(function(e){var t=e("blue/is");return function(e,n){var i;switch(n){case"number":return t.number(e)?e:(i=Number(e),Number.isNaN(i)?0:i);case"boolean":return t.boolean(e)?e:"true"===e}}})),define("analytics/bootstrapFormField",["require","analytics/channel/formFieldChannel","blue/root","blue-app/component","blue/intercept","analytics/util/takeParam"],(function(e){var t,n,i=e("analytics/channel/formFieldChannel"),a=e("blue/root"),r=e("blue-app/component"),o=e.specified("blue-legacy/blue-app/config")&&a.require("blue-legacy/blue-app/component"),s=e("blue/intercept").on,c=e("analytics/util/takeParam");return function(e){var a=function(){};return r.prototype.formField=a,o&&(o.prototype.formField=a),c(e.enableAnalytics,"boolean")&&c(e.analytics.eventTypes.formFieldEvent,"boolean")&&(t=s(r,"create",(function(){r.prototype.formField=i.getInstance().emitEvent,t.remove()})),o&&(n=s(o,"create",(function(){o.prototype.formField=i.getInstance().emitEvent,n.remove()})))),function(){t&&t.remove(),n&&n.remove()}}})),define("analytics/channel/adsEventChannel",["require","blue/event/channel/analytics","blue/event/channel"],(function(e){var t,n=e("blue/event/channel/analytics"),i=function(e){return{placement:e.placement,location:e.location,adId:e.adId,variations:e.variations,tagMap:e.tagMap,failoverReason:e.failoverReason,offerId:e.offerId,advertisementMidasId:e.midasId,adLogType:e.logType,adLogInfo:e.logInfo}},a=function(e){switch(e.type){case"requestAdvertisementActionsDisplay":return"adImpression";case"requestAdvertisementDetails":return"adClick";case"requestAdvertisementLog":return"adLog"}};return{getInstance:function(r,o){var s,c;return t||(s=new(e("blue/event/channel")),c=n.asEventStream((function(e){return"requestAdvertisementActionsDisplay"===e.type||"requestAdvertisementDetails"===e.type||"requestAdvertisementLog"===e.type})).map((function(e){return{type:a(e),eventTimeStamp:e.eventTimeStamp,data:i(e)}})),s.plug(c),t=s),t}}})),define("analytics/channel/decisionedContentEventChannel",["require","blue/log","blue/event/channel","blue/is"],(function(e){var t,n=e("blue/log")("[blue-analytics.decisionedContentEventChannel]"),i=new(e("blue/event/channel")),a=e("blue/is");function r(e,t){var n={};switch(t){case"dataCollection":n.properties=e.content;break;case"simpleDecisionedContent":n.placement=Object.keys(e.content)[0],n.variation={data:e.content[n.placement]},n.properties=e.properties;break;case"simpleValueDecisionedContent":n.placement=Object.keys(e.content)[0],n.variation={data:e.content[n.placement]},n.template=e.template,n.properties=e.properties}return n}var o=function(){return i.emitEvent=function(e){var t,o=function(e){if(!a.array(e.content)||!a.array(e.properties))return a.array(e.content)&&!a.empty(e.content)&&a.undefined(e.properties)&&a.undefined(e.template)?"dataCollection":a.plainObject(e.content)&&1===Object.keys(e.content).length?e.template&&a.string(e.template)?"simpleValueDecisionedContent":"simpleDecisionedContent":void n.error("Unable to determine event type based on the content "+JSON.stringify(e.content)+" emitted from component: "+e.component.spec.name);n.error("Since content "+JSON.stringify(e.content)+" is an array, properties "+JSON.stringify(e.properties)+" cannot be emitted from component: "+e.component.spec.name)}(e);if(o)return t={data:r(e,o),eventTimeStamp:e.eventTimeStamp,name:e.component.spec.name},i.emit(o,t)},i};return{getInstance:function(e,n){return t||(t=o()),t}}})),define("analytics/util/experimentActionHelper",[],(function(){var e;return{setExperimentData:function(t){e=t},getExperimentData:function(){return e},getExperimentActions:function(){var e=this.getExperimentData(),t=e&&Object.create(null),n=e&&Object.keys(e)||[],i=function(e,n){n&&n.forEach((function(n){for(var i=n.actions&&n.actions.length||0,a=0;a<i;a++)t[e+"."+n.component+"."+n.actions[a]]={experimentId:n.experimentId,choice:n.choice,action:n.actions[a]}}))};return n.forEach((function(t){i(t,e[t].style),i(t,e[t].template),i(t,e[t].content)})),t}}})),define("analytics/channel/experimentActionChannel",["require","blue/event/channel","blue/event/channel/component","analytics/util/experimentActionHelper","blue/is"],(function(e){var t,n,i=new(e("blue/event/channel")),a=e("blue/event/channel/component"),r=e("analytics/util/experimentActionHelper"),o=e("blue/is");return{getInstance:function(e,s,c){var l;return t&&!c||(l=a.asEventStream("action").filter((function(e){n=n||r.getExperimentActions();var t=e.target.context&&e.target.context.areaName||"app";return n&&o.defined(n[t+"."+e.target.spec.name+"."+e.action])})).map((function(e){var t=e.target.context&&e.target.context.areaName||"app";return{type:"experimentAction",name:e.target.spec.name,data:n[t+"."+e.target.spec.name+"."+e.action]}})),i.plug(l),t=i),t}}})),define("analytics/channel/experimentImpressionChannel",["require","blue/event/channel"],(function(e){var t,n=e("blue/event/channel");return{getInstance:function(e,i){return t||(t=new n),t}}})),define("analytics/channel/impressionEventChannel",["require","blue/event/channel"],(function(e){var t,n=e("blue/event/channel");return{getInstance:function(e,i){return t||(t=new n),t}}})),define("analytics/channel/loggingEventChannel",["require","analytics/settings","blue/event/channel","blue/event/channel/component"],(function(e){var t,n=e("analytics/settings"),i=function(){var t=new(e("blue/event/channel")),i=e("blue/event/channel/component").asEventStream("log").map((function(e){return function(e){var t=n.get();t.isLogMsgEncrypt&&(e.data.message&&e.data.message.stackTrace&&e.data.message.stackTrace.methodName?e.data.message.stackTrace.methodName=t.encryptionNote+btoa(e.data.message.stackTrace.methodName):e.data.message&&(e.data.message=t.encryptionNote+btoa(e.data.message)))}(e),{type:"log",timestamp:e.timestamp,data:e.data,logger:e.logger}}));return t.plug(i),t};return{getInstance:function(e,n){return t||(t=i()),t}}})),define("analytics/channel/pageInventoryChannel",["require","analytics/settings","blue/event/channel","blue/event/channel/component"],(function(e){var t;e("analytics/settings");return{getInstance:function(n,i){var a,r;return t||(a=new(e("blue/event/channel")),r=e("blue/event/channel/component").asEventStream("pageInventory").map((function(e){return{type:"pageInventory",timestamp:e.eventTimeStamp,data:e.value}})),a.plug(r),t=a),t}}})),define("analytics/channel/personalizationChannel",["require","blue/event/channel/analytics","blue/event/channel"],(function(e){var t,n=e("blue/event/channel/analytics"),i=function(e){return{product:e.product,category:e.category,elementName:e.elementName,elementPlacement:e.elementPlacement,elementContext:e.elementContext}},a=function(e){var t={};return e.darkCanaryPersonalizationData?t.darkCanaryPersonalizationData=i(e.darkCanaryPersonalizationData):e.tntPersonalizationData?t.tntPersonalizationData=i(e.tntPersonalizationData):e.ccjPersonalizationData?t.ccjPersonalizationData=i(e.ccjPersonalizationData):t.personalizationData=i(e),t},r=function(e){switch(e.type){case"sendPersonalizationImpression":return"personalizationImpression"}};return{getInstance:function(i,o){var s,c;return t||(s=new(e("blue/event/channel")),c=n.asEventStream((function(e){return"sendPersonalizationImpression"===e.type})).map((function(e){return{type:r(e),eventTimeStamp:e.eventTimeStamp,data:a(e)}})),s.plug(c),t=s),t}}})),define("analytics/util/stores/screenInfo",["require","blue-app/settings"],(function(e){var t=e("blue-app/settings");return{getScreenId:function(){return t.get("blue-screen-id",t.Type.SITE)},setScreenId:function(e){t.set("blue-screen-id",e,t.Type.SITE)},getCurrentURL:function(){return decodeURIComponent(t.get("currentURL",t.Type.SITE))},setCurrentURL:function(e){e=decodeURIComponent(e);t.set("currentURL",e,t.Type.SITE)},getReferrerURL:function(){return decodeURIComponent(t.get("refURL",t.Type.SITE))},setReferrerURL:function(e){e=decodeURIComponent(e);t.set("refURL",e,t.Type.SITE)},getReferrerScreenId:function(){return t.get("refScreenId",t.Type.SITE)},setReferrerScreenId:function(e){t.set("refScreenId",e,t.Type.SITE)}}})),define("analytics/util/urlStateManage",["require","analytics/util/stores/screenInfo","screenmap/api/urlToAnalyticsUri"],(function(e){var t=e("analytics/util/stores/screenInfo"),n=e("screenmap/api/urlToAnalyticsUri");return t.setReferrerURL(document.referrer),t.setCurrentURL(window.location.href),t.setScreenId(n(window.location.href)),function(e){var i=e&&e.url||window.location.href;return t.getCurrentURL()!==i&&(t.setReferrerURL(t.getCurrentURL()),t.setReferrerScreenId(t.getScreenId()),t.setCurrentURL(i),t.setScreenId(n(i))),{currentURL:t.getCurrentURL(),referrerURL:t.getReferrerURL(),referrerScreenId:t.getReferrerScreenId(),screenId:t.getScreenId()}}})),define("analytics/util/duplicateScreenUtil",["require"],(function(e){var t,n,i,a=!1;return{detectDupEvent:function(e){e.data.redirectScreen?(i=e.data.referrerScreenId,n=e.data.referrerURL,a=!0):a?(e.data.referrerScreenId=i,e.data.referrerURL=n,a=!1,t=e):t?(e.eventTimeStamp-t.eventTimeStamp<1500?(t.data.redirectScreen=!0,e.data.referrerScreenId=i,e.data.referrerURL=n):(i=e.data.referrerScreenId,n=e.data.referrerURL),t=e):(t=e,i=e.data.referrerScreenId,n=e.data.referrerURL)},reset:function(){t=void 0}}})),define("analytics/channel/screenEventChannel",["require","analytics/util/urlStateManage","analytics/util/stores/screenInfo","screenmap/api/urlToAnalyticsUri","blue/log","analytics/util/duplicateScreenUtil","blue/is","blue/event/channel","blue/event/channel/screen","blue/event/channel/component"],(function(e){var t,n=e("analytics/util/urlStateManage"),i=e("analytics/util/stores/screenInfo"),a=e("screenmap/api/urlToAnalyticsUri"),r=e("blue/log")("[analytics-overlay]"),o=e("analytics/util/duplicateScreenUtil"),s=e("blue/is"),c=function(e){return e.errorMsg||s.undefined(e.value)?"undefinedOverlay":e.value},l=function(e){var t={type:"screen",eventTimeStamp:e.eventTimeStamp,eventId:e.eventId,data:{redirectScreen:!!e.isRedirect,referrerURL:i.getReferrerURL(),referrerScreenId:i.getReferrerScreenId()}};return o.detectDupEvent(t),t},d=function(){var t=new(e("blue/event/channel")),o=e("blue/event/channel/screen").asEventStream().map((function(e){return n(e),l(e)})),s=e("blue/event/channel/component").asEventStream("state").filter((function(e){return function(e){var t=i.getScreenId(),n=c(e),a=t.split("?")[0];return!(["show","hide"].indexOf(e.overlayStatus)<0||("show"===e.overlayStatus&&-1!==a.indexOf(n,a.length-n.length)?(r.warn("Warning: "+n+" - called show more than once!"),1):"hide"===e.overlayStatus&&-1===a.indexOf(n,a.length-n.length)&&(r.warn("Warning: "+n+" - called hide without show first!",i.getReferrerURL()),1)))}(e)})).map((function(e){return function(e){var t="show"===e.overlayStatus?a("#/"+c(e)):i.getReferrerScreenId();i.setReferrerScreenId(i.getScreenId()),i.setScreenId(t)}(e),l(e)}));return t.plug(o),t.plug(s),n(),t};return{getInstance:function(e,n){return t||(t=d()),t}}})),define("analytics/channel/scrollStopChannel",["require","blue/event/channel","blue/event/channel/domEvents"],(function(e){var t=new(e("blue/event/channel")),n=e("blue/event/channel/domEvents");return function(e){return t.plug(n.asEventStream("scroll").debounce(e)),t}})),define("analytics/util/handleDynamicContentUtilMethods",["require","blue/object/extend","blue/util"],(function(e){var t=e("blue/object/extend"),n=e("blue/util");function i(e){return n.object.has(e,"spec.name")?e.spec.name:e.context?e.context.componentName:e.name}function a(e,n){var a=e[1].split(".");return t(n,{name:i(e[0]),data:{placement:a.length>1?a[0]:e[1],variation:a.length>1?a[1]:e[2]}})}return{getValue:function(e,n){var i=e[0].split("."),a=e[1].split(".");return t(n,{name:i[0],data:{placement:i[1]?i[1]:a[0],variation:a[1]?a[1]:i[1]?a[0]:void 0}})},get:a,set:function(e,n){var a,r;return/\./.test(e[1])?(r=e[1].split(".")[0],a=e[1].split(".")[1]):(r=e[1],a="string"==typeof e[2]?e[2]:"string"==typeof e[3]?e[3]:e[4]),t(n,{name:i(e[0]),data:{placement:r,variation:a}})},setForBinding:a,setVariation:a}})),define("analytics/util/matchers/errorKeyword",[],(function(){return function(e){return/error\_{0,1}(header){0,1}$/i.test(e)}})),define("analytics/util/matchers/communicationKeyword",[],(function(){return function(e){return/communication/i.test(e)}})),define("analytics/util/matchers/warningHeader",[],(function(){return function(e){return/warning\_{0,1}(header){0,1}$/i.test(e)}})),define("analytics/util/matchers/all",["require","analytics/util/matchers/errorKeyword","analytics/util/matchers/communicationKeyword","analytics/util/matchers/warningHeader"],(function(e){return{errorKeyword:e("analytics/util/matchers/errorKeyword"),communicationKeyword:e("analytics/util/matchers/communicationKeyword"),warningHeader:e("analytics/util/matchers/warningHeader")}})),define("analytics/util/checkForAtleastOne",["require","analytics/util/matchers/all"],(function(e){return function(t,n){return t.some((function(t){return e("analytics/util/matchers/all")[t](n)}))}})),define("analytics/channel/variableSettingsChannel",["require","blue/object/extend","blue/event/channel","analytics/util/handleDynamicContentUtilMethods","analytics/util/checkForAtleastOne"],(function(e){var t,n=e("blue/object/extend")(new(e("blue/event/channel")),e("analytics/util/handleDynamicContentUtilMethods"));return{getInstance:function(i,a){return t||(n.emitEvent=function(t){var i,a=t.proceed();if(a){i={type:"communication",eventTimeStamp:Date.now()};var r=n[t.method](t.args,i);e("analytics/util/checkForAtleastOne")(["errorKeyword","communicationKeyword","warningHeader"],r.data.placement)&&n.emit(r)}return a},t=n),t}}})),define("analytics/channel/webEventChannel",["require","blue/event/channel/component","analytics/util/duplicateScreenUtil","blue/event/channel"],(function(e){var t,n=e("blue/event/channel/component"),i=e("analytics/util/duplicateScreenUtil");function a(e){var t={},n=e.target,i=n.spec.data?n.model.toJSON(n.spec.data).model:{};return Object.keys(i).forEach((function(e){t[e]={value:i[e]}})),t}return{getInstance:function(r,o,s){var c,l;return t&&!s||(c=new(e("blue/event/channel")),l=(l=n.asEventStream("action")).map((function(e){return e.nonCustomerEvent||i.reset(),{type:"action",eventTimeStamp:e.eventTimeStamp,name:e.target.spec.name,data:a(e),action:e.action,nonCustomerEvent:e.nonCustomerEvent}})),c.plug(l),t=c),t}}})),define("analytics/util/serverData",["require","analytics/settings"],(function(e){var t,n=e("analytics/settings").get();function i(){this.offset=void 0,this.isBot=!1}return i.prototype=Object.create(null),i.prototype={constructor:i,setData:function(e,t,i){var a=i?i.length:0;this.offset=e,this.isBot=t;for(var r=0;r<a;r++)i[r].location[n.payloadEpochHeader]=this.offset,i[r].device[n.payloadIsBotHeader]=this.isBot},getOffset:function(){return this.offset},getIsBot:function(){return this.isBot}},function(){return t||(t=new i),t}})),define("analytics/util/computeUTCOffset",[],(function(){return function(e){var t=parseInt(e/60),n=Math.abs(t);return 0===t?"+0":n<10?"".concat(t<0?"+":"-",n):t>0?"-".concat(n):"+".concat(n)}})),define("analytics/computed/identity",["require","analytics/util/serverData","blue/device","blue/device","blue/device","blue/device","blue/device","blue/root","analytics/settings","analytics/util/computeUTCOffset"],(function(e){"use strict";var t=e("analytics/util/serverData")();return{get:function(){var n=(new Date).toLocaleTimeString("en-us",{timeZoneName:"short"}).split(" ")[2];return{device:{screenRes:e("blue/device").dimensions.screen.width+"x"+e("blue/device").dimensions.screen.height,browserRes:e("blue/device").dimensions.window.width+"x"+e("blue/device").dimensions.window.height,browserLang:e("blue/device").lang,colorDepth:e("blue/root").screen.colorDepth,javaScriptVer:e("analytics/settings").get("javaScriptVer"),isBT:t.getIsBot()},location:{timezone:n,tz_offset:e("analytics/util/computeUTCOffset")((new Date).getTimezoneOffset()),server_offset:t.getOffset()}}}}})),define("analytics/util/stores/v1stCookie",["require","blue/random","blue/is","blue/root","blue/store/enumerable/cookie"],(function(e){var t=e("blue/random"),n=e("blue/is"),i=e("blue/root"),a=i.location&&i.location.hostname?i.location.hostname:"",r=""===a?"":"localhost"===a?void 0:".chase.com",o="v1st",s=new(e("blue/store/enumerable/cookie"))(null,!0);return{read:function(){var e=s.get(o);if(!n.string(e)||16!==e.length){var i=new Date((new Date).setYear((new Date).getYear()+1905));s.set(o,function(){for(var e=["A","B","C","D","E","F","0","1","2","3","4","5","6","7","8","9"],n=16,i="";n--;)i+=e[Math.floor(16*t())];return i}(),i,"/",r),e=s.get(o)}return e}}})),define("analytics/util/stores/s_viCookie",["require","blue/random","blue/is","blue/root","analytics/util/stores/v1stCookie","blue/store/enumerable/cookie"],(function(e){var t=e("blue/random"),n=e("blue/is"),i=e("blue/root"),a=e("analytics/util/stores/v1stCookie").read(),r=i.location&&i.location.hostname?i.location.hostname:"",o=""===r?"":"localhost"===r?void 0:".chase.com",s="s_vi",c=new(e("blue/store/enumerable/cookie"))(null,!0)||"",l=function(e,n){return"[CS]v1|"+e+"-"+function(e){for(var n=["A","B","C","D","E","F","0","1","2","3","4","5","6","7","8","9"],i=e,a="";i--;)a+=n[Math.floor(e*t())];return a}(n)+"[CE]"};return{read:function(){var e=c.get(s);if(n.string(a)&&16===a.length&&(!n.string(e)||44!==e.length)){var t=new Date((new Date).setYear((new Date).getYear()+1905));c.set(s,l(a,16),t,"/",o,!0),e=c.get(s)}return e}}})),define("analytics/computed/user",["require","blue/resource/persona","analytics/util/stores/v1stCookie","analytics/util/stores/s_viCookie","blue/siteData","blue/store/enumerable/cookie"],(function(e){var t=(new(e("blue/resource/persona"))).read(),n=e("analytics/util/stores/v1stCookie").read(),i=e("analytics/util/stores/s_viCookie").read(),a=e("blue/siteData"),r=new(e("blue/store/enumerable/cookie"))(null,!0);return function(){var e=r.get("_tmprememberme")?r.get("_tmprememberme"):0,o=r.get("_rememberme"),s=a.getData("ssv_eci")?a.getData("ssv_eci"):t?t.ECI:void 0,c=a.getData("profileId")?a.getData("profileId"):window.profileId?window.profileId:t?t.pfid:void 0,l=s||c?o||0!==e&&"0"!==e?"knwn_rmbrme":"knwn":"unknwn",d=a.getData("aggregatedAccountType")?a.getData("aggregatedAccountType"):void 0,u=a.getData("testProfile")?a.getData("testProfile"):void 0;return serviceOnlyConsumer=a.getData("serviceOnlyConsumer"),consumerPersona=a.getData("consumerPersona"),{eci:s,profileId:c,visitorId:n,s_vi:i,segment:a.getData("segment")?a.getData("segment"):t?t.segment:void 0,userType:a.getData("userType")||void 0,visitorType:l,aggregatedAccountType:d,isPrdTestAcct:u,serviceOnlyConsumer:serviceOnlyConsumer,consumerPersona:consumerPersona}}})),define("analytics/computed/midCompute",["require","exports","module","blue/store/enumerable/cookie","blue/is","blue/util","blue/root","blue/log","blue/siteData","analytics/computed/user","analytics/settings"],(function(e,t,n){var i=new(e("blue/store/enumerable/cookie"))(null,!0),a=e("blue/is"),r=e("blue/util"),o=e("blue/root"),s=e("blue/log")("[blue-analytics]"),c=e("blue/siteData"),l=e("analytics/computed/user"),d=e("analytics/settings").get("midConfig"),u=!a.empty(n.config())&&r.object.merge(d,n.config())||d,p=o.location&&o.location.hostname?o.location.hostname:"",f=""===p?"":"localhost"===p?void 0:".chase.com",m=!1,g=u.cookieKeyPre+u.orgId,h=!1,v=!1,y=function(){var e,t,n="0123456789",i="",a="",r=10,o=10;for(e=0;19>e;e++)t=Math.floor(Math.random()*r),i+=n.substring(t,t+1),0===e&&9==t?r=3:((1==e||2==e)&&10!=r&&2>t||2<e)&&(r=10),t=Math.floor(Math.random()*o),a+=n.substring(t,t+1),0===e&&9==t?o=3:((1==e||2==e)&&10!=o&&2>t||2<e)&&(o=10);return i+a},b=function(e,t,n){var r,o,c;if(a.defined(e)&&(r=e.services&&e.services.analyticsTracking)&&!h)return h=!0,u.serviceUrl&&(r.settings("analytics.mid.create.svc").url=u.serviceUrl),r["analytics.mid.create.svc"](t).then((function(e){if(!n)return I(e)})).catch((function(e){return s.warn("Demdex Failure - MID :",e),h=!1,o=i.get(g),c=a.defined(o)&&A(o,"MCMID"),v||c?void 0:(v=!0,m=!0,I({d_mid:y()}))})).then((function(){h=!1}))},C=function(){return l()},A=function(e,t){var n=t+/\|(([\w&.\-]+\.)?([\w&.\-]+\.)?(\*|[\w&.\-]+))(?=$|\|)/.source,i=e.match(n);return i&&i[1]||""},I=function(e){var t,n=i.get(g),o=C()||{},s={},l=new Date((new Date).setYear((new Date).getYear()+1905));return a.defined(e)&&(e=!a.object(e)&&JSON.parse(e)||e,s={SETTINGS_DIGEST:S(u.version+"|"+u.audienceManagerServer+"|"+u.audienceManagerServerSecure),MCMID:a.defined(e.d_mid)&&e.d_mid||"",MCAAMLH:a.defined(e.dcs_region)&&e.dcs_region||"",MCAAMB:a.defined(e.d_blob)&&e.d_blob||"",MCCIDHVALUE:a.defined(o.eci)&&a.defined(o.profileId)&&a.defined(n)&&S(o.eci+o.profileId)?"MCCIDH":"",MCCIDH:a.defined(o.eci)&&a.defined(o.profileId)&&a.defined(n)&&S(o.eci+o.profileId)||"",MCOPTOUT:a.defined(e.d_optout)&&"none"!=e.d_optout.toString().toLowerCase()&&e.d_optout||"isoptedout-false",TESTPROFILE:a.defined(c.getData("testProfile"))&&c.getData("testProfile")||"false"},t=r.string.interpolate("{{SETTINGS_DIGEST}}|MCIDTS|17564|MCMID|{{MCMID}}|MCAID|NONE|MCOPTOUT|{{MCOPTOUT}}|MCAAMLH|{{MCAAMLH}}|MCAAMB|{{MCAAMB}}|{{MCCIDHVALUE}}|{{MCCIDH}}|MCSYNCSOP|411-17568|vVersion|2.3.0|TESTPROFILE|{{TESTPROFILE}}",s),t=m?t+"|IsCustom|true":t,i.set(g,t,l,"/",f)),t},S=function(e){var t,n=0;if(a.defined(e))for(e=e.toString(),t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n&=n;return n},E=function(e){var t=i.get(g);return e=e||"MCMID",a.defined(t)&&!a.empty(u)&&u.enableMid&&A(t,e)||void 0},w=function(){return{adobeData:i.get(g)}};return{get:E,set:function(e){var t=E();return a.defined(t)||a.empty(u)||!u.enableMid?t:b(e,{d_ver:2,d_orgid:u.orgId})},getAdobeData:w,linkCustomerId:function(e){var t,n,r=C()||{},o=i.get(g);if(a.defined(o)&&a.defined(r.eci)&&a.defined(r.profileId)&&!a.empty(u)&&u.enableMid)return m=A(o,"IsCustom"),t=A(o,"MCCIDH")===S(r.eci+r.profileId).toString(),n="d_orgid="+u.orgId+"&d_mid="+A(o,"MCMID")+"&d_blob="+A(o,"MCAAMB")+"&d_cid_ic=pfid%01"+r.profileId+"%011&d_cid_ic=pfidtest%01"+r.profileId+"%011&d_cid_ic=eci%01"+r.eci+"%011&d_cid_ic=v1st%01"+r.visitorId+"%011&d_ver=2",b(e,n,t)},updateMidInEvents:function(e){var t=E(),n=e.length;if(a.defined(t))for(var i=0;i<n;i++)e[i].visitor=r.object.extend(e[i].visitor,w())},updateTestProfileInMid:function(){var e=i.get(g),t=a.defined(e)&&!a.empty(u)&&u.enableMid,n=new Date((new Date).setYear((new Date).getYear()+1905)),r=c.getData("testProfile"),o="TESTPROFILE";if(t&&-1===e.indexOf(o)){var s=e+"|TESTPROFILE|"+(l=a.defined(r)&&r||"false");i.set(g,s,n,"/",f)}else if(t&&e.indexOf(o)>-1&&void 0!==r){var l=r;s=e.replace(/\|TESTPROFILE\|[a-zA-Z]+/gi,"|TESTPROFILE|"+l);i.set(g,s,n,"/",f)}return!0},getTestProfileInMid:function(){var e=i.get(g);return a.defined(e)&&!a.empty(u)&&u.enableMid&&A(e,"TESTPROFILE")||void 0}}})),require.config({paths:{analytics:"analytics/js","blue-legacy":"@blue/blue-legacy/dist/blue-legacy/js"}}),define("analytics/config",(function(){})),define("analytics/config/channelMapperConfig",[],(function(){return[{name:"webEvent",channel:"analytics/channel/webEventChannel",mapper:"analytics/mapper/webEventMapper"},{name:"screenEvent",channel:"analytics/channel/screenEventChannel",mapper:"analytics/mapper/screenEventMapper"},{name:"variableSettingsEvent",channel:"analytics/channel/variableSettingsChannel",mapper:"analytics/mapper/variableSettingsEventMapper"},{name:"decisionedContentEvent",channel:"analytics/channel/decisionedContentEventChannel",mapper:"analytics/mapper/decisionedContentEventMapper"},{name:"adsEvent",channel:"analytics/channel/adsEventChannel",mapper:"analytics/mapper/adsEventMapper"},{name:"personalizationEvent",channel:"analytics/channel/personalizationChannel",mapper:"analytics/mapper/personalizationMapper"},{name:"loggingEvent",channel:"analytics/channel/loggingEventChannel",mapper:"analytics/mapper/loggingEventMapper"},{name:"impressionEvent",channel:"analytics/channel/impressionEventChannel",mapper:"analytics/mapper/impressionEventMapper"},{name:"formFieldEvent",channel:"analytics/channel/formFieldChannel",mapper:"analytics/mapper/formFieldEventMapper"},{name:"experimentImpressionEvent",channel:"analytics/channel/experimentImpressionChannel",mapper:"analytics/mapper/experimentImpressionMapper"},{name:"experimentActionEvent",channel:"analytics/channel/experimentActionChannel",mapper:"analytics/mapper/experimentActionMapper"},{name:"pageInventoryEvent",channel:"analytics/channel/pageInventoryChannel",mapper:"analytics/mapper/pageInventoryMapper"}]})),define("analytics/config/variationsWhitelist",[],(function(){return["NOT_MAPPED","SYSTEM_FAILURE","ECD_STAND_IN_MODE","UNKNOWN_FRAMEWORK_ERROR","NETWORK_SERVICE_FAILURE","PRESENTATION_FAILURE","SLOW_CONNECTION","NO_CONNECTION","C3_MODE","SPLASH_MODE","READ_ONLY_MODE","ECD_MODE"]})),define("analytics/event/decisionedContentEvent",["require","blue/event","blue/is","blue/log","analytics/channel/decisionedContentEventChannel","blue/declare"],(function(e){var t=e("blue/event"),n=e("blue/is"),i=e("blue/log")("[blue-analytics.decisionedContentEvent]"),a=e("analytics/channel/decisionedContentEventChannel"),r=function(e,t){var n=e.spec.data?Object.keys(e.spec.data):[];t.map((function(t){var a=Object.keys(t)[0];-1===n.indexOf(a)&&i.warn('Data field "'+a+'" undefined for component '+e.spec.name)}))};return e("blue/declare")(t,{constructor:function(e,i,o,s){t.call(this),n.array(i)&&r(e,i),this.component=e,this.content=i,this.template=o,n.array(s)&&(r(e,s),this.properties=s),a.getInstance().emitEvent(this)}})})),define("analytics/util/channelMapperPromise",["require","analytics/config/channelMapperConfig","blue/is"],(function(e){var t=e("analytics/config/channelMapperConfig"),n=e("blue/is");return function(i,a,r){var o=[];return t.map((function(t){(n.undefined(r)||!0===r[t.name])&&o.push(new Promise((function(n){e([t.channel,t.mapper],(function(e,t){n(e.getInstance(i,a).asEventStream().map(t,i,a))}))})))})),Promise.all(o)}})),define("analytics/util/addErrorAndCommunicationHooks",["require","blue/intercept"],(function(e){var t=e("blue/intercept").around;return function(n,i){return Promise.all(n.map((function(n){return new Promise((function(a){e([n.module],function(e){this.advice=t(this.ref?e[this.ref]:e,this.method,i),a()}.bind(n))}))})))}})),define("analytics/util/streamCollator",["require","analytics/util/channelMapperPromise","blue/is","blue/observable","analytics/util/addErrorAndCommunicationHooks"],(function(e){var t=e("analytics/util/channelMapperPromise"),n=e("blue/is"),i=e("blue/observable"),a=e("analytics/util/addErrorAndCommunicationHooks");return function(r,o,s,c,l){return!1!==c?(n.string(s)&&(n.undefined(l)||!0===l.variableSettingsEvent)&&e([s,"analytics/channel/variableSettingsChannel"],(function(e,t){return a(e,t.getInstance().emitEvent)})),t(r,o,l)):new Promise((function(e){e(i.never())}))}})),define("analytics/util/eventBlocker",["require","analytics/settings"],(function(e){var t=e("analytics/settings").get("disableEvents");return{isDisabled:function(e){var n=e.payload?e.payload.eventType:void 0,i=!!e.payload&&e.payload.nonCustomerEvent;switch(n){case"action":if(i&&t.nonUserAction)return!0}return!1}}})),define("analytics/util/botUtil",["require","blue/is"],(function(e){var t=e("blue/is");return{isBot:function(e){var n=navigator?navigator.userAgent:void 0,i=!1,a=0;if(!t.array(e)||!t.string(n))return!1;for(;a<=e.length-1&&!i&&t.string(e[a]);)i=n.toLowerCase().indexOf(e[a].toLowerCase())>-1,a++;return i}}})),define("analytics/util/filter",["require","analytics/settings","blue/is"],(function(e){var t=e("analytics/settings").get("PIIConfig"),n=(e("blue/is"),function(e,i){var a=/([\d-. \t/]{9,})|.*(%40|@)\S+(%2C|\.)com.*|.*(gmail(\.|\s*dot\s*)com.*|.*yahoo\.com.*|.*msn\.com.*|.*aol\.com.*|.*hotmail\.com).*|.*gmail.*|.*yahoo.*|.*msn.*|.*hotmail.*/gi;if(e&&t.enable)if(Array.isArray(e)||"object"==typeof e){var r=t.replaceFields;for(var o in e)t.bypassByDataKey&&!0===t.bypassByDataKey[o]||!1||(r&&r.includes(o)&&(i=!0),e[o]=n(e[o],i))}else(function(e){var n=t.bypassByDataContain&&new RegExp(t.bypassByDataContain.join("|"),"g")||!1;return!!n&&n.test(e)})(e)||(i?e=e.replace(a,t.screenStrPIIFilter):a.test(e)&&(e=t.screenStrPIIFilter));return e});return{personalData:n,personalDataByEventType:function(e){var i=!!(e&&e.payload&&e.payload.data),a=e&&e.component&&t.bypassByComponent&&!0===t.bypassByComponent[e.component]||!1,r=i&&t.bypassByEventType&&!0===t.bypassByEventType[e.payload.eventType]||!1;!i||r||a||(e.payload.data=n(e.payload.data),e.screen=n(e.screen,!0))}}})),define("analytics/eventTracker",["require","exports","module","blue/observable","blue/site","blue/device/platform","blue/log","blue/log","blue/log","blue/event/channel","blue/is","analytics/config/channelMapperConfig","analytics/util/takeParam","analytics/util/streamCollator","blue/$","blue/fetch","analytics/bootstrapFormField","analytics/computed/midCompute","analytics/util/eventBlocker","analytics/settings","analytics/util/serverData","analytics/util/botUtil","blue/siteData","blue/root","analytics/util/filter"],(function(e,t,n){var i=e("blue/observable"),a=e("blue/site"),r=e("blue/device/platform"),o=e("blue/log"),s=e("blue/log")("[blue-analytics]"),c=e("blue/log")("[blue-analytics.customLogger]"),l=new(e("blue/event/channel")),d=e("blue/is"),u=e("analytics/config/channelMapperConfig"),p=n.config(),f=e("analytics/util/takeParam"),m=e("analytics/util/streamCollator"),g=e("blue/$"),h=e("blue/fetch"),v=e("analytics/bootstrapFormField"),y=e("analytics/computed/midCompute"),b=e("analytics/util/eventBlocker"),C=e("analytics/settings"),A=e("analytics/util/serverData"),I=e("analytics/util/botUtil"),S=e("blue/siteData"),E=e("blue/root"),w=e("analytics/util/filter"),D=function(e){var t=e.events;for(evnt in t){var n=t[evnt];if(n.payload&&"reviewOffer"===n.payload.action){var i=n.payload.data.advertisementPageId||"",a=n.payload.data.advertisementId||"",r=n.payload.data.advertisementMidasId||"";i=i?i.value:"",a=a?a.value:"";var o=r?r.value:"",s=n.screen.id;if(E.actionManager){var l="midasId: "+o+" screenId: "+s+" pageId: "+i+" mid:"+a;c.error(l),E.actionManager.startClientAction("AnalyticsAdEventFired",null,s),E.actionManager.addActionProperty("customString1",l),E.actionManager.endClientAction()}}}};return function(e,t,n){var c=function(e,t){var n=t;return d.undefined(n)&&d.defined(a.getApplication)&&(n=a.getApplication(e.application).context),n}(e,n),k=y.get(),x=C.get("serverOffsetEnabled"),T=C.get("serverEpochHeader"),M=p.analytics&&p.analytics.serverOffsetEnabled,O=f(d.defined(M)?M:x,"boolean"),P=p.analytics&&p.analytics.blockBotsEnabled,L=C.get("blockBotsEnabled"),N=f(d.defined(P)?P:L,"boolean"),R=p.analytics&&p.analytics.botUserAgents,_=C.get("blockTestAcctEnabled"),F=p.analytics&&p.analytics.blockTestAcctEnabled,U=(f(d.defined(F)?F:_,"boolean"),!1),q=!1,V=!0;if(N&&I.isBot(R))return p.enableAnalytics=!1,void s.info("Bot User Agent detected. Stopping analytics eventTracker...");var j=[];if(d.undefined(c)||d.undefined(c.on))s.error("Failed to initialize analytics eventTracker. Invalid reference to app context",n);else{var B=f(p.enableAnalytics,"boolean");B&&C.set("isLogMsgEncrypt",p.isLogMsgEncrypt);var H={},G=function(e){var t=void 0!==S.getData("testProfile");if(V&&!U&&(U=f(t?S.getData("testProfile"):y.getTestProfileInMid(),"boolean"),q=!!q||y.updateTestProfileInMid()),U)return j=[],U=!0,void s.info("Test account detected. Stopping analytics service...");V=!1,void 0===k&&(y.updateMidInEvents(j),k=!0);var n={events:j};if(j=[],s.info(new Date,JSON.stringify(n,null,2)),y.linkCustomerId(c),e)c.services.analyticsTracking["analytics.reporting.svc"](JSON.stringify(n)).then((function(){D(n),s.info("success")}),(function(e){s.info("error: "+e.status)}));else if(analyticsServiceUrl=c.services.analyticsTracking.settings("analytics.reporting.svc").url,navigator&&navigator.sendBeacon&&n.events[0]&&"reviewOffer"!=n.events[0].payload.action)navigator.sendBeacon(analyticsServiceUrl,JSON.stringify(n)),D(n);else{var i,a;D(n);var r=n.events,o={"x-jpmc-csrf-token":"NONE"};for(evnt in r){var l=r[evnt];if(l.payload&&"reviewOffer"===l.payload.action){var d=l.payload.data.advertisementMidasId||"";i=d?d.value:"",a=l.screen.id,o.midasId||(o.midasId=i,o.screenId=a)}}g.ajax({url:analyticsServiceUrl,contentType:"application/json",method:"POST",data:JSON.stringify(n),async:!1,headers:o,complete:function(e){s.info("beforeUnload ->",e.status,JSON.stringify(n,null,2))}})}return n};c.on("blue:applicationConfigComplete",(function(){var e={contentType:"application/json",method:"POST",data:JSON.stringify({}),headers:{"x-jpmc-csrf-token":"NONE"}};B&&y.set(c),B&&O&&h(c.services.analyticsTracking.settings("analytics.reporting.svc").url,e).then((function(e){var t=e.headers.get(T),n=(new Date).getTime(),i=t?t-n:void 0,a=e.headers.get(C.get("serverIsBotHeader"));A().setData(i,a,j)})).catch((function(e){A().setOffset(void 0)}))})),v(p),u.map((function(e){H[e.name]=!d.defined(p.analytics)||!d.object(p.analytics.eventTypes)||f(p.analytics.eventTypes[e.name],"boolean")})),m(e.site,e.application,t,B,H).then((function(e){var t=p.analytics&&f(p.analytics.bufferInterval,"number")||3e3,n=i.merge(e);l.plug(i.interval(t,1)),c.on("app:event:beforeUnload",(function(){G()})),n.onValue((function(e){b.isDisabled(e)||(w.personalDataByEventType(e),j=j.concat(e),function(e){var t,n=C.get("disableQueue"),i=!1,a=!1;if(p.analytics&&p.analytics.disableQueue&&(n=d.object(p.analytics.disableQueue)&&c.util.object.merge(n,p.analytics.disableQueue)||p.analytics.disableQueue),d.defined(n)&&d.defined(e)&&d.defined(e.payload))if(t=n[e.payload.eventType])if(t.isHybrid||t.filter){if(t.isHybrid&&(E.hybrid||c.hybrid)&&(i=!0),t.filter&&!E.hybrid&&!c.hybrid){for(var r in t.filter)t.filter[r].includes(e.payload[r])&&!a&&(a=!0);i=a}}else i=!0;else f(n,"boolean")&&(i=!0);return i&&s.info("Disabled queue for this event type: ",e),i}(e)&&G())})),l.asEventStream().filter((function(){return c.services&&c.services.analyticsTracking&&j.length>0})).onValue((function(){G(!0)})),function(e){var t="Client platform signature: ";try{t+=JSON.stringify(r)}catch(e){t+="Error in getting platform details"}o("[application:"+e.appName+"]").info(t)}(c)}))}}})),define("analytics/spec/newEventSpec",["require","analytics/util/stores/screenInfo","blue/log","blue-app/settings","blue/util","analytics/computed/midCompute","analytics/computed/user","analytics/computed/identity","blue/root"],(function(e){var t=e("analytics/util/stores/screenInfo"),n=e("blue/log")("[blue-screen-mapping]"),i=e("blue-app/settings"),a=e("blue/util"),r=e("analytics/computed/midCompute"),o=e("analytics/computed/user"),s=e("analytics/computed/identity"),c=e("blue/root"),l=[];return function(e,d){var u=t.getCurrentURL(),p=t.getScreenId(),f=a.object.extend(o(),r.getAdobeData()),m=s.get(),g=c.channel;return"UNDEFINED_SCREEN_ID"===p&&-1===l.indexOf(u)&&(l.push(u),n.warn("No screen id mapped to url",u)),{visitor:f,site:e,app:{name:d,language:i.get("language",i.Type.PERM)||i.get("language")||"en-us",version:"1.3",channel:g},screen:{id:p,currentURL:u},device:m.device,location:m.location,component:"",payload:{}}}})),define("analytics/payload/adsEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/adsEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/adsEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=void 0,r.payload=e("analytics/payload/adsEventPayload")(a),r}})),define("analytics/payload/decisionedContentEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/decisionedContentEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/decisionedContentEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/decisionedContentEventPayload")(a),r}})),define("analytics/payload/experimentActionPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/experimentActionMapper",["require","analytics/spec/newEventSpec","analytics/payload/experimentActionPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/experimentActionPayload")(a),r}})),define("analytics/payload/experimentImpressionPayload",[],(function(){return function(e){return{eventType:"experimentImpression",timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/experimentImpressionMapper",["require","analytics/spec/newEventSpec","analytics/payload/experimentImpressionPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/experimentImpressionPayload")(a),r}})),define("analytics/payload/formFieldEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data,interaction:e.interaction}}})),define("analytics/mapper/formFieldEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/formFieldEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/formFieldEventPayload")(a),r}})),define("analytics/payload/impressionEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/impressionEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/impressionEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/impressionEventPayload")(a),r}})),define("analytics/payload/loggingEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.timestamp||Date.now(),data:e.data,logger:e.logger}}})),define("analytics/mapper/loggingEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/loggingEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=void 0,r.payload=e("analytics/payload/loggingEventPayload")(a),r}})),define("analytics/payload/pageInventoryPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.timestamp||Date.now(),data:e.data}}})),define("analytics/mapper/pageInventoryMapper",["require","analytics/spec/newEventSpec","analytics/payload/pageInventoryPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=void 0,r.payload=e("analytics/payload/pageInventoryPayload")(a),r}})),define("analytics/payload/personalizationPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/personalizationMapper",["require","analytics/spec/newEventSpec","analytics/payload/personalizationPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=void 0,r.payload=e("analytics/payload/personalizationPayload")(a),r}})),define("analytics/payload/screenEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/screenEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/screenEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=void 0,r.payload=e("analytics/payload/screenEventPayload")(a),r}})),define("analytics/payload/variableSettingsEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data}}})),define("analytics/mapper/variableSettingsEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/variableSettingsEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/variableSettingsEventPayload")(a),r}})),define("analytics/payload/webEventPayload",[],(function(){return function(e){return{eventType:e.type,timestamp:e.eventTimeStamp||Date.now(),data:e.data,action:e.action,nonCustomerEvent:e.nonCustomerEvent}}})),define("analytics/mapper/webEventMapper",["require","analytics/spec/newEventSpec","analytics/payload/webEventPayload"],(function(e){var t=e("analytics/spec/newEventSpec");return function(n,i,a){var r=new t(n,i);return r.component=a.name,r.payload=e("analytics/payload/webEventPayload")(a),r}})),define("analytics/scroll/elementInViewport",[],(function(){return function(e,t){t||(t=50);var n=e.getBoundingClientRect();return n.bottom-n.height*t/100-window.innerHeight<1}})),define("analytics/scroll/experimentWatcher",["require","exports","module","analytics/channel/experimentImpressionChannel","analytics/scroll/elementInViewport","blue/event/channel/component","analytics/channel/scrollStopChannel"],(function(e,t,n){var i,a,r,o=e("analytics/channel/experimentImpressionChannel"),s=e("analytics/scroll/elementInViewport"),c=e("blue/event/channel/component"),l=e("analytics/channel/scrollStopChannel"),d=n.config(),u={},p=["style","content","template"];function f(e){var t=Object.create(null);return t.data=e.context,t.name=e.name,t}function m(e){var t=document.querySelectorAll(e);return 1===t.length?t[0]:void 0}function g(e,t,n){(i=e[t].filter((function(e){return e.component===n.componentName})))&&i.length>0&&function(e,t,n){e.forEach((function(e){var t=m(e.selector);t&&(s(t,d.visibilityPercentage)?o.getInstance().emit(f({name:e.component,context:{experimentId:e.experimentId,choice:e.choice}})):(u[n]||(u[n]=[]),u[n].push({selector:e.selector,context:{experimentId:e.experimentId,choice:e.choice},name:e.component})))}))}(i,0,n.componentInstanceName)}return function(e){r=e,a||(a=l(d.delay||1e3).asEventStream().onValue((function(){var e,t;Object.keys(u).forEach((function(n){for(t=u[n],e=t.length-1;e>-1;e--)s(m(t[e].selector),d.visibilityPercentage)&&(o.getInstance().emit(f(t[e])),t.splice(e,1))}))}))),c.on("ready",(function(e){var t=r&&(r[e.target.context.areaName]||r.app);t&&p.forEach((function(n){t[n]&&g(t,n,e)}))})),c.on("destroy",(function(e){u[e.target.key]&&u[e.target.key].splice(0)}))}})),define("analytics/scroll/watcher",["require","exports","module","analytics/util/stores/screenInfo","analytics/channel/impressionEventChannel","analytics/scroll/elementInViewport","analytics/util/takeParam","blue/event/channel/screen","analytics/channel/scrollStopChannel"],(function(e,t,n){var i,a,r,o,s={},c=e("analytics/util/stores/screenInfo"),l=e("analytics/channel/impressionEventChannel"),d=e("analytics/scroll/elementInViewport"),u=e("analytics/util/takeParam"),p=e("blue/event/channel/screen"),f=e("analytics/channel/scrollStopChannel"),m=n.config(),g=u(m.visibilityPercentage,"number"),h=u(m.delay,"number");function v(e){var t=Object.create(null);return t.data=e.context,t.name=e.name,t}return function(e,t){return o||(o=p.asEventStream().onValue((function(){for(a=c.getScreenId();i&&s[i]&&s[i].length;)s[i].shift();a&&!s[a]&&(s[a]=[]),i=a}))),r||(r=f(h).asEventStream().onValue((function(){var e,t=s[a];for(e=t.length-1;e>-1;e--)d(t[e].divId,g)&&(l.getInstance().emit("impression",v(t[e])),t.splice(e,1))}))),new Promise((function(n){var i=setTimeout((function(){clearTimeout(i),n(function(e,t){return Object.keys(e).forEach((function(n){var i=document.getElementById(n);i&&(d(i,m.visibilityPercentage)?l.getInstance().emit("impression",v({name:t,context:e[n]})):(a||(a=c.getScreenId(),s[a]=[]),s[a].push({divId:i,context:e[n],name:t})))})),s}(e,t))}),h)}))}})),define("analytics/service/tracking",[],(function(){return function(){this.serviceCalls={"analytics.reporting.svc":{settings:{url:(window.analyticsDomain||window.domainUrl)+"/events/analytics/public/v1/events/raw/",contentType:"application/json",type:"POST",dataType:"html",disableTrace:!0,disableDefaultError:!0,disableOfflineHandler:!0,byPassUserProfileService:!0}},"analytics.mid.create.svc":{settings:{url:"",type:"GET",disableTrace:!0,disableDefaultError:!0,disableOfflineHandler:!0,bypassDatawatch:!0}}}}})),define("analytics/util/addLoggerHooks",["require","analytics/util/handleDynamicContentUtilMethods","blue/log","analytics/config/variationsWhitelist","analytics/util/checkForAtleastOne"],(function(e){var t=e("analytics/util/handleDynamicContentUtilMethods"),n=e("blue/log")("[DynamicContentUtilLogger]"),i=e("analytics/config/variationsWhitelist");return function(a){var r,o=a.proceed();o&&(r=t[a.method](a.args,{}),e("analytics/util/checkForAtleastOne")(["errorKeyword","communicationKeyword"],r.data.placement)&&i.indexOf(r.data.variation)>-1&&n.error(o));return o}})),define("analytics/util/constant",[],(function(){return function(e){return e}})),define("analytics/util/getCanonicalRoute",["require","blue/hash","blue-app/settings"],(function(e){var t=e("blue/hash"),n=e("blue-app/settings");return function(e){return t.getHash(e||n.get("fullURL",n.Type.SITE))}})),define("analytics/util/hashSanitizer",[],(function(){var e=new RegExp(/^\/?\#?\/?/),t=new RegExp(/(\/index\/?)*$/),n=new RegExp(/\/+$/);return function(i){return i.replace(e,"").replace(t,"").replace(n,"")}})),define("analytics/util/screenIdCompute",["require","blue/hash","analytics/util/hashSanitizer"],(function(e){var t,n=e("blue/hash"),i=e("analytics/util/hashSanitizer");function a(e){var i=function(e){var n=[],i=t[e];if(i)for(var a in i)i.hasOwnProperty(a)&&n.push(a);return n.length?n.shift():""}(e),r=n.getHashArr(e),o=r.length;return i||(o<=3?"":a(function(e){return e.join("/")}(r.slice(0,-1))))}return function(e,n){var r=i(e);return t=n,a(r)}})),define("analytics/util/timer",["blue/is"],(function(){return function(e){var t,n=!1,i=function(e){n=e};if(!(e&&require("blue/is").integer(e)&&e>0))throw new Error("missing or invalid parameter");this.isRunning=function(){return n},this.getTimerId=function(){return t},this.run=function(){return!!this.isRunning()||(t=setTimeout((function(){clearTimeout(t),i(!1)}),e),i(!0),!1)}.bind(this)}})),define("blue-ads/utility/adManager",["require","blue/log"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]");return function(e,n,i,a){this.subscribeForTopics=function(){i.subscribe("adUpdate",(function(e,n,i){i&&i.resolve&&(t.debug("MsgMgr: adUpdate:",e,i,n),i.resolve(n))})),i.subscribe("adFailover",(function(e,n,i,a){n&&n.resolve&&(t.debug("MsgMgr: adFailover:",e,n,a),a&&(a.isGetAdsFailover=!0),n.resolve(a))})),i.subscribe("adError",(function(e,n){n&&n.reject&&(t.warn("MsgMgr: adError:",n),n.reject({reason:"adError",tagCode:e}))}))},this.getAudiences=function(e){return e._a},this.getMultipleContent=function(e){return new Promise((function(i){try{var a,r=e.adParams,o=!!e.htmlAd&&!0===e.htmlAd;e.loadmultipleAds;(a=n.loadBlueAdCollection)?a(e.adResponse,(function(e,t,n){var a={status:!0,content:e,adVariant:t,creativeId:n};if(!0!==o){try{e=JSON.parse(e)}catch(e){}a.content=e}i(a)}),(function(){i({status:!1,message:"MsgMgr: getContent: Error: cid",details:e.adResponse.cid})}),r):i({status:!1,message:"MsgMgr: getContent: Error: Content API",details:e.adResponse.cid})}catch(e){var s="MsgMgr: getContent: Exception"+e.toString();t.warn(s),i({status:!1,message:s,details:e})}}))},this.getCardlyticsAds=function(e){return new Promise((function(n){try{var i=a.loadCardlyticsOffer,r={placementId:e.placementId,pageId:e.tagCode,audiences:e.audiences,evaluateDynamicAd:!0,requiredAdData:e.requiredAdData,requestId:e.requestId};i?i(e.tagCode,e.accountId,r,(function(e,t,i,a,r,o){n({status:!0,content:e,adVariant:t,placementId:i,failOverAd:a,accountIdList:r,categoryList:o})}),(function(e,t,i){n({status:!1,message:"MsgMgr: getContent: Error:",placementId:e,accountIdList:t,adVariant:i})})):n({status:!1,message:"MsgMgr: getContent: Error: Content API"})}catch(e){var o="MsgMgr: getContent: Exception"+e.toString();t.warn(o),n({status:!1,message:o,details:e})}}))},this.getContent=function(e){return new Promise((function(i){try{var a,r,o=!!e.htmlAd&&!0===e.htmlAd;!0===(!0===e.loadBlueAd)?(a=n.loadBlueAd,r={pid:e.placementId,pageId:e.tagCode,audiences:e.audiences,evaluateDynamicAd:o,isEmulationUser:e.isEmulationUser,requestedPersonId:e.requestedPersonId,emulationTokenIdentifier:e.emulationTokenIdentifier}):a=n.loadAd,a?a(e.adResponse.cid,(function(e,t,n,a,r,s){var c={status:!0,content:e,adVariant:t,disclosure:n,isFailoverAd:a,failOverAdContent:r,broadcastParams:s};if(!0!==o){try{e=JSON.parse(e)}catch(e){}c.content=e}i(c)}),(function(){i({status:!1,message:"MsgMgr: getContent: Error"})}),r,e.adResponse):i({status:!1,message:"MsgMgr: getContent: Error"})}catch(e){var s="MsgMgr: getContent: Exception"+e.toString();t.warn(s),i({status:!1,message:s,details:e})}}))},this.getFailoverContent=function(e){return new Promise((function(i){try{var a,r,o=!!e.htmlAd&&!0===e.htmlAd;!0===(!0===e.loadFailoverAd)&&(a=n.loadFailoverAd,r={placementId:e.placementId,pageId:e.tagCode}),a?a(r.pageId,r.placementId,(function(e,t,n,a){var r={status:!0,content:e,adVariant:t,disclosure:n,failOverAdContent:a};if(!0!==o){try{e=JSON.parse(e)}catch(e){}r.content=e}i(r)}),(function(){i({status:!1,message:"MsgMgr: getFailoverContent: Error"})})):i({status:!1,message:"MsgMgr: getFailOverContent: Error: Content API",details:e.adResponse.cid})}catch(e){var s="MsgMgr: getFailOverContent: Exception"+e.toString();t.warn(s),i({status:!1,message:s,details:e})}}))},this.getAds=function(n){return t.debug("MsgMgr: getAds:",n),new Promise((function(t,i){e.init(n.tagCode,n.requiredAdData,{resolve:t,reject:i})}))},this.trackfailOverClick=function(e,n,a,r){try{return t.debug("MsgMgr: trackfailOverClick:",arguments),new i("trackfailOverClick").publish(e,n,a,r)}catch(e){t.error("MsgMgr: trackfailOverClick: Exception:",e.toString())}},this.trackfailOverImpression=function(e,n,a,r){try{return t.debug("MsgMgr: trackfailOverImpression:",arguments),new i("trackfailOverImpression").publish(e,n,a,r)}catch(e){t.error("MsgMgr: trackfailOverImpression: Exception:",e.toString())}},this.trackAdClick=function(e,n,a,r,o){try{return t.debug("MsgMgr: trackAdClick:",arguments),new i("trackAdClick").publish(e,n,a,r,o)}catch(e){t.error("MsgMgr: trackAdClick: Exception:",e.toString())}},this.trackUrlLinkClick=function(e,n,a,r){try{return t.debug("MsgMgr: trackUrlLinkClick:",arguments),new i("trackUrlLinkClick").publish(e,n,a,r)}catch(e){t.error("MsgMgr: trackUrlLinkClick: Exception:",e.toString())}},this.trackSeeAllClick=function(e,n,a,r){try{return t.debug("MsgMgr: trackSeeAllClick:",arguments),new i("trackSeeAllClick").publish(e,n,a,r)}catch(e){t.error("MsgMgr: trackSeeAllClick: Exception:",e.toString())}},this.trackClick=function(e,n,a,r,o){try{return t.debug("MsgMgr -> ",e,arguments),new i(e).publish(n,a,r,o)}catch(n){t.error("MsgMgr -> ",e," Exception:",n.toString())}},this.trackCarouselSlide=function(e){try{return t.debug("MsgMgr: trackCarouselSlide:",arguments),new i("trackCarouselSlide").publish(e.value)}catch(e){t.error("MsgMgr: trackCarouselSlide: Exception:",e.toString())}},this.trackCarouselShowMore=function(e){try{return t.debug("MsgMgr: trackCarouselShowMore:",arguments),new i("trackSeeMoreClick").publish(e.value)}catch(e){t.error("MsgMgr: trackCarouselShowMore: Exception:",e.toString())}},this.trackCarouselDot=function(e){try{return t.debug("MsgMgr: trackCarouselDot:",arguments),new i("trackCarouselDot").publish(e.value)}catch(e){t.error("MsgMgr: trackCarouselDot: Exception:",e.toString())}},this.trackCardlyticsAdImpression=function(e,n,a){try{return t.debug("MsgMgr: trackAdImpression:",arguments),new i("cardlyticsMultipleView").publish(e,n,a)}catch(e){t.error("MsgMgr: trackAdImpression: Exception:",e.toString())}},this.trackAdImpression=function(e,n,a,r,o){try{return t.debug("MsgMgr: trackAdImpression:",arguments),new i("trackAdImpression").publish(e,n,a,r,o)}catch(e){t.error("MsgMgr: trackAdImpression: Exception:",e.toString())}},this.filterWithSelectedCategory=function(e){try{return t.debug("MsgMgr: cardlytics.filterCategory: ",arguments),new i("cardlytics.filterByCategory").publish(e)}catch(e){t.error("MsgMgr: cardlytics.filterByCategory: Exception: ",e.toString())}},this.subscribeForTopics()}})),define("blue-ads/utility/msgMgr",["require","blue-ads/utility/adManager"],(function(e){"use strict";var t=e("blue-ads/utility/adManager"),n=function(n,i,a){try{var r=n.marketingCdnEnabled?n.marketingLoaderUrl:n.slotplacementscript,o="slotplacement/service",s="slotplacement/placement",c="slotplacement/topic",l="slotplacement/cardlyticsinit",d="slotplacement/contentprovider";n.marketingCdnEnabled||requirejs.config({paths:{"slotplacement/slotplacementconfig":n.adConfig}}),define("slotplacement/clientconfig",[],(function(){return n.slotplacementconfig?n.slotplacementconfig:{timeout:"2000",adTrackingDisabled:"false"}})),n.marketingCdnEnabled?e([r],(function(){e(["mktui-framework"],(function(){e([o,s,d,c,l],(function(e,n,a,r,o){var s=new t(e,a,r,o);i(s)}),(function(e){a("MsgMgr: Error: No slotplacementservice: "+e)}))}),(function(e){a("MsgMgr: Error: No slotplacementservice: "+e)}))}),(function(e){a("MsgMgr: Error: No slotplacementscript: "+e)})):e(["slotplacement/slotplacementconfig"],(function(){e([r],(function(){e([o,s,d,c,l],(function(e,n,a,r,o){var s=new t(e,a,r,o);i(s)}),(function(e){a("MsgMgr: Error: No slotplacementservice: "+e)}))}),(function(e){a("MsgMgr: Error: No slotplacementscript: "+e)}))}),(function(e){a("MsgMgr: Error: No slotplacementconfig: "+e)}))}catch(e){a("MsgMgr: Exception: "+e.toString())}};return{adManagerInit:n,init:function(e,t,i,a){var r;try{var o=t.config;"true"!==o.enableAds&&!0!==o.enableAds?r="Error: Ads not enabled":o.envType||(r="Error: NULL envType"),e.adConfig?e.slotplacementscript?e.slotplacementconfig||(r="Error: No slotplacementconfig"):r="Error: No slotplacementscript":r="Error: No adConfig"}catch(e){r="Exception:"+e.toString()}return r?a("MsgMgr: Init: "+r):n(e,i,a),r}}})),define("blue-ads/lib/messageManager",["require","exports","module","blue-ads/utility/msgMgr"],(function(e,t,n){"use strict";var i,a,r=!1,o=new Promise((function(e,t){i=e,a=t})),s=e("blue-ads/utility/msgMgr");return function(e){return!1===r&&(r=!0,void 0!==s.init(n.config(),e,i,a)&&(r=!1)),o}})),define("blue-ads/utility/baUtil",[],(function(){"use strict";var e,t=new Promise((function(t){e=t})),n=function(e){var t=e||"",n=t,i=t.indexOf("?");return-1!==i&&(n=t.substr(0,i)),n},i=function(){return window&&window.performance&&window.performance.now?parseInt(1e3*window.performance.now()):(new Date).getTime()};return{_getAdStaticParamFromScreenEvent:n,_getRandomNumber:i,_registerAdDecision:function(){e({status:!0})},_getInitPromise:function(){return t},getAdParam:function(){return i()+""},getAdStaticParam:function(e){return n(e)},getDOMElement:function(e){return document.getElementById(0===e.indexOf("#")?e.substr(1):e)},elementInViewport:function(e){var t=e&&this.getDOMElement(e),n=t&&t.getBoundingClientRect();return n&&!this.isElementHidden(t)?n.top>=0&&n.left>=0&&(n.bottom+n.top)/2<=window.innerHeight&&n.right<=window.innerWidth:void 0},isElementHidden:function(e){for(;e;){if(!0===e.hidden)return!0;e=e.parentElement}return!1},addEventListener:function(e,t,n){n?n.addEventListener(e,t):document.addEventListener(e,t)},removeEventListener:function(e,t,n){n?n.removeEventListener(e,t):document.removeEventListener(e,t)},isJsonString:function(e){try{JSON.parse(e)}catch(e){return!1}return!0}}})),define("blue-ads/utility/baStore",["require","blue/store/enumerable/memory"],(function(e){"use strict";var t="adCache",n=new(e("blue/store/enumerable/memory"))(t),i="";return{adsStoreDelete:function(){n.remove(t)},adsStoreGet:function(e){var i=n.get(t);return i?i[e]:null},adsStoreSet:function(e,i,a,r){var o=n.get(t)||{};o[e]=o[e]||{},o[e][i]={adContent:r,creativeId:a.creativeId,adDecisionResponse:a},n.set(t,o)},setAdsBlueSpec:function(e){i=e},getAdsBlueSpec:function(){return i}}})),define("blue-ads/utility/categoryStore",["require","blue/store/enumerable/memory","blue/log"],(function(e){"use strict";var t="adCache",n=new(e("blue/store/enumerable/memory"))(t),i=e("blue/log")("[blue-messages]");const a={placementIds:[],actualNumberOfPlacements:0};return{clearCategory:function(e,r){const o=n.get(t);o&&o[e]&&o[e][r]?o[e][r]=Object.assign({},a):i.debug("[clearCategory] no cache object to clear: ",e,r)},getCategory:function(e,r){if(!e||!r)return i.debug("[incrementCategoryCount] all parameters should have values: ",e,r),Object.assign({},a);const o=n.get(t)||{};return o[e]=o[e]||{},o[e][r]?o[e][r]:(this.setCategory(e,r,Object.assign({},a)),this.getCategory(e,r))},setCategory:function(e,i,a){const r=n.get(t)||{};r[e]=r[e]||{},r[e][i]=a,n.set(t,r),this.putCategoryName(e,i)},putCategoryName:function(e,a){const r=n.get(t)||{};r[e]=r[e]||{},r[e].categoryNames=r[e].categoryNames||[],r[e].categoryNames.push(a),r[e].categoryNames=r[e].categoryNames.filter((function(e,t,n){return n.indexOf(e)===t})),i.debug("[putCategoryName] added category to category array: ",a,r[e].categoryNames),n.set(t,r)},getCategoryNames:function(e){if(!e)return i.debug("[getCategoryNames] all parameters should have values: ",e),[];const a=n.get(t)||{};return a[e]=a[e]||{},a[e].categoryNames?a[e].categoryNames:(i.debug("[getCategoryNames] category array is empty: ",a[e].categoryNames),[])},getCategoryNameByPlacementId:function(e,t){if(!e||!t)return void i.debug("[getCategoryNameByPlacementId] all parameters should have values: ",e,t);let n="",a=this.getCategoryNames(e);return a&&a.forEach((a=>{this.getCategory(e,a).placementIds.includes(t)&&(i.debug("[getCategoryNameByPlacementId] found matching category ",a),n=a)})),n},getCategoryCounts:function(e){let t={},n=this.getCategoryNames(e);return n&&(t=n.map((t=>{let n=this.getCategory(e,t);return{category:t,expectedNumberOfPlacements:n.placementIds.length,actualNumberOfPlacements:n.actualNumberOfPlacements}}))),t},incrementCategoryCount:function(e,t){if(!e||!t)return void i.debug("[incrementCategoryCount] all parameters should have values: ",e,t);let n=this.getCategoryNameByPlacementId(e,t);if(!n)return void i.debug("[incrementCategoryCount] categoryName is empty: ",n);let a=this.getCategory(e,n);a.actualNumberOfPlacements=a.actualNumberOfPlacements+1,this.setCategory(e,n,a),i.debug("[incrementCategoryCount] updated cache for "+e+" / "+n+" to "+a.actualNumberOfPlacements)}}})),define("blue-ads/utility/baDecision/baHooks",["require","blue/log"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]");function n(e,t){var n=e.totalPreQualifiedPlacements,i=e.placementPrefix;return Array(n).fill(0).map(((e,t)=>i+(t+1))).some((e=>t[e]&&t[e].cid))}return{executeHook:function(e,i){switch(e.name){case"processPreQualified":var a=n(e.params,i);this.appContext.application.broadcast("processPreQualified",a);break;default:t.warn("Executing Post Decision Hook, hook not registered for: ",e.name)}},processPreQualified:n}})),define("blue-ads/utility/baDecision/baMsgManager",["require","blue/log","blue-ads/utility/baStore","blue-ads/utility/categoryStore","blue-ads/utility/baUtil","blue-ads/utility/baDecision/baHooks"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baStore"),i=e("blue-ads/utility/categoryStore"),a=e("blue-ads/utility/baUtil"),r=e("blue-ads/utility/baDecision/baHooks"),o=!1,s=!1,c=!1,l=[],d=0,u=!1,p=0,f=0,m=0,g={},h={},v="eligibleAccountIdList",y="cardlytics.availableCategoryList",b=function(e,n){this.appContext.application.broadcast(e,n),t.info("Ads broadCastMsgToApp"+e+" triggered with value ",n)},C=function(e,n){if(this.adsRegistry[e])try{var i={type:"html",content:n.content,adVariant:n.adVariant,failOverAd:n.failOverAd,status:n.status};this.currentAdConfig.cardlyticsAdsIntrested&&e===this.currentAdConfig.cardlyticsAdsIntrested[e]&&(i.isCardlyticsAd=!0,i.pageId=this.currentAdConfig.tagCode),t.debug("processAdsContentResponse: sending",e),this.appContext.application.broadcast("adsUpdate_"+e,{data:i})}catch(i){t.warn("processAdsContentResponse: Invalid Data:",e,n)}else t.warn("processAdsContentResponse: Not Registered for",e)},A=function(){p=0,f=0,m=0},I=function(e){if(f++,p===f){b.call(this,"offersCount",m);let e=this.currentAdParam?i.getCategoryCounts(this.currentAdParam):void 0;e&&b.call(this,"categoryCounts",e)}},S=function(e,a,r,o){if(r){var s=this.appContext.user&&this.appContext.user.profile&&this.appContext.user.profile.isEmulationUser(),c=this.appContext.config&&this.appContext.config.requestedPersonId||"",l=this.appContext.config&&this.appContext.config.emulationTokenIdentifier||"";r.cid&&this.adManager?(p++,this.adManager.getContent({loadBlueAd:!0,htmlAd:!0,adResponse:r,placementId:e,tagCode:this.currentAdConfig.tagCode,audiences:o,isEmulationUser:s,requestedPersonId:c,emulationTokenIdentifier:l}).then(function(o){o.content&&(m++,this.currentAdParam&&e&&i.incrementCategoryCount(this.currentAdParam,e)),I.call(this,e),o.disclosure&&b.call(this,"disclosureMsg",o.disclosure),o.failOverAdContent&&o.failOverAdContent.creativeId&&(r.cid=o.failOverAdContent.cid,r.creativeId=o.failOverAdContent.creativeId),o.broadcastParams&&0!==Object.keys(o.broadcastParams).length&&Object.keys(o.broadcastParams).forEach(function(t){b.call(this,t,{placement:e,midasId:r.cid,value:o.broadcastParams[t]})}.bind(this)),this.currentAdParamState=this.engineStates.RSP_AD_CONTENT,t.debug("getAdsContent: ",e,a,r),n.adsStoreSet(this.currentAdParam,e,r,o),C.call(this,a,o)}.bind(this),function(n){I.call(this),t.debug("Error in baDecisionEngine getAdsContent of promise",n,e,a)}.bind(this)).catch(function(n){t.error("Exception in baDecisionEngine getAdsContent of promise",n,e,a)}.bind(this))):(C.call(this,a,{content:null}),n.adsStoreSet(this.currentAdParam,e,r,null))}},E=function(e,i){if(t.debug("[composite] processCompositeAdsResponse: starting",e,i),s&&c&&!o){let s,c,d=(this.currentAdConfig||{}).adsInterested;for(var a in d)"parent"===d[a].slotValue&&(s=d[a],c=a);if(s||t.warn("[composite] parentSlotValue / parentSlotKey are undefined (no parent found)",e,i,d),c&&s&&this.adsRegistry[s.slotId]){if(o=!0,n.adsStoreGet(this.currentAdParam)){var r=n.adsStoreGet(this.currentAdParam);if(r[c])try{var l={type:"html",content:r[c].adContent?r[c].adContent.content:"",adVariant:r[c].adVariant,failOverAd:r[c].failOverAd,isCompositeAdsImpression:!0};t.debug("[composite] processCompositeAdsResponse: sending",e),this.appContext.application.broadcast("adsUpdate_"+s.slotId,{data:l})}catch(n){t.warn("[composite] processAdsContentResponse: Invalid Data:",e,r[c])}}s.slotList.forEach((function(e){if(n.adsStoreGet(this.currentAdParam)){var i=n.adsStoreGet(this.currentAdParam);if(i[e])try{var a={type:"html",content:i[e].adContent.content,adVariant:i[e].adContent.adVariant,failOverAd:i[e].adContent.failOverAd};t.debug("[composite] processAdsContentResponse: sending",this.currentAdConfig.adsInterested[e].slotId);var r=document.getElementById(this.currentAdConfig.adsInterested[e].slotId+"ContentID");r&&(r.innerHTML=a.content)}catch(n){t.warn("[composite] processAdsContentResponse: Invalid Data:",this.currentAdConfig.adsInterested[e].slotId,i[e].adContent)}}}),this)}}else if("child"===e.slotValue&&o)try{l={type:"html",content:i.content,adVariant:i.adVariant,failOverAd:i.failOverAd};t.debug("[composite] processAdsContentResponse: sending",e);var d=document.getElementById(e.slotId+"ContentID");d&&(d.innerHTML=l.content)}catch(n){t.warn("[composite] processAdsContentResponse: Invalid Data:",e,i)}},w=function(e,i,a,r){a&&(g=k.call(this),a.cid&&this.adManager?this.adManager.getContent({loadBlueAd:!0,htmlAd:!0,adResponse:a,placementId:e,tagCode:this.currentAdConfig.tagCode,audiences:r}).then(function(r){r.status?(this.currentAdParamState=this.engineStates.RSP_AD_CONTENT,r.failOverAdContent&&r.failOverAdContent.creativeId&&(a.cid=r.failOverAdContent.cid,a.creativeId=r.failOverAdContent.creativeId),t.debug("[composite] getAdsContent: ",e,i,a),n.adsStoreSet(this.currentAdParam,e,a,r),"parent"===i.slotValue&&(r.isFailoverAd?C.call(this,i.slotId,r):c=!0,d=i.slotList.length),"child"===i.slotValue&&(s=!0),E.call(this,i,r)):r.status||D.call(this,i,r,e)}.bind(this),function(n){t.debug("[composite] Error in baDecisionEngine getAdsContent of promise",n,e,i),D.call(this,i,a,e)}.bind(this)).catch(function(n){t.error("[composite] Exception in baDecisionEngine getAdsContent of promise",n,e,i)}.bind(this)):D.call(this,i,a,e))},D=function(e,t,n){e.slotFailover&&"parent"===e.slotValue&&x.call(this,t,n),"child"!==e.slotValue||u||(l.push(e.slotId),l.length===d&&(u=!0)),u&&g&&g.parentSlotValue&&g.parentSlotValue.slotFailover&&x.call(this,t,n)},k=function(){let e,n,i=((this||{}).currentAdConfig||{}).adsInterested;for(var a in i)"parent"===i[a].slotValue&&(e=i[a],n=a);return void 0!==e&&void 0!==n||t.warn("[composite] slot value parent is not found"),{parentSlotValue:e,parentSlotKey:n}},x=function(e,i){var a=this,r=g.parentSlotValue,o=g.parentSlotKey;a.adManager?a.adManager.getFailoverContent({loadFailoverAd:!0,htmlAd:!0,failoverResponse:e,tagCode:a.currentAdConfig.tagCode,placementId:o}).then(function(i){i.failOverAdContent&&i.failOverAdContent.creativeId&&(e.cid=i.failOverAdContent.cid,e.creativeId=i.failOverAdContent.creativeId),a.currentAdParamState=a.engineStates.RSP_AD_CONTENT,t.debug("[composite] getFailoverContent: ",o,r.slotId,e),n.adsStoreSet(a.currentAdParam,o,e,i),C.call(a,r.slotId,i)}.bind(a),function(e){t.debug("[composite] Error in baDecisionEngine getFailOverAdsContent of promise",e,o,r.slotId)}.bind(a)).catch(function(e){t.error("[composite] Exception in baDecisionEngine getFailoverContent of promise",e,o,r.slotId)}.bind(a)):(C.call(a,r.slotId,{content:null}),n.adsStoreSet(a.currentAdParam,o,e,null))},T=function(e){if(this.currentAdConfig&&this.currentAdConfig.adsInterested&&e){var n,i,a=this.currentAdConfig.adsInterested,p=this.adManager.getAudiences(e),f=Object.keys(e);if(o=!1,c=!1,s=!1,l=[],u=!1,d=0,A.call(this),this.currentAdConfig.postDecisionHook&&r.executeHook.call(this,this.currentAdConfig.postDecisionHook,e),f&&f.length>0)for(var m=0;m<f.length;m++)(i=a[n=f[m]])&&(this.currentAdParamState=this.engineStates.REQ_AD_CONTENT,t.debug("processXPlusOneResponse: ",i,e[n]),"composite"===i.slotType?("parent"===i.slotValue&&(d=i.slotList.length),e.isGetAdsFailover&&i.slotFailover?S.call(this,n,i.slotId,e[n],p):w.call(this,n,i,e[n],p)):S.call(this,n,i,e[n],p))}};return{resetTotalOffersCount:A,getTotalOffersData:function(){return{totalOffersRequested:p,totalOffersReturned:f,totalOffersSet:m}},getAdsManager:function(){if(!this.adManager)return this.msgMgrPromise.then(function(e){this.adManager=e}.bind(this),function(e){t.warn('getAdsManager: Error in require("blue-ads/lib/messageManager") promise',e)}.bind(this)).catch(function(e){t.error('getAdsManager: Exception in require("blue-ads/lib/messageManager") promise',e)}.bind(this))},getAds:function(){return this.msgMgrPromise.then(function(){this.currentAdConfig&&(this.currentAdParamState=this.engineStates.REQ_XPLUS_ONE,t.debug("baDecisionEngine getAds: ",this.currentAdConfig),this.adManager.getAds({tagCode:this.requiredAdData&&this.requiredAdData.targetPageId||this.currentAdConfig.tagCode,adContext:this.currentAdParam,requiredAdData:this.requiredAdData}).then(function(e){this.currentAdParamState=this.engineStates.RSP_XPLUS_ONE,t.debug("baDecisionEngine getAds Success: ",e),T.call(this,e)}.bind(this),function(e){t.debug('Error in baDecisionEngine getAds of "blue-ads/lib/messageManager" promise',e,this.currentAdConfig)}.bind(this)).catch(function(e){t.error('Exception in getAds of "blue-ads/lib/messageManager" promise',e,this.currentAdConfig)}.bind(this)))}.bind(this),function(e){t.warn('getAds: Error in require("blue-ads/lib/messageManager") promise',e)}.bind(this)).catch(function(e){t.warn('getAds: Exception in require("blue-ads/lib/messageManager") promise',e)}.bind(this))},getCompositeAdsContent:w,getCardlyticsAds:function(e,i){return this.msgMgrPromise.then(function(){if(h={},this.currentAdConfig){this.currentAdParamState=this.engineStates.REQ_XPLUS_ONE;var e=this.currentAdConfig.cardlyticsAdsIntrested;for(var i in e){var r=a._getRandomNumber();h[r]=i,this.placementId=i,t.debug("[cardlytics] baDecisionEngine getCardlyticsAds: ",this.currentAdConfig),this.adManager.getCardlyticsAds({tagCode:this.currentAdConfig.tagCode,placementId:this.placementId,adContext:this.currentAdParam,requiredAdData:this.requiredCardlyticsAdData,accountId:this.requiredCardlyticsAdData.accountId,requestId:r}).then(function(e){if(this.currentAdConfig&&this.currentAdConfig.cardlyticsAdsIntrested&&e){var i=this.currentAdConfig.cardlyticsAdsIntrested,a=(this.adManager.getAudiences(e),e.placementId),r=i[a];this.currentAdParamState=this.engineStates.RSP_AD_CONTENT,b.call(this,v,e.accountIdList),b.call(this,y,e.categoryList),t.debug("[cardlytics] getAdsContent: ",a,r),n.adsStoreSet(this.currentAdParam,a,e,e),e.adVariant&&e.adVariant.requestId in h&&C.call(this,r,e)}}.bind(this),function(e){t.debug('[cardlytics] Error in baDecisionEngine getAds of "blue-ads/lib/messageManager" promise',e,this.currentAdConfig)}.bind(this)).catch(function(e){t.error('[cardlytics] Exception in getAds of "blue-ads/lib/messageManager" promise',e,this.currentAdConfig)}.bind(this))}}}.bind(this),function(e){t.warn('[cardlytics] getAds: Error in require("blue-ads/lib/messageManager") promise',e)}.bind(this)).catch(function(e){t.warn('[cardlytics] getAds: Exception in require("blue-ads/lib/messageManager") promise',e)}.bind(this))},processCompositeAdsResponse:E,processAdsContentResponse:C,getAdsContent:S,processXPlusOneResponse:T,getCompositeParentValue:k}})),define("blue-ads/utility/baDecision/baDecision",["require","blue/log","blue-ads/utility/baUtil","blue-ads/utility/baStore","blue-ads/utility/categoryStore","blue-ads/utility/baDecision/baMsgManager"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baUtil"),i=e("blue-ads/utility/baStore"),a=e("blue-ads/utility/categoryStore"),r=e("blue-ads/utility/baDecision/baMsgManager"),o=function(){if(this.currentAdConfig&&this.currentAdConfig.adsInterested){var e=this.currentAdConfig.requiredAdInfo;if(e&&(e.eventName||e.privateStateUrl)){if(!(this.currentAdParamState>4)){this.currentAdParamState=this.engineStates.REQ_AD_INFO,t.debug("getRequiredAds getRequiredAdInfo: ",this.currentAdConfig);var n={adContext:this.currentAdParam,requiredAdInfo:e};e.privateStateUrl?this.appContext.application.privateState(e.privateStateUrl,{privateDataObject:n}):this.appContext.application.broadcast(e.eventName,n),this.currentAdParamState=this.engineStates.WAIT_AD_INFO}}else r.getAds.call(this)}},s=function(){for(var e=Object.keys(this.adsRegistry),t=0;t<e.length;t++)r.processAdsContentResponse.call(this,e[t],{content:null})},c=function(){for(var e=Object.keys(this.adsRegistry),t=0;t<e.length;t++)this.currentAdConfig.cardlyticsAdsIntrested[e[t]]&&r.processAdsContentResponse.call(this,e[t],{content:null})},l=function(){for(var e=Object.keys(this.adsRegistry),t=0;t<e.length;t++)this.currentAdConfig.adsInterested[e[t]]&&r.processAdsContentResponse.call(this,e[t],{content:null})},d=function(){if(this.currentAdConfig){var e=this.currentAdConfig.requiredCardlyticsAdInfo;e&&e.eventName?this.currentAdParamState>4||(this.currentAdParamState=this.engineStates.REQ_AD_INFO,t.debug("[cardlytics] getRequiredCardlyticsAds getRequiredCardlyticsAdInfo: ",this.currentAdConfig),this.appContext.application.broadcast(e.eventName,{adContext:this.currentAdParam,requiredAdInfo:e,disableCardlyticsService:!1}),this.currentAdParamState=this.engineStates.WAIT_AD_INFO):t.debug("[cardlytics] getRequiredCardlyticsAds getRequiredCardlyticsAdInfo: No adInfo found")}};return{hideUnInterestedAds:s,hideUnInterestedCardlyticsAds:c,hideUnInterestedMidasAds:l,handleSendRequiredAdInfo:function(e){e.disableMidasService?t.info("handleSendRequiredAdInfo: disableMidasService is true SERVICE CALLS DISABLED",e):e.adContext?this.currentAdParam===e.adContext?this.currentAdConfig?(this.currentAdParamState=this.engineStates.RSP_AD_INFO,t.debug("handleSendRequiredAdInfo Success: ",e.requiredAdData,e),this.requiredAdData=e.requiredAdData,r.getAds.call(this)):t.info("handleSendRequiredAdInfo: INVALID DATA:",e):t.info("handleSendRequiredAdInfo: Response too late:",e):t.info("handleSendRequiredAdInfo: INVALID CONTEXT:",e)},handleSendCardlyticsRequiredAdInfo:function(e){e.disableCardlyticsService?t.info("[cardlytics] handleSendCardlyticsRequiredAdInfo: isCardlyticsService is false SERVICE CALLS DISABLED",e):e.adContext?this.currentAdParam===e.adContext?this.currentAdConfig&&this.currentAdConfig.cardlyticsIntrested?(this.currentAdParamState=this.engineStates.RSP_AD_INFO,t.debug("[cardlytics] handleSendCardlyticsRequiredAdInfo Success: ",e.requiredAdData,e),this.requiredCardlyticsAdData=e.requiredAdData,r.getCardlyticsAds.call(this)):t.info("[cardlytics] handleSendCardlyticsRequiredAdInfo: INVALID DATA:",e):t.info("[cardlytics] handleSendCardlyticsRequiredAdInfo: Response too late:",e):t.info("[cardlytics] handleSendCardlyticsRequiredAdInfo: INVALID CONTEXT:",e)},getCardlyticsAds:d,initializeAdParams:function(e){this.requiredAdData=void 0,this.currentAdParam=n.getAdParam(),this.currentStaticAdParam=n.getAdStaticParam(e.screenId),this.currentAdConfig=this.adsConfig[this.currentStaticAdParam],this.currentAdParamState=this.engineStates.SCREENID,this.currentAdConfig&&(this.currentAdConfig.categories&&this.currentAdConfig.categories.forEach((e=>{a.clearCategory(this.currentAdParam,e.category),a.setCategory(this.currentAdParam,e.category,{placementIds:e.placementIds,actualNumberOfPlacements:0})})),e.adsType?this.currentAdConfig.cardlyticsAdsIntrested&&"cardlytics"===e.adsType&&!1!==this.appContext.config.enableCardlyticsAds&&"false"!==this.appContext.config.enableCardlyticsAds?(c.call(this),i.adsStoreDelete(),d.call(this)):this.currentAdConfig.adsInterested&&"midas"===e.adsType&&!1!==this.appContext.config.enableMidasAds&&"false"!==this.appContext.config.enableMidasAds&&(l.call(this),i.adsStoreDelete(),o.call(this)):(s.call(this),i.adsStoreDelete(),this.currentAdConfig.cardlyticsAdsIntrested&&!1!==this.appContext.config.enableCardlyticsAds&&"false"!==this.appContext.config.enableCardlyticsAds&&d.call(this),this.currentAdConfig.adsInterested&&!1!==this.appContext.config.enableMidasAds&&"false"!==this.appContext.config.enableMidasAds&&o.call(this))),t.debug("initializeAdParams:",this.currentStaticAdParam,this.currentAdParam)},getRequiredAds:o}})),define("blue-ads/utility/baDecision/baComponent",["require","blue/log","blue-ads/utility/baStore","blue-ads/utility/baDecision/baDecision","blue/event/channel/analytics","blue-ads/utility/baDecision/baMsgManager"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baStore"),i=e("blue-ads/utility/baDecision/baDecision"),a=e("blue/event/channel/analytics"),r=e("blue-ads/utility/baDecision/baMsgManager"),o=function(e,n){this.appContext.application.broadcast(e,n),t.info("Ads makenavigation triggered",n)},s=function(e){var t;if(this.currentAdConfig&&this.currentAdConfig.adsInterested)for(var n=this.currentAdConfig.adsInterested,i=Object.keys(n),a=0;a<i.length;a++){if("composite"===n[r=i[a]].slotType&&n[r].slotId===e){t=r;break}if(e===n[r]){t=r;break}}if(this.currentAdConfig&&this.currentAdConfig.cardlyticsAdsIntrested)for(n=this.currentAdConfig.cardlyticsAdsIntrested,i=Object.keys(n),a=0;a<i.length;a++){var r;if(e===n[r=i[a]]){t=r;break}}return t},c=function(e){var i=n.adsStoreGet(this.currentAdParam),a=s.call(this,e.adSlotId);i&&i[a]&&this.currentAdConfig&&(e.adData.value.jp_aid_p=this.currentAdConfig.tagCode,e.adData.value.jp_aid_a=i[a].creativeId,e.adData.value.placementId=a),t.debug("ADDecisionEngine: broadcastAdClick: ",e),e.adData&&e.adData.type&&e.adData.value&&(e.adData.value.params&&this.requiredAdData?e.adData.value.params.dynamicParams?e.adData.value.params.dynamicParams.accountId?e.adData.value.params.dynamicParams.accountId&&o.call(this,e.adData.type,e.adData.value):(e.adData.value.params.dynamicParams.accountId=this.requiredAdData.accountId,o.call(this,e.adData.type,e.adData.value)):(e.adData.value.params.dynamicParams={accountId:this.requiredAdData.accountId},o.call(this,e.adData.type,e.adData.value)):o.call(this,e.adData.type,e.adData.value))};return{handleAdClicked:function(e){var t=n.adsStoreGet(this.currentAdParam),i=s.call(this,e.adSlotId);t&&t[i]&&this.currentAdConfig&&this.adManager.trackAdClick(i,{creativeId:t[i].creativeId,midasId:t[i].adDecisionResponse?t[i].adDecisionResponse.midas_id:void 0,isFailoverAdContent:t[i].adContent?t[i].adContent.isFailoverAd:void 0},e.adVariant,this.currentAdConfig.tagCode,t[i].adDecisionResponse),c.call(this,e)},broadcastAdClick:c,handleCardlyticsUrlLinkClick:function(e){var t=e;t.pageId=this.currentAdConfig.tagCode,this.adManager.trackUrlLinkClick(t),o.call(this,"makeNavigation",e.adData.value)},getModelData:function(e){var t,i=n.adsStoreGet(this.currentAdParam),a=s.call(this,e.adSlotId);a&&i[a]&&(t=i[a].creativeId),e.context.advertisementPlacementId=a,e.context.advertisementMidasId=i[a].adDecisionResponse?i[a].adDecisionResponse.midas_id:void 0,e.context.advertisementId=t||e.context.offerId,e.context.advertisementPageId=this.currentAdConfig.tagCode,e.context.internalPlacementId&&(e.context.advertisementInternalPlacementId=e.context.internalPlacementId)},handleCardlyticsShowMore:function(e){var t=e;t.pageId=this.currentAdConfig.tagCode,this.adManager.trackCarouselShowMore(t.adData.adData)},handleCardlyticsAdImpression:function(e){let n=this.currentAdConfig&&this.currentAdConfig.tagCode||"";this.adManager.trackCardlyticsAdImpression(e.adData.adSlotId,e.adData.offerId,n),e.adData.adSlotId&&e.adData.adSlotId.forEach((function(t,i){a.emit("requestAdvertisementActionsDisplay",{placement:t,adId:e.adData.offerId[i],tagMap:n})})),t.debug("[cardlytics] ADDecisionEngine: handleAdImpression: ",e)},handleCompositeAdImpression:function(e){var i=n.adsStoreGet(this.currentAdParam),a=s.call(this,e.adData.adSlotId.split("ContentID")[0]);i&&i[a]&&this.currentAdConfig&&this.adManager.trackAdImpression(a,{creativeId:i[a].creativeId,midasId:i[a].adDecisionResponse?i[a].adDecisionResponse.midas_id:void 0,isFailoverAdContent:i[a].adContent?i[a].adContent.isFailoverAd:void 0},e.adData.adVariant,this.currentAdConfig.tagCode,i[a].adDecisionResponse),t.debug("[composite] ADDecisionEngine: handleAdImpression: ",e)},handleSeeAllClick:function(e){var t=e;t.pageId=this.currentAdConfig.tagCode,this.adManager.trackSeeAllClick(t),o.call(this,"makeNavigation",e.adData.value)},handleCarouselArrow:function(e){var t=e;t.pageId=this.currentAdConfig.tagCode,this.adManager.trackCarouselSlide(t.adData.adData)},handleCarouselDots:function(e){var t=e;t.pageId=this.currentAdConfig.tagCode,this.adManager.trackCarouselDot(t.adData.adData)},respondToRegisterForCardlyticsAdContent:function(e){var t=e.adSlotId;if(t){this.adsRegistry[t]=!0;var a,o=n.adsStoreGet(this.currentAdParam);if(o&&this.currentAdConfig.cardlyticsAdsIntrested)this.currentAdConfig.cardlyticsAdsIntrested[e.adSlotId]==t&&(a=t),a&&o[a]&&(a==o[a].adContent.placementId?r.processAdsContentResponse.call(this,t,o[a].adContent,!0):i.getCardlyticsAds.call(this));else this.currentAdParamState===this.engineStates.REQ_AD_INFO&&(this.currentAdParamState=this.engineStates.WAIT_AD_INFO,i.getCardlyticsAds.call(this))}},handleAdInteractions:function(e){t.debug("ADDecisionEngine: handleAdInteractions: ",e),e.interactionEventName&&this.appContext.application.broadcast(e.interactionEventName,{adSlotId:e.adSlotId,adTargetId:e.adTargetId,adInteractionType:e.adInteractionType})},getPlacementIdFromAdSlotId:s,respondToRegisterForAdContent:function(e){var t=e.adSlotId;if(t){this.adsRegistry[t]=!0;var a=n.adsStoreGet(this.currentAdParam);if(a){var o=s.call(this,t);o&&a[o]&&!e.isComposite?r.processAdsContentResponse.call(this,t,a[o].adContent,!0):o&&a[o]&&e.isComposite?r.processCompositeAdsResponse.call(this,t,a[o].adContent,!0):i.getRequiredAds.call(this)}else this.currentAdParamState===this.engineStates.REQ_AD_INFO&&(this.currentAdParamState=this.engineStates.WAIT_AD_INFO,i.getRequiredAds.call(this))}},handleAdImpression:function(e){var i=n.adsStoreGet(this.currentAdParam),a=s.call(this,e.adSlotId);i&&i[a]&&this.currentAdConfig&&this.adManager.trackAdImpression(a,{creativeId:i[a].creativeId,midasId:i[a].adDecisionResponse?i[a].adDecisionResponse.midas_id:void 0,isFailoverAdContent:i[a].adContent?i[a].adContent.isFailoverAd:void 0},e.adVariant,this.requiredAdData&&this.requiredAdData.targetPageId||this.currentAdConfig.tagCode,i[a].adDecisionResponse),t.debug("ADDecisionEngine: handleAdImpression: ",e)},handleDeregisterForAdContent:function(e){var t=e.adSlotId;t&&this.adsRegistry[t]&&delete this.adsRegistry[t]},handleCategoryFilter:function(e){this.adManager&&this.adManager.filterWithSelectedCategory(e.categoryId),t.debug("[cardlytics] ADDecisionEngine: handleCategoryFilter: ",e)},handleClick:function(e){var t=e;t.pageId=this.currentAdConfig.tagCode,this.adManager.trackClick("trackClick",t),o.call(this,"makeNavigation",e.adData.value)}}})),define("blue-ads/controller/baEngine",["require","blue/log","blue-ads/lib/messageManager","blue-ads/utility/baUtil","blue-ads/utility/baDecision/baDecision","blue-ads/utility/baDecision/baComponent","blue-ads/utility/baDecision/baMsgManager"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/lib/messageManager"),i=e("blue-ads/utility/baUtil"),a=e("blue-ads/utility/baDecision/baDecision"),r=e("blue-ads/utility/baDecision/baComponent"),o=e("blue-ads/utility/baDecision/baMsgManager"),s={INIT:0,SCREENID:1,REQ_AD_INFO:2,WAIT_AD_INFO:3,RSP_AD_INFO:4,REQ_XPLUS_ONE:5,RSP_XPLUS_ONE:6,REQ_AD_CONTENT:7,RSP_AD_CONTENT:8};return function(e,c,l){try{if(t.debug("ADDecisionEngine: init:",l),this.engineStates=s,this.currentAdParamState=s.INIT,this.adManager=void 0,this.requiredAdData=void 0,this.currentAdConfig=void 0,this.currentAdParam=void 0,this.currentStaticAdParam=void 0,this.adsRegistry=Object.create(null),this.appContext=e,this.appContext.on({renderAdsForAScreenID:a.initializeAdParams.bind(this),sendCardlyticsCarouselDots:r.handleCarouselDots.bind(this),sendCardlyticsUrlLinkClick:r.handleCardlyticsUrlLinkClick.bind(this),sendCardlyticsShowMore:r.handleCardlyticsShowMore.bind(this),sendCardlyticsCarouselArrow:r.handleCarouselArrow.bind(this),registerForCardlyticsAdContent:r.respondToRegisterForCardlyticsAdContent.bind(this),sendSeeAllClick:r.handleSeeAllClick.bind(this),sendClick:r.handleClick.bind(this),sendRequiredAdInfo:a.handleSendRequiredAdInfo.bind(this),sendRequiredCardlyticsInfo:a.handleSendCardlyticsRequiredAdInfo.bind(this),sendAdImpression:r.handleAdImpression.bind(this),sendCardlyticsAdImpression:r.handleCardlyticsAdImpression.bind(this),sendCompositeAdImpression:r.handleCompositeAdImpression.bind(this),sendAdClicked:r.handleAdClicked.bind(this),sendInteractWithAd:r.broadcastAdClick.bind(this),getModelData:r.getModelData.bind(this),sendAdInteractions:r.handleAdInteractions.bind(this),registerForAdContent:r.respondToRegisterForAdContent.bind(this),deregisterForAdContent:r.handleDeregisterForAdContent.bind(this),sendSelectedCategory:r.handleCategoryFilter.bind(this)}),this.adsConfig=c.adsConfig(l),this.msgMgrPromise=n(e),o.getAdsManager.call(this),c.screenApi&&c.screenChannel){var d,u=c.screenApi;c.screenChannel.on(function(e){u(window.location.href)!==d&&(a.initializeAdParams.call(this,{screenId:u(e.newUrl)}),d="")}.bind(this)),d=u(c.currentUrl),t.debug("ADDecisionEngine: init: screenId:",d),d&&void 0===this.currentStaticAdParam&&void 0===this.currentAdParam&&a.initializeAdParams.call(this,{screenId:d})}else t.debug("ADDecisionEngine: init: NULL adsData.screenChannel or adsData.screenInfo",c);i._registerAdDecision()}catch(e){t.warn("ADDecisionEngine: init: Exception:",e)}}})),define("blue-ads/controller/baDecisionEngine",["require","blue/log","blue-ads/controller/baEngine","blue-ads/utility/baStore"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/controller/baEngine"),i=e("blue-ads/utility/baStore");function a(e,t){this.message=t,this.name="ADDecisionEngineException",this.eType=e}return function(e){try{if(t.debug("ADDecisionEngine: Start:",e),!e.adsData)throw new a(!0,"ADDecisionEngine: Need adsData");var r=e.appCtx;if(!r&&e.blueSite){if(!e.adsData.application)throw new a(!0,"ADDecisionEngine: Need application in adsData");r=e.blueSite.getApplication(e.adsData.application).context}if(!r)throw new a(!0,"ADDecisionEngine: NULL App Context:");if("true"!==r.config.enableAds&&!0!==r.config.enableAds)throw new a(!1,"ADDecisionEngine: Ads not enable");var o=r.config.envType||"dev";e.adsData.bluespec&&i.setAdsBlueSpec(e.adsData.bluespec),this.engine=new n(r,e.adsData,o)}catch(e){t[!0===e.eType?"error":"warn"](e.message)}}})),define("blue-ads/utility/baViewHelper",["require","blue-ads/utility/baUtil"],(function(e){"use strict";var t,n={},i=[],a=e("blue-ads/utility/baUtil"),r=function(e){Object.keys(n).forEach(function(e){n[e]()}.bind(e))},o=function(e){"Enter"===e.key&&r(e)},s={turnoffScrollListener:function(e){var t;return n[e]&&delete n[e],Object.keys(n).length<1&&(a.removeEventListener("scroll",r),document.removeEventListener("click",r),document.removeEventListener("keyup",o),i.forEach((function(e){(t=a.getDOMElement(e))&&a.removeEventListener("scroll",r,t)})),i=[]),n},initializeScrollListener:function(e,t,s){if(n[e]=t,a.addEventListener("scroll",r),document.addEventListener("click",r),document.addEventListener("keyup",o),s){var c=a.getDOMElement(s);c&&(a.addEventListener("scroll",r,c),-1!==i.indexOf(s)&&i.push(s))}return n}};return{getInstance:function(){return t||(t=Object.create(s)),t}}})),define("blue-ads/utility/baView",["require","blue/log","blue-ads/utility/baViewHelper","blue/device/platform","blue-ads/utility/baUtil"],(function(e){"use strict";let t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baViewHelper").getInstance(),i=e("blue/device/platform"),a=i.os.family&&i.os.family.match(/(ios)/i),r=e("blue-ads/utility/baUtil"),o={},s={},c=[],l=[];var d=function(e,t){this.bridge&&this.bridge.output&&this.bridge.output.emit("trigger",{value:e,data:t})},u=function(e){var i=this;if(r.elementInViewport(e)){if(r.elementInViewport(e)&&!1===o[e]){i.isAdImpressionTriggered=!1,n.turnoffScrollListener(e),t.debug("[cardlytics] ADSView: triggerCardlyticsAdImpression:",e);var a=document.getElementById(e).querySelector("[blue-param]"),s=a?JSON.parse(a.getAttribute("blue-param")):void 0;l.push(e);var u={id:s?s.params.dynamicParams.offerId:void 0,checkSum:s?s.params.offerCheckSum:void 0};c.push(u),o[e]=!0}setTimeout((function(){l.length>0&&c.length>0&&(i.cardlyticsAdImpression&&i.cardlyticsAdImpression({adSlotId:l,offerId:c}),d.call(i,"cardlyticsAdImpression",{adSlotId:l,offerId:c})),l=[],c=[]}),1e3)}},p=function(e){var i,a=this;if(r.elementInViewport(e)&&document.getElementById(e).children.length&&!1===s[e]){a.isAdImpressionTriggered=!1,n.turnoffScrollListener(e),t.debug("[composite] ADSView: triggerCompositeAdImpression:",e);var o=document.getElementById(e)?document.getElementById(e).querySelector("[blue-param]"):void 0,c=o?o.getAttribute("blue-param"):void 0,l=c?r.isJsonString(c)?JSON.parse(c):c:void 0;i=l&&l.params&&l.params.dynamicParams?l.params.dynamicParams.offerId:void 0,s[e]=!0,a.compositeAdImpression&&a.compositeAdImpression({adSlotId:e,compositeOfferId:i}),d.call(a,"compositeAdImpression",{adSlotId:e,compositeOfferId:i})}},f=function(e,t,n){if(e&&t){for(var i=!1,a=e,r=0;!i&&a.id!==t&&r<30;)a.getAttribute(n)?i=!0:(a=a.parentNode,r++);return i?a:void 0}},m=function(e){const n=["interactWithAdvertisement","requestUrlLinkClick","requestMoreOffers","requestAllOffers","requestCarouselArrow","requestCarouselDot"];if(this.model.isComposite)var i=f(e,this.divContentId,"composite-data-placementid");var a=f(e,this.divContentId,"blue-param");if(a){var r=a.getAttribute("blue-click"),o=r,s=a.getAttribute("blue-param"),c=a.getAttribute("blue-internal-placement-id");c&&(r="interactWithAdvertisement"),t.debug("ADSView: adClicked:",o,s,a),this.model.isComposite&&i&&(this.divContentId=i.id?i.id.split("ContentID")[0]:void 0),r&&n.includes(r)||(r="reviewOffer"),d.call(this,r,{adSlotId:this.model.isComposite?this.divContentId:this.model.adSlotId,adTargetId:this.model.adTargetId,divContentId:this.divContentId,focusTargetId:a.id?a.id:void 0,adData:{type:o||"makeNavigation",value:s},nonCustomerEvent:void 0===e.nonCustomerEvent||e.nonCustomerEvent,internalPlacementId:c||""})}};return{sendTriggerToComponent:d,triggerAdImpression:function(){var e=this;!1===e.isAdImpressionStarted&&!0===e.isAdImpressionTriggered&&r.elementInViewport(e.divContentId)&&(e.isAdImpressionStarted=!0,setTimeout((function(){e.isAdImpressionStarted=!1,r.elementInViewport(e.divContentId)&&(e.isAdImpressionTriggered=!1,n.turnoffScrollListener(e.adSlotId),t.debug("ADSView: triggerAdImpression:",e.adSlotId),d.call(e,"adImpression",{adSlotId:e.adSlotId}))}),1e3))},clearImpressions:function(){o={},s={},c=[],l=[]},updateAdContent:function(e){if(e.data&&"adContent"===e.data.type&&e.data.value){var t=e.data.value;t.failOverAd&&(this.model.failOverAdContent=t.failOverAd),t.status||(this.model.isAdContentLoading=!0),"html"===t.type&&(this.model.isAdContentLoading=!0,t.content instanceof DocumentFragment?(this.model.adContent="<div></div>",document.getElementById(this.divContentId).appendChild(t.content)):this.model.adContent=t.content)}},triggerCompositeAdImpression:function(){var e=document.querySelectorAll("[composite-data-placementid]");for(var t in(e=[].slice.call(e))&&e.forEach((function(e){s[e.id]||(s[e.id]=!1)})),s)0==s[t]&&(n.initializeScrollListener(t,p.bind(this,t),t),setTimeout(p.bind(this,t),100))},triggerCompositeAdImpressionCallBack:p,triggerCardlyticsAdImpressionCallBack:u,triggerCardlyticsAdImpression:function(){var e=document.querySelectorAll("[data-placementid]");for(var t in(e=[].slice.call(e))&&e.forEach((function(e){o[e.id]||(o[e.id]=!1)})),o)0==o[t]&&(n.initializeScrollListener(t,u.bind(this,t),t),setTimeout(u.bind(this,t),100))},getAttribesNode:f,sendClickTrigger:m,bindClickEventIfTouchNotWorking:function(){//!!! HACK
try{if(a&&MutationObserver&&void 0===this.domObserver&&this.model.adTargetId){t.debug("ADSView: bindClickEventIfTouchNotWorking: Registring MutationObserver:",this.divContentId),this.domObserver=new MutationObserver(function(e){t.debug("ADSView: bindClickEventIfTouchNotWorking: MutationObserver:",this.divContentId,e),e.forEach(function(e){if(e.addedNodes.length>0&&e.target.id===this.divContentId){var n=r.getDOMElement(this.divContentId);n&&n.addEventListener("click",function(e){t.debug("ADSView: bindClickEventIfTouchNotWorking:1:",this.divContentId,e),!e.webkitForce&&e.target&&m.call(this,e.target)}.bind(this),!1)}}.bind(this))}.bind(this));var e=r.getDOMElement(this.model.adTargetId);e&&this.domObserver.observe(e,{childList:!0})}}catch(e){}}}})),define("blue-ads/view/webspec/baView",{name:"BLUE_ADS_VIEW_WEB_SPEC",bindings:{},triggers:{render:{action:"view.onReady"},adClicked:{action:"view.adClicked"}}}),define("blue-ads/lib/baView",["require","blue/log","blue-ads/utility/baViewHelper","blue-ads/utility/baView","blue-ads/view/webspec/baView","blue-ui/view/elements/loader"],(function(e){"use strict";var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baViewHelper").getInstance(),i=e("blue-ads/utility/baView");return{getAdView:function(a,r){return function(){this.init=function(){this.domObserver=void 0,this.isAdImpressionTriggered=!1,this.template=a,this.model=this.model||{},this.model.adContent="",this.divContentId=void 0,this.bridge=e("blue-ads/view/webspec/baView")},this.views={blueLoader:e("blue-ui/view/elements/loader")},this.onReady=function(){r&&this.onData("adContent",(function(e){t.warn("AKIT-499 is an antipattern and from post CR120, please listen to personalizeAdTarget broadcast"),this.$target.toggleClass("hide-element",!e)}),{init:!1}),this.adSlotId=this.model.adSlotId,this.divContentId=this.adSlotId+"ContentID",this.bridge.on("data/adsData",function(e){t.debug("ADSView: data/adsData:",e.data,e),e.data&&e.data.value&&e.data.value.content&&(this.isAdImpressionTriggered=!0,this.isAdImpressionStarted=!1,n.initializeScrollListener(this.model.adSlotId,i.triggerAdImpression.bind(this),this.model.scrollTargetId),e.data.value.isCompositeAdsImpression&&(i.clearImpressions(),setTimeout(i.triggerCompositeAdImpression.bind(this),100)),e.data.value.isCardlyticsAd&&(i.clearImpressions(),setTimeout(i.triggerCardlyticsAdImpression.bind(this),100)),e.data.value.isCompositeAdsImpression||setTimeout(i.triggerAdImpression.bind(this),100)),i.updateAdContent.call(this,e)}.bind(this)),i.bindClickEventIfTouchNotWorking.call(this)},this.onDestroy=function(){t.debug("ADSView: onDestroy",this.adSlotId),this.domObserver&&(this.domObserver.disconnect(),this.domObserver=void 0),n.turnoffScrollListener(this.adSlotId),i.clearImpressions()},this.adClicked=function(e){t.debug("ADSView: adClicked event:",e,this.divContentId);let n=e.domEvent?e.domEvent.target:e.target;n=n||{},n.nonCustomerEvent=!this.root||void 0===this.root._userEventRunning||!this.root._userEventRunning,i.sendClickTrigger.call(this,n)}}}}})),define("bluespec/advertisements",[],(function(){return{name:"ADVERTISEMENTS",data:{advertisementId:{type:"Description",exportable:!0},advertisementPlacementId:{type:"Description",exportable:!0},advertisementFormatType:{type:"Description",exportable:!0},advertisementShownState:{type:"OnOff",exportable:!0},advertisementHeaderShownState:{type:"OnOff",exportable:!0},advertisementLocationId:{type:"Description",exportable:!0},advertisementPageId:{type:"Description",exportable:!0},advertisementStatus:{type:"Description",exportable:!0},advertisementInteractionType:{type:"Description",exportable:!0},advertisementPreferenceByContext:{type:"Description",exportable:!0},advertisementAudiences:{type:"Description",exportable:!0},advertisementUniformResourceLocator:{type:"Description",exportable:!0},advertisementOfferUniformResourceLocator:{type:"Description",exportable:!0},totalNumberOfSlides:{type:"Numeric"},slideIndex:{type:"Description",exportable:!0},slideNumber:{type:"Numeric"},slideTitle:{type:"Description"},offers:{type:"List",items:{offerId:{type:"Description",exportable:!0},advertisementUniformResourceLocator:{type:"Description",exportable:!0}},exportable:!0},offerId:{type:"Description",exportable:!0},propertyContainer:{type:"Description"},failOverAdContent:{type:"Description",exportable:!0},isAdContentLoading:{type:"Description"},advertisementMidasId:{type:"Description",exportable:!0}},actions:{reviewOffer:!0,requestAllOffers:!0,requestMoreOffers:!0,interactWithAdvertisement:!0,requestNextSlide:!0,requestPreviousSlide:!0,requestCarouselArrow:!0,requestCarouselDot:!0,requestUrlLinkClick:!0},settings:{progressBarAda:!0,requestPreviousSlideAda:!0,requestNextSlideAda:!0}}})),define("blue-ads/utility/baComponent",["require","blue/log","blue-ads/utility/baUtil"],(function(e){var t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baUtil"),i=function(e){e.data&&this.output.emit("data",{value:"adsData",data:{type:"adContent",value:e.data}})},a=function(e={value:{}},t=""){this.context.application.broadcast(t,{adSlotId:this.model.get("isComposite")&&e.value?e.value.focusTarget:this.model.get("adSlotId"),adData:e})};return{processAdsUpdate:i,setModel:function(e){this.context.application.broadcast("getModelData",{adSlotId:e||this.model.get("adSlotId"),context:this})},sendCardlyticsUrlLinkClick:function(e){this.context.application.broadcast("sendCardlyticsUrlLinkClick",{adSlotId:this.model.get("adSlotId"),adData:e})},sendCardlyticsShowMore:function(e){this.context.application.broadcast("sendCardlyticsShowMore",{adSlotId:this.model.get("adSlotId"),adData:e})},sendCardlyticsAdImpression:function(e){this.context.application.broadcast("sendCardlyticsAdImpression",{adSlotId:this.model.get("adSlotId"),adData:e})},sendCompositeAdImpression:function(e){this.context.application.broadcast("sendCompositeAdImpression",{adSlotId:this.model.get("adSlotId"),adData:e})},registerForCardlyticsAdContent:function(){n._getInitPromise().then(function(){this.context.application.broadcast("registerForCardlyticsAdContent",{adSlotId:this.model.get("adSlotId")})}.bind(this),(function(e){t.debug("[cardlytics] ADSComponent: registerForCardlyticsAdContent: Error:",e)})).catch((function(e){t.debug("[cardlytics] ADSComponent: registerForCardlyticsAdContent: Exception:",e)}))},sendSeeAllClick:function(e){this.context.application.broadcast("sendSeeAllClick",{adSlotId:this.model.get("adSlotId"),adData:e})},sendCardlyticsCarouselDots:function(e){this.context.application.broadcast("sendCardlyticsCarouselDots",{adSlotId:this.model.get("adSlotId"),adData:e})},sendCardlyticsCarouselArrow:function(e){this.context.application.broadcast("sendCardlyticsCarouselArrow",{adSlotId:this.model.get("adSlotId"),adData:e})},listenToAdUpdates:function(){var e={};e["adsUpdate_"+this.model.get("adSlotId")]=i.bind(this),this.context.on(e)},registerForAdContent:function(){n._getInitPromise().then(function(){this.context.application.broadcast("registerForAdContent",{adSlotId:this.model.get("adSlotId"),isComposite:this.model.get("isComposite")})}.bind(this),(function(e){t.debug("ADSComponent: registerForAdContent: Error:",e)})).catch((function(e){t.debug("ADSComponent: registerForAdContent: Exception:",e)}))},deregisterForAdContent:function(){this.controller?this.controller.context.application.broadcast("deregisterForAdContent",{adSlotId:this.extraAdSlotId}):this.context&&this.context.application.broadcast("deregisterForAdContent",{adSlotId:this.extraAdSlotId})},sendAdImpression:function(e){this.context.application.broadcast("sendAdImpression",{adSlotId:this.model.get("adSlotId"),adData:e})},sendAdClicked:function(e){a.call(this,e,"sendAdClicked")},sendInteractWithAd:function(e){this.context.application.broadcast("sendInteractWithAd",{adSlotId:this.model.get("adSlotId"),adData:e})},sendAdInteractions:function(e){this.context.application.broadcast("sendAdInteractions",{adSlotId:this.model.get("adSlotId"),adTargetId:this.model.get("adTargetId"),interactionEventName:this.model.get("interactionEventName"),adInteractionType:e})},getAdContentAttributes:function(e){if(e.adData&&e.adData.value){var t=e.adData.value;try{t=JSON.parse(t)}catch(e){t={navKey:t}}return t.focusTarget=e.focusTargetId?e.focusTargetId:e.divContentId,{type:e.adData.type,value:t}}},sendClick:a}})),define("blue-ads/lib/multiAdsHelper",["require","bluespec/advertisements","blue-ads/component/baComponent"],(function(e){"use strict";return function(t){if(!t)throw new Error("[multiple] createAdCAV: parameters are not passed");if(!(t.controller&&t.controller.register&&t.controller.register.components))throw new Error("[multiple] createAdCAV: invalid controller");if(!t.componentName)throw new Error("[multiple] createAdCAV: invalid componentName");if(!t.templateTarget)throw new Error("[multiple] createAdCAV: invalid templateTarget");if(!t.adSlotId)throw new Error("[multiple] createAdCAV: invalid adSlotId");if(!t.adViewPath)throw new Error("[multiple] createAdCAV: invalid adViewPath");var n=t.controller;n.registry.registerComponent(t.componentName,{model:{interactionEventName:t.interactionEventName,scrollTargetId:t.scrollTargetId,adTargetId:t.templateTarget,adSlotId:t.adSlotId,advertisementContent:t.contentOfAd,adVariant:t.adVariant,multipleAds:!0},spec:e("bluespec/advertisements"),methods:e("blue-ads/component/baComponent")});var i={target:t.templateTarget};return t.viewAppend&&(i.append=t.viewAppend),[n.components[t.componentName],t.adViewPath,i]}})),define("blue-ads/lib/initiateMultipleAds",["require","blue-ads/lib/messageManager","blue-ads/lib/multiAdsHelper","blue-ads/utility/baUtil","blue/log"],(function(e){"use strict";const t="[multiple] Content failure";var n,i,a,r=e("blue-ads/lib/messageManager"),o=e("blue-ads/lib/multiAdsHelper"),s=e("blue-ads/utility/baUtil"),c=e("blue/log")("[blue-messages]"),l={};return{setParameters:function(e){l=e},setDecisionData:function(e){i=e},getMultipleAds:function(e){c.debug("[blue-ads.initiateMultipleAds.getMultipleAds] Calling the function with parameters: ",e);var n=this;return this.setParameters(e),new Promise((function(i,a){r(e.controller.context.application).then((function(r){c.debug("[blue-ads.initiateMultipleAds.getMultipleAds] Initiated adManager Creator for pageID: ",e.pageId),r.getAds({tagCode:e.pageId,requiredAdData:e.requiredAdData}).then((function(o){n.setDecisionData(o),n.descisionHandler.call(n,r,e,o,!1).then((function(e){c.debug("[blue-ads.initiateMultipleAds.getMultipleAds] Successfully received Ads: ",e),i(e)})).catch((function(){c.error("[blue-ads.initiateMultipleAds.getMultipleAds] Content Failure for pageId: ",e.pageId),a(t)}))})).catch((function(o){c.debug("[blue-ads.initiateMultipleAds.getMultipleAds] Error in getting ads from the framework: ",o),n.descisionHandler.call(n,r,e,o,!0).then((function(e){c.debug("[blue-ads.initiateMultipleAds.getMultipleAds] Successfully loaded the failover Ads: ",e),i(e)})).catch((function(){c.error("[blue-ads.initiateMultipleAds.getMultipleAds] Error in loading the failover Ads for pageId: ",e.pageId),a(t)}))}))})).catch((function(){c.error("[blue-ads.initiateMultipleAds.getMultipleAds] Error in initiating the adManagerCreator"),a("[multiple] Marcom plaform Failover")}))}))},descisionHandler:function(e,i,r,s){return c.debug("[blue-ads.initiateMultipleAds.descisionHandler] Calling the function with parameters: ",{adManager:e,params:i,decisionResponseData:r,loadFailover:s}),new Promise((function(l,d){var u={},p={};if(p.loadFailover=s,!s)for(var f in r)r.hasOwnProperty(f)&&"_a"!==f&&(u[f]=r[f].cid);for(var m in i.adPlacementMap)i.adPlacementMap[m]&&(p[m]=i.adPlacementMap[m].templateTarget);p.pageId=i.pageId,p.audiences=r._a,p.evaluateDynamicAd=i.htmlAd,n=p,e.getMultipleContent({adResponse:u,adParams:p,loadmultipleAds:!0}).then((function(e){c.debug("[blue-ads.initiateMultipleAds.descisionHandler] Received Ads content for pageId: ",i.pageId),a=e;var n=[];if(!0===e.status){for(var r in i.adPlacementMap)if(i.adPlacementMap.hasOwnProperty(r)){var s=i.adPlacementMap[r].templateTarget;n.push(o({controller:i.controller,componentName:r,templateTarget:"#"+i.adPlacementMap[r].templateTarget,scrollTargetId:i.scrollTargetId,viewAppend:i.adPlacementMap[r].viewAppend,adSlotId:s,adViewPath:i.adPlacementMap[r].adViewPath,contentOfAd:e.content[r],adVariant:e.adVariant[r]})),l(n)}}else c.error("[blue-ads.initiateMultipleAds.descisionHandler] Error in receiving Ads content for pageId: ",i.pageId),d(t)}))}))},handleEvents:function(e,t,o,d){c.debug("[blue-ads.initiateMultipleAds.handleEvents] Calling the function with parameters: ",{eventType:e,adSlotId:t,adVariantData:o,me:d});var u="decision_fail";r(l.controller.context.application).then((function(r){var p,f,m,g;for(var h in c.debug("[blue-ads.initiateMultipleAds.handleEvents] Initiated adManager Creator for pageID: ",l.pageId),n)n[h]===t&&(m=h);f=l.pageId,!n.loadFailover&&i?g=i[m].creativeId:n.loadFailover&&a.creativeId&&(g=a.creativeId[m]),p={creativeId:g},d.advertisementPlacementId=m,d.advertisementId=g,d.advertisementPageId=f,d.advertisementAudiences=o,s.elementInViewport(l.divContentId)&&!n.loadFailover?(c.debug("[blue-ads.initiateMultipleAds.handleEvents] Sending track event to adManager for ",e),"adClick"===e?r.trackAdClick(m,p,o,f):"adImpression"===e&&r.trackAdImpression(m,p,o,f)):s.elementInViewport(l.divContentId)&&n.loadFailover&&(c.debug("[blue-ads.initiateMultipleAds.handleEvents] Sending track failover event to adManager for ",e),"adClick"===e?r.trackfailOverClick(u,f,m,p):"adImpression"===e&&r.trackfailOverImpression(u,f,m,p))}))}}})),define("blue-ads/component/baComponent",["require","blue/log","blue-ads/utility/baComponent","blue-ads/lib/initiateMultipleAds","blue-ads/utility/baView"],(function(e){"use strict";let t=e("blue/log")("[blue-messages]"),n=e("blue-ads/utility/baComponent"),i=e("blue-ads/lib/initiateMultipleAds"),a=e("blue-ads/utility/baView");return{init:function(){var e=this;e.adImpressionShown=!1,e.isAdContentLoading=!1,this.extraAdSlotId=this.model.get("adSlotId"),this.context.application.on("convoDeckExploreProductsRequested",(function(){void 0!==e.model&&!0===e.model.get("multipleAds")&&!1===e.adImpressionShown&&(e.adImpressionShown=!0,i.handleEvents("adImpression",e.model.get("adSlotId"),e.model.get("adVariant"),e))})),this.output.on("ready",function(){e.isAdContentLoading=!1,n.listenToAdUpdates.call(this),n.registerForAdContent.call(this),n.registerForCardlyticsAdContent.call(this)}.bind(this))},onDestroy:function(){t.debug("ADSComponent: onDestroy:"),n.deregisterForAdContent.call(this)},adImpression:function(e){t.debug("ADSComponent: ADImpression",e),n.sendAdImpression.call(this,e)},cardlyticsAdImpression:function(e){t.debug("ADSComponent: cardlyticsAdImpression",e),n.sendCardlyticsAdImpression.call(this,e)},compositeAdImpression:function(e){t.debug("ADSComponent: compositeAdImpression",e),n.sendCompositeAdImpression.call(this,e)},requestCarouselArrow:function(e){this.model.set("advertisementStatus",e.adData.value),setTimeout(a.triggerCardlyticsAdImpression.bind(this),100),n.sendCardlyticsCarouselArrow.call(this,e)},requestCarouselDot:function(e){this.model.set("advertisementStatus",e.adData.value),setTimeout(a.triggerCardlyticsAdImpression.bind(this),100),n.sendCardlyticsCarouselDots.call(this,e)},requestAllOffers:function(e){var t=n.getAdContentAttributes(e);n.sendSeeAllClick.call(this,t)},requestMoreOffers:function(e){this.model.set("advertisementStatus",e.adData.value),setTimeout(a.triggerCardlyticsAdImpression.bind(this),100),n.sendCardlyticsShowMore.call(this,e)},requestUrlLinkClick:function(e){var t=n.getAdContentAttributes(e);n.sendCardlyticsUrlLinkClick.call(this,t)},reviewOffer:function(e){try{var a=JSON.parse(e.adData.value).params.dynamicParams.offerId;this.offerId=a}catch(e){this.offerId=""}!0===this.model.get("multipleAds")||this.model.get("isComposite")||n.setModel.call(this),this.model.get("isComposite")&&n.setModel.call(this,e.adSlotId);var r=n.getAdContentAttributes(e);t.debug("ADSComponent: adClicked:",e.adSlotId,e,r),this.model.set("interactionType",""),!0===this.model.get("multipleAds")&&i.handleEvents("adClick",this.model.get("adSlotId"),this.model.get("adVariant"),this),n.sendAdClicked.call(this,r)},interactWithAdvertisement:function(e){t.debug("ADSComponent: interactWithAdvertisement",e),this.internalPlacementId=e.internalPlacementId,n.setModel.call(this),n.sendInteractWithAd.call(this,n.getAdContentAttributes(e))}}})),define("blue-ads/lib/baHelper",["require","bluespec/advertisements","blue-ads/component/baComponent"],(function(e){"use strict";return function(t){if(!t)throw new Error("createAdCAV: parameters are not passed");if(!(t.controller&&t.controller.register&&t.controller.register.components))throw new Error("createAdCAV: invalid controller");if(!t.componentName)throw new Error("createAdCAV: invalid componentName");if(!t.templateTarget)throw new Error("createAdCAV: invalid templateTarget");if(!t.adSlotId)throw new Error("createAdCAV: invalid adSlotId");if(!t.adViewPath)throw new Error("createAdCAV: invalid adViewPath");var n=t.controller;n.registry.registerComponent(t.componentName,{model:{interactionEventName:t.interactionEventName,scrollTargetId:t.scrollTargetId,adTargetId:t.templateTarget,adSlotId:t.adSlotId,isComposite:t.isComposite},spec:e("bluespec/advertisements"),methods:e("blue-ads/component/baComponent")});var i={target:t.templateTarget};return t.viewAppend&&(i.append=t.viewAppend),[n.components[t.componentName],t.adViewPath,i]}})),define("blue-ads/controller/baInitializer",["require","screenmap/api/urlToAnalyticsUri"],(function(e){"use strict";var t=e("screenmap/api/urlToAnalyticsUri");return{initializeAds:function(e,n){var i=n||t(window.location.href);i&&(e&&(e=e.toLowerCase()),this.context.application.broadcast("renderAdsForAScreenID",{screenId:i,adsType:e}))}}})),define("blue-ads/main",[],(function(){})),define("blue-tags/core/_personalization",[],(function(){"use strict";function e(){this.CookieName="PC_1_0",this.ValueDelimiter="|",this.origFieldOrder=[];var e="lsid",i="segg",a="site",o="ct",s="ut",c="pt",l="pfid",d="zip",u="RPC",p="preview",f="AOC",m="known",g="source_code",h="source_code_applied",v="ECI",y="GUID",b="lastUpdate",C="lastSent",A="segment",I="locale";this.GetLastSessionId=function(){return this.Get(e)},this.SetLastSessionId=function(t){r(e,t)&&this.Put(e,t)},this.GetSegmentGroup=function(){return this.Get(i)},this.SetSegmentGroup=function(e){r(i,e)&&this.Put(i,e)},this.GetSegmentId=function(){return this.Get(A)},this.SetSegmentId=function(e){r(A,e)&&(this.Put(A,e),this.ContainsKey("seg")&&this.Remove("seg"))},this.GetSite=function(){return this.Get(a)},this.SetSite=function(e){r(a,e)&&this.Put(a,e)},this.GetCustomerType=function(){return this.Get(o)},this.SetCustomerType=function(e){r(o,e)&&this.Put(o,e)},this.GetUserType=function(){return this.Get(s)},this.SetUserType=function(e){r(s,e)&&this.Put(s,e)},this.GetProfileType=function(){return this.Get(c)},this.SetProfileType=function(e){r(c,e)&&this.Put(c,e)},this.GetProfileId=function(){return this.Get(l)},this.SetProfileId=function(e){r(l,e)&&this.Put(l,e)},this.GetZipCode=function(){return this.Get(d)},this.SetZipCode=function(e){r(d,e)&&this.Put(d,e)},this.GetRpcList=function(){return this.Get(u)},this.SetRpcList=function(e){r(u,e)&&this.Put(u,e)},this.GetRpcCode=function(){return this.Get(u)},this.SetRpcCode=function(e){r(u,e)&&this.Put(u,e)},this.GetIsPreviewMode=function(){return this.Get(p)},this.SetIsPreviewMode=function(e){r(p,e)&&this.Put(p,e)},this.GetAocList=function(){return this.Get(f)},this.SetAocList=function(e){r(f,e)&&this.Put(f,e)},this.GetAccountInfo=function(){return this.Get("accts")},this.GetIsKnown=function(){return this.Get(m)},this.SetIsKnown=function(e){r(m,e)&&this.Put(m,e)},this.GetSourceCode=function(){return this.Get(g)},this.SetSourceCode=function(e){r(g,e)&&this.Put(g,e)},this.GetECI=function(){return this.Get(v)},this.SetECI=function(e){r(v,e)&&this.Put(v,e)},this.GetGUID=function(){return this.Get(y)},this.SetGUID=function(e){r(y,e)&&this.Put(y,e)},this.GetLastUpdate=function(){return this.Get(b)},this.SetLastUpdate=function(e){r(b,e)&&this.Put(b,e)},this.GetLastSent=function(){return this.Get(C)},this.SetLastSent=function(e){r(C,e)&&this.Put(C,e)},this.GetSourceCodeKeyAppliedFor=function(){return this.Get(h)},this.SetSourceCodeKeyAppliedFor=function(e){r(h,e)&&this.Put(h,e)},this.GetLocale=function(){return this.Get(I)},this.SetLocale=function(e){r(I,e)&&this.Put(I,e)},this.Persist=n,this.Init=t,this.Init()}function t(){var e=function(e){var t=document.cookie.indexOf(e+"=");if(-1!=t){var n=t+e.length+1,i=document.cookie.indexOf(";",n);return-1==i&&(i=document.cookie.length),unescape(document.cookie.substring(n,i))}return null}(this.CookieName);if(e){var t=e.split(this.ValueDelimiter);if(t)for(var n=0;n<t.length;n++){var i=t[n].split("=");i&&2==i.length&&r(i[0],i[1])&&("seg"==i[0]?(this.origFieldOrder.push("segment"),this.SetSegmentId(decodeURIComponent(i[1])),a(this.CookieName,null,-30)):(this.origFieldOrder.push(i[0]),this.Put(i[0],decodeURIComponent(i[1]))))}}}function n(){var e=function(){var e=new Date,t=e.getMonth()+1,n=e.getDate();t<10&&(t="0"+t);n<10&&(n="0"+n);return e.getFullYear()+"-"+t+"-"+n}();this.SetLastUpdate(e),this.SetLastSent(e);for(var t="",n=0;n<this.origFieldOrder.length;n++)t+=this.origFieldOrder[n]+"="+encodeURIComponent(this.Get(this.origFieldOrder[n])),t+=this.ValueDelimiter;for(var r in this.Table)"function"!=typeof this.Table[r]&&(null==this.Table[r]||i(this.origFieldOrder,r)||(t+=r+"="+encodeURIComponent(this.Table[r]),t+=this.ValueDelimiter));a(this.CookieName,t,365),a("GW",this.GetCustomerType()+"|"+this.GetUserType()+"|"+this.GetProfileType()+"|"+this.GetSegmentId()+"|"+this.GetSegmentGroup()+"|"+this.GetSite())}function i(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}function a(e,t,n){var i=function(){var e=null,t=document.domain.split(".");t.length>=2&&(e=t[t.length-2]+"."+t[t.length-1]);return e}(),a=new Date;a.setDate(a.getDate()+n),document.cookie=e+"="+t+(n?";expires="+a.toGMTString():"")+";path=/"+(i?";domain="+i:"")}function r(e,t){var n=!1;if(t&&t.length>0)switch(e){case"zip":new RegExp("^\\d{5}-?(\\d{4})?$").test(t)&&(n=!0);break;case"source_code":case"source_code_applied":4==t.length&&(n=!0);break;case"lsid":case"segg":n=!0;break;case"seg":case"segment":3==t.length&&(n=!0);break;case"site":case"ct":case"ut":case"pt":case"pfid":n=!0;break;case"RPC":new RegExp("^([A-Za-z0-9]{3,4}|,)*,$").test(decodeURIComponent(t))&&(n=!0);break;case"preview":n=!0;break;case"AOC":new RegExp("^([A-Za-z0-9]{1,5}|,)*,$").test(decodeURIComponent(t))&&(n=!0);break;case"known":new RegExp("^(Y|N)$").test(t)&&(n=!0);break;case"ECI":n=!0;break;case"GUID":new RegExp("^[A-Fa-f0-9]{8}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{4}-[A-Fa-f0-9]{12}$").test(t)&&(n=!0);break;case"lastUpdate":case"lastSent":new RegExp("^\\d{4}-\\d{2}-\\d{2}$").test(t)&&(n=!0);break;case"locale":case"accts":n=!0}return n}return e.prototype=new function(){this.Clear=function(){this.Table=new Array},this.ContainsKey=function(e){var t=!1;for(var n in this.Table)if(n==e&&null!=this.Table[n]){t=!0;break}return t},this.Get=function(e){var t=this.Table[e];return t||null},this.Put=function(e,t){null!=e&&null!=t&&(this.Table[e]=t)},this.Remove=function(e){var t=this.Table[e];return this.Table[e]=null,t},this.Table=new Array},e})),define("blue-tags/core/constants",[],(function(){"use strict";return{appName:"Tag Manager 2",productionServiceDomain:"https://www.chase.com",serviceEndpointPartialPath:"/apps/services/tagmanager",googleAdsDomain:"https://googleads.g.doubleclick.net",googleAdsServiceEndpointPartialPath:"/pagead/viewthroughconversion/1036322744/",xPlusOneStagingDomain:"https://rf15-qa.chase.com",xPlusOneProdDomain:"https://rf15.chase.com",xPlusOneServiceEndpointPartialPath:"/wsb/15629/poe/59242226",midasDevDomain:"https://midas-dev2.chase.com/stream/tag?",midasQaDomain:"https://midas-qa.chase.com/stream/tag?",midasPerfDomain:"https://midas-perf.chase.com/stream/tag?",midasProdDomain:"https://midas.chase.com/stream/tag?"}})),define("blue-tags/utils/index",["../core/constants"],(function(e){"use strict";return{getCookie:function(e){var t=new RegExp(e+"s*=s*(.*?)(?:;|$)"),n=document.cookie.toString().match(t);return n?unescape(n[1]):null},setFireOnceCookie:function(e,t){if(e&&t){var n=e+"=",i=new Date;i.setTime(i.getTime()+18e5),document.cookie=n+encodeURIComponent(t)+"; expires="+i.toGMTString()}},extend:function(e,t){if(!t)return e;if(!e)return t;for(var n in t)e[n]=t[n];return e},indexOf:function(e,t){for(var n=e.length,i=0;i<n;i++)if(e[i]==t)return i;return-1}}})),define("blue-tags/core/environment",["./_personalization","../utils/index"],(function(e,t){"use strict";var n="";return{getEnvironment:function(e){n=e},getInstance:function(i){var a;return{env:n||"prod",query:function(e){if(""==e)return{};for(var t={},n=0;n<e.length;++n){var i=e[n].split("=");2==i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return t}(window.location.search.substr(1).split("&")),persona:"function"!=typeof e?{}:(new e).Table,v1st:(a=t.getCookie("v1st"),/^[a-z0-9]+$/i.test(a)?a:null),userAgent:encodeURIComponent(navigator.userAgent),referrer:encodeURIComponent(document.referrer),random:Math.floor(9e8*Math.random())+1e8,pageUrl:encodeURIComponent(document.location)}}}})),define("blue-tags/utils/cors",[],(function(){"use strict";return function(e,t){var n=new XMLHttpRequest;return"withCredentials"in n?n.open(e,t,!0):"undefined"!=typeof XDomainRequest?(n=new XDomainRequest).open(e,t):n=null,n}})),define("blue-tags/utils/logger",["../core/constants"],(function(e){"use strict";return function(t){window.console&&console.log("[",e.appName,"] ",t)}})),define("blue-tags/modules/replace",["../core/environment","../utils/logger","../utils/index"],(function(Config,Logger,Utils){"use strict";return function(source,params){var clientVars,match,matchesArray,regexp=/\{(.+?)\}/g,replacement,toReturn;if(Config.params)if(params){let e=Utils.extend(Config.params,params);clientVars=Utils.extend(Config.getInstance(),e)}else clientVars=Utils.extend(Config.getInstance(),Config.params);else clientVars=params?Utils.extend(params,Config.getInstance()):Config.getInstance();if(matchesArray=source.match(regexp),toReturn=source,matchesArray)try{for(var i=0;i<matchesArray.length;i++){match=matchesArray[i].substring(1,matchesArray[i].length-1);try{replacement=eval("clientVars."+match)||""}catch(e){Logger("Error processing replace variables "+match)}toReturn=toReturn.replace(matchesArray[i],replacement)}}catch(e){Logger.log("Unable to Replace Placeholder with JSON Object Properties.")}return toReturn}})),define("blue-tags/modules/pixel",["./replace"],(function(e){"use strict";return{invokePixelTag:function(t,n){t=e(t,n),this.requestPixel(t)},requestPixel:function(e){document.images&&((new Image).src=e)}}})),define("blue-tags/modules/extensions",["../core/environment","../core/constants","../utils/cors","../utils/logger","./pixel","./replace","../utils/index"],(function(e,t,n,i,a,r,o){"use strict";return{audienceSyndication:function(){var o="",s={UserAgent:"",GUID:r("{persona.pfid}")||"null",IPAddress:"",XP_UID:"",URL:encodeURIComponent(location.href),Referrer:encodeURIComponent(encodeURIComponent(document.referrer)),ForceUIDMatch:!1,CreateXPUID:!0,Data:{ssv_pfid:r("{persona.pfid}")||"null",ssv_zip:r("{persona.zip}"),ssv_product:"",ssv_locale:r("{persona.locale}"),ssv_cigseg:r("{persona.segment}")}};"prod"===e.getInstance().env?o+=t.xPlusOneProdDomain:o+=t.xPlusOneStagingDomain,o+=t.xPlusOneServiceEndpointPartialPath,o+="?_u="+(r("{persona.ECI}")?r("{persona.ECI}"):""),o+="&Debug=false&Test=false&ContentType=application/json&TransactionID=eee-444";try{o+="&RequestObject=",o+=JSON.stringify(s)}catch(e){return void i(" - [AudienceSyndication] Error Stringifying RequestObject.")}var c=new n("GET",o);c||i(" - [AudienceSyndication] CORS Not Supported."),c.onload=function(){if(200===this.status){var e,n=t.googleAdsDomain+t.googleAdsServiceEndpointPartialPath;n+="?value=0&label=AgenCNqg-QMQuI-U7gM&guid=ON&script=0&url=",n+=document.domain,n+=encodeURIComponent("/audiences/");try{(e=JSON.parse(this.responseText))&&e.Nodes&&(n+=e.Nodes,a.invokePixelTag(n))}catch(e){return void i(" - [AudienceSyndication] Error parsing response.")}}else i(" - [AudienceSyndication] Request error.")},c.onerror=function(){i(" - [AudienceSyndication] Request failed.")},c.send()},midasActivity:function(n,i,r,s,c){var l={midas:{}};s&&null!=s&&(l.midas.productId=s),i&&null!=i&&(l.midas.AppID=i),r&&null!=r&&(l.midas.TagMap=r),n&&null!=n&&(l.midas.TagId=n),c&&null!=c&&(l.midas.sourceCode=c);var d="";"prod"===e.getInstance().env?d+=t.midasProdDomain:"qa"===e.getInstance().env?d+=t.midasQaDomain:"dev"===e.getInstance().env?d+=t.midasDevDomain:"load"===e.getInstance().env&&(d+=t.midasPerfDomain);var u,p=o.getCookie("PC_1_0"),f=o.getCookie("primaryECI"),m=o.getCookie("primaryEci");p||e.params?u="{persona.ECI}":f?u=f:m&&(u=m),d+="&pageID={midas.TagId}",d+="&ssv_tmc={midas.TagMap}",d+="&ssv_v1st={v1st}",d+="&ssv_pfid={persona.pfid}",d+="&ssv_productid={midas.productId}",d+="&ssv_src={midas.sourceCode}",d+="&ssv_eci="+u,d+="&ssv_eid={midas.TagMap}_{midas.productId}_{midas.sourceCode}",a.invokePixelTag(d,l)}}})),define("blue-tags/modules/tags",["../core/environment","../core/constants","../utils/logger","./pixel","./replace","./extensions","../utils/index"],(function(Config,Constants,Logger,Pixel,ReplacePlaceholder,TagManagerExtensions,Utils){"use strict";var TagManagement={stateMap:{scripts:[],urls:[],semanticAction:""},fireTags:function(){if(this.stateMap.urls){for(var i=0;i<this.stateMap.urls.length;i++)Pixel.invokePixelTag(this.stateMap.urls[i]);this.stateMap.urls=[]}if(this.stateMap.scripts){for(var i=0;i<this.stateMap.scripts.length;i++)try{eval("TagManagerExtensions."+this.stateMap.scripts[i])}catch(e){Logger("Error processing script "+this.stateMap.scripts[i])}this.stateMap.scripts=[]}},registerTags:function(e){if(e){var t=e.scripts,n=e.urls;if(n)for(var i=0;i<n.length;i++)n[i]&&this.stateMap.urls.push(n[i]);if(t)for(i=0;i<t.length;i++)t[i]&&this.stateMap.scripts.push(ReplacePlaceholder(t[i]))}else Logger("Error Registering Tags.")}};return{processTags:function(data){data||Logger("Error Processing Data: "+data);var fireOnceArray=[],fireOnceCookie=Utils.getCookie("fireOnce"),fireOnceStatus,condition,conditionResult,interactions,item,mappingID;if(fireOnceCookie&&(fireOnceArray=fireOnceCookie.split(",")),data&&data.jsonScriptArray){for(var i=0;i<data.jsonScriptArray.length;i++){if(item=data.jsonScriptArray[i],mappingID=item.mappingID,condition=item.conditions,conditionResult=!1,condition)try{conditionResult=eval(condition)}catch(e){conditionResult=!1}else conditionResult=!0;conditionResult&&(fireOnceStatus=item.fireOnce,fireOnceStatus?-1==Utils.indexOf(fireOnceArray,mappingID)&&(fireOnceArray.push(mappingID),TagManagement.registerTags(item)):TagManagement.registerTags(item))}fireOnceCookie=fireOnceArray.join(","),Utils.setFireOnceCookie("fireOnce",fireOnceCookie),TagManagement.fireTags()}},setSemanticAction:function(e){TagManagement.stateMap.semanticAction=e},processTagsForSemanticActions:function(data){data||Logger("Error Processing Data: "+data);var fireOnceArray=[],fireOnceCookie=Utils.getCookie("fireOnce"),fireOnceStatus,condition,conditionResult,interactions,item,mappingID,itemSemanticAction,userSemanticAction;if(fireOnceCookie&&(fireOnceArray=fireOnceCookie.split(",")),data&&data.jsonScriptArray){for(var i=0;i<data.jsonScriptArray.length;i++){if(item=data.jsonScriptArray[i],mappingID=item.mappingID,condition=item.conditions,conditionResult=!1,condition)try{conditionResult=eval(condition)}catch(e){conditionResult=!1}else conditionResult=!0;if(conditionResult)if(itemSemanticAction=item.semanticactions,userSemanticAction=TagManagement.stateMap.semanticAction,itemSemanticAction){for(var j=0;j<itemSemanticAction.length;j++)if(itemSemanticAction[j].attrAction===userSemanticAction){TagManagement.registerTags(item);break}}else fireOnceStatus=item.fireOnce,fireOnceStatus&&-1==Utils.indexOf(fireOnceArray,mappingID)&&(fireOnceArray.push(mappingID),TagManagement.registerTags(item))}fireOnceCookie=fireOnceArray.join(","),Utils.setFireOnceCookie("fireOnce",fireOnceCookie),TagManagement.fireTags()}}}})),define("blue-tags/main",["./core/environment","./core/constants","./utils/cors","./utils/logger","./modules/tags"],(function(e,t,n,i,a){"use strict";var r={configMap:{defaultServer:t.productionServiceDomain,env:"prod",tagManagerPath:t.serviceEndpointPartialPath},stateMap:{screenId:"",tagServer:t.productionServiceDomain},getEnvironment:function(){return this.configMap.env},setEnvironment:function(e){var t="unknown";-1!=e.indexOf("wwwq")?t="qa":-1!=e.indexOf("wwwi")?t="ist":-1!=e.indexOf("wwwd")?t="dev":-1!=e.indexOf("load")?t="load":-1!=e.indexOf("www.")&&(t="prod"),this.configMap.env=t},getScreenId:function(){return this.stateMap.screenId},setScreenId:function(e){e?this.stateMap.screenId=e:i("Screen Id is not defined.")},getTagServer:function(){return this.stateMap.tagServer},setTagServer:function(e){e&&(this.stateMap.tagServer=e,this.setEnvironment(e))},tagsErrorCallback:function(){i("Tags Request Failed.")},tagsSuccessCallback:function(){if(200===this.status){var e;try{e=JSON.parse(this.responseText)}catch(e){return void i("Error Processing Tags Request.")}a.processTags(e)}else i("Error Requesting Tags.")},requestTags:function(){if(this.getTagServer()&&this.getScreenId()){var e=this.getTagServer()+r.configMap.tagManagerPath+this.getScreenId(),t=n("GET",e);t||i("CORS Not Supported."),t.onload=this.tagsSuccessCallback,t.onerror=this.tagsErrorCallback,t.send()}},tagsSuccessCallbackForSemanticActions:function(){if(200===this.status){var e;try{e=JSON.parse(this.responseText)}catch(e){return void i("Error Processing Tags Request.")}a.processTagsForSemanticActions(e)}else i("Error Requesting Tags.")},requestTagsForSemanticActions:function(){if(this.getTagServer()&&this.getScreenId()){var e=this.getTagServer()+r.configMap.tagManagerPath+this.getScreenId(),t=n("GET",e);t||i("CORS Not Supported."),t.onload=this.tagsSuccessCallbackForSemanticActions,t.onerror=this.tagsErrorCallback,t.send()}}};return{init:function(t,n,i){e.params=i,r.setScreenId(t),r.setTagServer(n),e.getEnvironment(r.getEnvironment()),r.requestTags()},semanticActionInit:function(t,n,i){r.setScreenId(t),r.setTagServer(n),a.setSemanticAction(i),e.getEnvironment(r.getEnvironment()),r.requestTagsForSemanticActions()}}})),define("appkit/main",["require","appkit-utilities/main","analytics/main","blue-ads/main","blue-tags/main"],(function(e){"use strict";e("appkit-utilities/main"),e("analytics/main"),e("blue-ads/main"),e("blue-tags/main")}));